#include <algv20.h>



int band_passstruct22_22(FIR_LIST *i_fir_list,int band_pass_flag,int num,float *mean)     //   这里需要再加一个参数标记事件后的数据点数，用以去除直流偏置从事件的前十秒开始？或者是3秒   第一次触发要调用一次用来计算3秒的值
	{
	//计算当前点的dataD dataV 以及 band_pass_data band_pass_dataV band_pass_dataD
	int firLength,j,jjj,i;
	double datamid;
	double sum_fir=0;
	int sample_rata=i_fir_list->sample_rata;
	FIR_LIST *now_fir;
	if (i_fir_list->sample_rata==50&&band_pass_flag==0) //0.5-10
		{

		firLength=91;
		double Fir[91]={-4.7153473212779712e-03,
			-7.3350130678092595e-03,
			-6.8862760959985730e-03,
			-3.9637073093350787e-03,
			-3.0170665002751261e-03,
			-6.2840868137914035e-03,
			-1.0037074944157670e-02,
			-9.2111837188499687e-03,
			-4.7974942736769711e-03,
			-3.3119628728577378e-03,
			-7.8989280186306365e-03,
			-1.3120839740678564e-02,
			-1.1784307267806958e-02,
			-5.3941777606136875e-03,
			-3.1796739674176508e-03,
			-9.4921768847571527e-03,
			-1.6650277965581162e-02,
			-1.4627956020156697e-02,
			-5.5812936965988743e-03,
			-2.3627258420780136e-03,
			-1.0993536759581665e-02,
			-2.0796466615382671e-02,
			-1.7842510710547415e-02,
			-5.0929224070253992e-03,
			-4.2521581617375477e-04,
			-1.2334210952085667e-02,
			-2.5989410929041622e-02,
			-2.1723239839897709e-02,
			-3.4335778327799476e-03,
			3.5281295158897837e-03,
			-1.3451016415066238e-02,
			-3.3386243651688373e-02,
			-2.7136936909313240e-02,
			6.0853100125742693e-04,
			1.1910196248609050e-02,
			-1.4290228016276564e-02,
			-4.6885427209784621e-02,
			-3.7294829468323680e-02,
			1.1550999602033556e-02,
			3.5019385881294010e-02,
			-1.4810888193604847e-02,
			-9.0215746933578547e-02,
			-7.7214701973263883e-02,
			7.8698956939115550e-02,
			2.8853377610104669e-01,
			3.8623741085303820e-01,
			2.8853377610104675e-01,
			7.8698956939115522e-02,
			-7.7214701973263883e-02,
			-9.0215746933578561e-02,
			-1.4810888193604847e-02,
			3.5019385881294010e-02,
			1.1550999602033559e-02,
			-3.7294829468323687e-02,
			-4.6885427209784634e-02,
			-1.4290228016276569e-02,
			1.1910196248609053e-02,
			6.0853100125742867e-04,
			-2.7136936909313250e-02,
			-3.3386243651688380e-02,
			-1.3451016415066247e-02,
			3.5281295158897819e-03,
			-3.4335778327799493e-03,
			-2.1723239839897716e-02,
			-2.5989410929041636e-02,
			-1.2334210952085674e-02,
			-4.2521581617375304e-04,
			-5.0929224070254010e-03,
			-1.7842510710547432e-02,
			-2.0796466615382685e-02,
			-1.0993536759581674e-02,
			-2.3627258420780206e-03,
			-5.5812936965988786e-03,
			-1.4627956020156707e-02,
			-1.6650277965581169e-02,
			-9.4921768847571631e-03,
			-3.1796739674176560e-03,
			-5.3941777606136927e-03,
			-1.1784307267806968e-02,
			-1.3120839740678580e-02,
			-7.8989280186306451e-03,
			-3.3119628728577421e-03,
			-4.7974942736769798e-03,
			-9.2111837188499756e-03,
			-1.0037074944157688e-02,
			-6.2840868137914131e-03,
			-3.0170665002751309e-03,
			-3.9637073093350727e-03,
			-6.8862760959985930e-03,
			-7.3350130678093003e-03,
			-4.7153473212779703e-03,
			};

		for(j=0;j<firLength;j++)
			{
			sum_fir+=Fir[j];
			}

		for(j=0;j<3;j++)
			{

			datamid=0.0;
			now_fir=i_fir_list;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+now_fir->data[j]*Fir[i];
				now_fir=now_fir->last;
				}

			i_fir_list->band_pass_data[j]=datamid-mean[j]*sum_fir;
			}
		//i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]),0.5);
		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]+i_fir_list->band_pass_data[2]*i_fir_list->band_pass_data[2]),0.5);


		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataV[j]=now_fir->last->dataV[j]+(now_fir->last->data[j]+now_fir->data[j]-2*mean[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataV[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataV[j]=datamid;
			}
		//		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]+i_fir_list->band_pass_dataV[2]*i_fir_list->band_pass_dataV[2]),0.5);
		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataD[j]=now_fir->last->dataD[j]+(now_fir->last->dataV[j]+now_fir->dataV[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataD[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataD[j]=datamid;
			}
		//i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]+i_fir_list->band_pass_dataD[2]*i_fir_list->band_pass_dataD[2]),0.5);
		return 1;
		} 
	else if (i_fir_list->sample_rata==50&&band_pass_flag==1)//0.5-20
		{

		firLength=91;
		double Fir[91]={-4.7153473212779738e-03,
			-6.4483192101859460e-03,
			-2.8261416237785873e-03,
			-8.3654372589515875e-03,
			-4.1471627907033355e-03,
			-6.2840868137914079e-03,
			-8.7213700265631137e-03,
			-3.2428098622617405e-03,
			-1.1213402697541583e-02,
			-4.9466181620312650e-03,
			-7.8989280186306434e-03,
			-1.1242413378083894e-02,
			-3.3100066230686942e-03,
			-1.4459854260015712e-02,
			-5.4797153140611274e-03,
			-9.4921768847571596e-03,
			-1.4024617015743609e-02,
			-2.8107727848066203e-03,
			-1.8200880944351631e-02,
			-5.5608212165410200e-03,
			-1.0993536759581675e-02,
			-1.7146501002222748e-02,
			-1.3995572667511178e-03,
			-2.2683019995626760e-02,
			-4.8945416941608491e-03,
			-1.2334210952085676e-02,
			-2.0847132319377779e-02,
			1.5755298149360143e-03,
			-2.8533806225070926e-02,
			-2.9040796720337034e-03,
			-1.3451016415066248e-02,
			-2.5816378192694587e-02,
			7.6701483118841972e-03,
			-3.7557913128694109e-02,
			1.9197660536363786e-03,
			-1.4290228016276578e-02,
			-3.4438289137924481e-02,
			2.2196095192753271e-02,
			-5.6926569837408826e-02,
			1.5943685463048512e-02,
			-1.4810888193604859e-02,
			-6.1329263843038523e-02,
			8.5630324351806258e-02,
			-1.6614739817832935e-01,
			1.7216427002311249e-01,
			7.8559078765183676e-01,
			1.7216427002311252e-01,
			-1.6614739817832935e-01,
			8.5630324351806258e-02,
			-6.1329263843038544e-02,
			-1.4810888193604859e-02,
			1.5943685463048519e-02,
			-5.6926569837408840e-02,
			2.2196095192753278e-02,
			-3.4438289137924488e-02,
			-1.4290228016276583e-02,
			1.9197660536363786e-03,
			-3.7557913128694123e-02,
			7.6701483118842007e-03,
			-2.5816378192694594e-02,
			-1.3451016415066257e-02,
			-2.9040796720337051e-03,
			-2.8533806225070932e-02,
			1.5755298149360143e-03,
			-2.0847132319377789e-02,
			-1.2334210952085683e-02,
			-4.8945416941608517e-03,
			-2.2683019995626767e-02,
			-1.3995572667511195e-03,
			-1.7146501002222762e-02,
			-1.0993536759581684e-02,
			-5.5608212165410278e-03,
			-1.8200880944351641e-02,
			-2.8107727848066220e-03,
			-1.4024617015743618e-02,
			-9.4921768847571700e-03,
			-5.4797153140611361e-03,
			-1.4459854260015729e-02,
			-3.3100066230686959e-03,
			-1.1242413378083908e-02,
			-7.8989280186306521e-03,
			-4.9466181620312711e-03,
			-1.1213402697541600e-02,
			-3.2428098622617422e-03,
			-8.7213700265631276e-03,
			-6.2840868137914174e-03,
			-4.1471627907033425e-03,
			-8.3654372589515753e-03,
			-2.8261416237785955e-03,
			-6.4483192101859816e-03,
			-4.7153473212779729e-03,


			};

		for(j=0;j<firLength;j++)
			{
			sum_fir+=Fir[j];
			}

		for(j=0;j<3;j++)
			{

			datamid=0.0;
			now_fir=i_fir_list;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+now_fir->data[j]*Fir[i];
				now_fir=now_fir->last;
				}

			i_fir_list->band_pass_data[j]=datamid-mean[j]*sum_fir;
			}
		//i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]),0.5);
		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]+i_fir_list->band_pass_data[2]*i_fir_list->band_pass_data[2]),0.5);
		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataV[j]=now_fir->last->dataV[j]+(now_fir->last->data[j]+now_fir->data[j]-2*mean[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataV[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataV[j]=datamid;
			}
		//		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]+i_fir_list->band_pass_dataV[2]*i_fir_list->band_pass_dataV[2]),0.5);
		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataD[j]=now_fir->last->dataD[j]+(now_fir->last->dataV[j]+now_fir->dataV[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataD[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataD[j]=datamid;
			}
		//		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]+i_fir_list->band_pass_dataD[2]*i_fir_list->band_pass_dataD[2]),0.5);
		return 1;
		}
	else if (i_fir_list->sample_rata==50&&(band_pass_flag==2||band_pass_flag==4))//0.3-10 0.1-10
				{

				firLength=151;
				double Fir[151]={-2.8052426906829513e-03,
					-4.2393366582970269e-03,
					-3.8887138369385330e-03,
					-2.2354116003412555e-03,
					-1.7151340451976370e-03,
					-3.3681835107814504e-03,
					-5.1779067586189562e-03,
					-4.6965135173902524e-03,
					-2.5638580821051682e-03,
					-1.8818136148366425e-03,
					-3.9473893023176630e-03,
					-6.1968403681345145e-03,
					-5.5591924712764754e-03,
					-2.8602285633303683e-03,
					-1.9855715179514558e-03,
					-4.5343773820232715e-03,
					-7.2993746523036347e-03,
					-6.4757972766725895e-03,
					-3.1075377181290190e-03,
					-2.0034515060087738e-03,
					-5.1201983246674521e-03,
					-8.4924282172401180e-03,
					-7.4477448916228876e-03,
					-3.2854307785719003e-03,
					-1.9068638995382889e-03,
					-5.6956197214221181e-03,
					-9.7890130188554095e-03,
					-8.4805326328304762e-03,
					-3.3686880184671422e-03,
					-1.6587501518070553e-03,
					-6.2513201008398845e-03,
					-1.1212180130190147e-02,
					-9.5865220664507079e-03,
					-3.3245287368907092e-03,
					-1.2085331900947341e-03,
					-6.7780883098406538e-03,
					-1.2801858768458711e-02,
					-1.0789770869833983e-02,
					-3.1075700373275851e-03,
					-4.8269424897207818e-04,
					-7.2670234585519751e-03,
					-1.4627552535563389e-02,
					-1.2135072981765502e-02,
					-2.6498708200075548e-03,
					6.3396297658225372e-04,
					-7.7097304696529074e-03,
					-1.6813951744110978e-02,
					-1.3706460562373948e-02,
					-1.8396919533613628e-03,
					2.3388911427624061e-03,
					-8.0985063426770101e-03,
					-1.9598293978969096e-02,
					-1.5669566680424962e-02,
					-4.7103250693004398e-04,
					5.0106092712312988e-03,
					-8.4265124453908481e-03,
					-2.3477962536707364e-02,
					-1.8384256507005932e-02,
					1.8961989182070325e-03,
					9.4930912865623281e-03,
					-8.6879284730553841e-03,
					-2.9673940083844816e-02,
					-2.2776743005803374e-02,
					6.4259738795488016e-03,
					1.8156146307088068e-02,
					-8.8780841635862553e-03,
					-4.2138499851260856e-02,
					-3.2106505797306333e-02,
					1.7595589150292312e-02,
					4.1258267838167328e-02,
					-8.9935654105577235e-03,
					-8.4619383336774115e-02,
					-7.1400968296348372e-02,
					8.4628282316732584e-02,
					2.9419739638965176e-01,
					3.9169381130492797e-01,
					2.9419739638965176e-01,
					8.4628282316732584e-02,
					-7.1400968296348372e-02,
					-8.4619383336774115e-02,
					-8.9935654105577252e-03,
					4.1258267838167349e-02,
					1.7595589150292319e-02,
					-3.2106505797306346e-02,
					-4.2138499851260863e-02,
					-8.8780841635862588e-03,
					1.8156146307088072e-02,
					6.4259738795488016e-03,
					-2.2776743005803384e-02,
					-2.9673940083844830e-02,
					-8.6879284730553893e-03,
					9.4930912865623333e-03,
					1.8961989182070343e-03,
					-1.8384256507005946e-02,
					-2.3477962536707378e-02,
					-8.4265124453908533e-03,
					5.0106092712313005e-03,
					-4.7103250693004398e-04,
					-1.5669566680424969e-02,
					-1.9598293978969110e-02,
					-8.0985063426770188e-03,
					2.3388911427624079e-03,
					-1.8396919533613663e-03,
					-1.3706460562373958e-02,
					-1.6813951744110992e-02,
					-7.7097304696529126e-03,
					6.3396297658225372e-04,
					-2.6498708200075574e-03,
					-1.2135072981765515e-02,
					-1.4627552535563406e-02,
					-7.2670234585519829e-03,
					-4.8269424897207731e-04,
					-3.1075700373275877e-03,
					-1.0789770869833994e-02,
					-1.2801858768458723e-02,
					-6.7780883098406616e-03,
					-1.2085331900947350e-03,
					-3.3245287368907140e-03,
					-9.5865220664507183e-03,
					-1.1212180130190158e-02,
					-6.2513201008398932e-03,
					-1.6587501518070587e-03,
					-3.3686880184671461e-03,
					-8.4805326328304884e-03,
					-9.7890130188554234e-03,
					-5.6956197214221250e-03,
					-1.9068638995382910e-03,
					-3.2854307785719064e-03,
					-7.4477448916228997e-03,
					-8.4924282172401319e-03,
					-5.1201983246674599e-03,
					-2.0034515060087777e-03,
					-3.1075377181290238e-03,
					-6.4757972766725999e-03,
					-7.2993746523036451e-03,
					-4.5343773820232776e-03,
					-1.9855715179514588e-03,
					-2.8602285633303726e-03,
					-5.5591924712764867e-03,
					-6.1968403681345232e-03,
					-3.9473893023176700e-03,
					-1.8818136148366458e-03,
					-2.5638580821051716e-03,
					-4.6965135173902611e-03,
					-5.1779067586189640e-03,
					-3.3681835107814543e-03,
					-1.7151340451976407e-03,
					-2.2354116003412351e-03,
					-3.8887138369385656e-03,
					-4.2393366582969870e-03,
					-2.8052426906829439e-03,



					};

				for(j=0;j<firLength;j++)
					{
					sum_fir+=Fir[j];
					}

				for(j=0;j<3;j++)
					{

					datamid=0.0;
					now_fir=i_fir_list;
					for(i=0;i<firLength;i++)
						{
						datamid=datamid+now_fir->data[j]*Fir[i];
						now_fir=now_fir->last;
						}

					i_fir_list->band_pass_data[j]=datamid-mean[j]*sum_fir;
					}
				//i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]),0.5);
				i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]+i_fir_list->band_pass_data[2]*i_fir_list->band_pass_data[2]),0.5);
				for(j=0;j<3;j++)
					{
					datamid=0.0;
					now_fir=i_fir_list;
					now_fir->dataV[j]=now_fir->last->dataV[j]+(now_fir->last->data[j]+now_fir->data[j]-2*mean[j])*0.5/sample_rata;
					for(i=0;i<firLength;i++)
						{
						datamid=datamid+(now_fir->dataV[j])*Fir[i];
						now_fir=now_fir->last;
						}
					i_fir_list->band_pass_dataV[j]=datamid;
					}
				//		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
				i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]+i_fir_list->band_pass_dataV[2]*i_fir_list->band_pass_dataV[2]),0.5);
				for(j=0;j<3;j++)
					{
					datamid=0.0;
					now_fir=i_fir_list;
					now_fir->dataD[j]=now_fir->last->dataD[j]+(now_fir->last->dataV[j]+now_fir->dataV[j])*0.5/sample_rata;
					for(i=0;i<firLength;i++)
						{
						datamid=datamid+(now_fir->dataD[j])*Fir[i];
						now_fir=now_fir->last;
						}
					i_fir_list->band_pass_dataD[j]=datamid;
					}
				//		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
				i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]+i_fir_list->band_pass_dataD[2]*i_fir_list->band_pass_dataD[2]),0.5);
				return 1;
		}
	else if (i_fir_list->sample_rata==50&&(band_pass_flag==3||band_pass_flag==5))//0.3-20 0.5-20
						{

						firLength=151;
						double Fir[151]={-2.8052426906829669e-03,
							-3.7327892963485041e-03,
							-1.6371302979319672e-03,
							-4.6031978766705676e-03,
							-2.3042578621266267e-03,
							-3.3681835107814591e-03,
							-4.5290546686863938e-03,
							-1.8240136060308138e-03,
							-5.5731396514796250e-03,
							-2.6278689807175677e-03,
							-3.9473893023176578e-03,
							-5.3805132667803608e-03,
							-1.9560693679891573e-03,
							-6.6243143370245576e-03,
							-2.9162913670577589e-03,
							-4.5343773820232828e-03,
							-6.2858745249048152e-03,
							-2.0121053154790215e-03,
							-7.7611894312796803e-03,
							-3.1519611510679442e-03,
							-5.1201983246674876e-03,
							-7.2459549792125797e-03,
							-1.9660665573087810e-03,
							-8.9927404053154851e-03,
							-3.3137148625665960e-03,
							-5.6956197214221311e-03,
							-8.2652381094201685e-03,
							-1.7847653436507431e-03,
							-1.0335365209835251e-02,
							-3.3751130612549936e-03,
							-6.2513201008398992e-03,
							-9.3543843832025950e-03,
							-1.4238973545786769e-03,
							-1.1817757824706194e-02,
							-3.3013998543649013e-03,
							-6.7780883098406703e-03,
							-1.0534528677492988e-02,
							-8.2075809098128857e-04,
							-1.3489577812379144e-02,
							-3.0437637742106818e-03,
							-7.2670234585519916e-03,
							-1.1845192481486843e-02,
							1.1984417493707435e-04,
							-1.5438054842580221e-02,
							-2.5278497678315874e-03,
							-7.7097304696529256e-03,
							-1.3360165566950076e-02,
							1.5549804382048928e-03,
							-1.7822806329527312e-02,
							-1.6287869973513997e-03,
							-8.0985063426770292e-03,
							-1.5222978060422342e-02,
							3.7715762913589686e-03,
							-2.0957843199214312e-02,
							-1.1027260492468474e-04,
							-8.4265124453908689e-03,
							-1.7738059684048867e-02,
							7.3679679080297603e-03,
							-2.5537927401370154e-02,
							2.5508862624539727e-03,
							-8.6879284730554066e-03,
							-2.1656830661475741e-02,
							1.3854783684439050e-02,
							-3.3430340035845128e-02,
							7.8191639571073557e-03,
							-8.8780841635862778e-03,
							-2.9416853782139672e-02,
							2.8509602165276371e-02,
							-5.1859196070795928e-02,
							2.2027286318516446e-02,
							-8.9935654105577460e-03,
							-5.5673513688530463e-02,
							9.1779135231254763e-02,
							-1.6035224386209343e-01,
							1.7811509561945693e-01,
							7.9131032078731367e-01,
							1.7811509561945693e-01,
							-1.6035224386209343e-01,
							9.1779135231254763e-02,
							-5.5673513688530463e-02,
							-8.9935654105577478e-03,
							2.2027286318516460e-02,
							-5.1859196070795949e-02,
							2.8509602165276374e-02,
							-2.9416853782139679e-02,
							-8.8780841635862813e-03,
							7.8191639571073591e-03,
							-3.3430340035845135e-02,
							1.3854783684439057e-02,
							-2.1656830661475748e-02,
							-8.6879284730554118e-03,
							2.5508862624539761e-03,
							-2.5537927401370172e-02,
							7.3679679080297655e-03,
							-1.7738059684048881e-02,
							-8.4265124453908741e-03,
							-1.1027260492468474e-04,
							-2.0957843199214322e-02,
							3.7715762913589721e-03,
							-1.5222978060422354e-02,
							-8.0985063426770379e-03,
							-1.6287869973513997e-03,
							-1.7822806329527329e-02,
							1.5549804382048928e-03,
							-1.3360165566950086e-02,
							-7.7097304696529308e-03,
							-2.5278497678315900e-03,
							-1.5438054842580234e-02,
							1.1984417493707522e-04,
							-1.1845192481486857e-02,
							-7.2670234585519994e-03,
							-3.0437637742106844e-03,
							-1.3489577812379160e-02,
							-8.2075809098128857e-04,
							-1.0534528677492999e-02,
							-6.7780883098406781e-03,
							-3.3013998543649048e-03,
							-1.1817757824706209e-02,
							-1.4238973545786778e-03,
							-9.3543843832026054e-03,
							-6.2513201008399079e-03,
							-3.3751130612549988e-03,
							-1.0335365209835265e-02,
							-1.7847653436507457e-03,
							-8.2652381094201789e-03,
							-5.6956197214221380e-03,
							-3.3137148625666003e-03,
							-8.9927404053155024e-03,
							-1.9660665573087840e-03,
							-7.2459549792125919e-03,
							-5.1201983246674954e-03,
							-3.1519611510679498e-03,
							-7.7611894312796924e-03,
							-2.0121053154790246e-03,
							-6.2858745249048239e-03,
							-4.5343773820232889e-03,
							-2.9162913670577636e-03,
							-6.6243143370245680e-03,
							-1.9560693679891617e-03,
							-5.3805132667803677e-03,
							-3.9473893023176648e-03,
							-2.6278689807175725e-03,
							-5.5731396514796337e-03,
							-1.8240136060308171e-03,
							-4.5290546686863999e-03,
							-3.3681835107814630e-03,
							-2.3042578621266310e-03,
							-4.6031978766705259e-03,
							-1.6371302979319808e-03,
							-3.7327892963484690e-03,
							-2.8052426906829599e-03,




							};

						for(j=0;j<firLength;j++)
							{
							sum_fir+=Fir[j];
							}

						for(j=0;j<3;j++)
							{

							datamid=0.0;
							now_fir=i_fir_list;
							for(i=0;i<firLength;i++)
								{
								datamid=datamid+now_fir->data[j]*Fir[i];
								now_fir=now_fir->last;
								}

							i_fir_list->band_pass_data[j]=datamid-mean[j]*sum_fir;
							}
						//i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]),0.5);
						i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]+i_fir_list->band_pass_data[2]*i_fir_list->band_pass_data[2]),0.5);
						for(j=0;j<3;j++)
							{
							datamid=0.0;
							now_fir=i_fir_list;
							now_fir->dataV[j]=now_fir->last->dataV[j]+(now_fir->last->data[j]+now_fir->data[j]-2*mean[j])*0.5/sample_rata;
							for(i=0;i<firLength;i++)
								{
								datamid=datamid+(now_fir->dataV[j])*Fir[i];
								now_fir=now_fir->last;
								}
							i_fir_list->band_pass_dataV[j]=datamid;
							}
						//		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
						i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]+i_fir_list->band_pass_dataV[2]*i_fir_list->band_pass_dataV[2]),0.5);
						for(j=0;j<3;j++)
							{
							datamid=0.0;
							now_fir=i_fir_list;
							now_fir->dataD[j]=now_fir->last->dataD[j]+(now_fir->last->dataV[j]+now_fir->dataV[j])*0.5/sample_rata;
							for(i=0;i<firLength;i++)
								{
								datamid=datamid+(now_fir->dataD[j])*Fir[i];
								now_fir=now_fir->last;
								}
							i_fir_list->band_pass_dataD[j]=datamid;
							}
						//		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
						i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]+i_fir_list->band_pass_dataD[2]*i_fir_list->band_pass_dataD[2]),0.5);
						return 1;
		}
	else if (i_fir_list->sample_rata==100&&band_pass_flag==0)//0.5-10
			{

			firLength=181;
			double Fir[181]={-2.3326528386443572e-03,
				-3.0842741508271898e-03,
				-3.6267319478226452e-03,
				-3.7541400147500692e-03,
				-3.4100055346662538e-03,
				-2.7230862102406461e-03,
				-1.9713380801993168e-03,
				-1.4824855740462927e-03,
				-1.5061788775427546e-03,
				-2.1070912008664096e-03,
				-3.1238342658352052e-03,
				-4.2155557958559525e-03,
				-4.9844064367176779e-03,
				-5.1305356111941017e-03,
				-4.5798120202710391e-03,
				-3.5308590729152428e-03,
				-2.3963866919798141e-03,
				-1.6543838797502053e-03,
				-1.6620717932587217e-03,
				-2.5043518439826049e-03,
				-3.9399092034084282e-03,
				-5.4736205375881357e-03,
				-6.5354558625355958e-03,
				-6.7020860713854708e-03,
				-5.8758288950096207e-03,
				-4.3465798339496816e-03,
				-2.7038383813025760e-03,
				-1.6233947407633439e-03,
				-1.6048603962729227e-03,
				-2.7610321554119377e-03,
				-4.7463763594408270e-03,
				-6.8625670328002070e-03,
				-8.3112474918671658e-03,
				-8.5037132518824086e-03,
				-7.3085385936288733e-03,
				-5.1347804551324918e-03,
				-2.8066982719096288e-03,
				-1.2655686355986975e-03,
				-1.2050104824922925e-03,
				-2.7796545876842471e-03,
				-5.5073174677073931e-03,
				-8.4163697896445459e-03,
				-1.0396569452029119e-02,
				-1.0628497341601959e-02,
				-8.9273524108514808e-03,
				-5.8596239817359681e-03,
				-2.5711811115713148e-03,
				-3.7487739487449440e-04,
				-2.4372931853507411e-04,
				-2.4028275345275947e-03,
				-6.1875143951594328e-03,
				-1.0242214764190715e-02,
				-1.3005630497492430e-02,
				-1.3311801534661999e-02,
				-1.0879104257252087e-02,
				-6.4870453465228099e-03,
				-1.7487038487256834e-03,
				1.4617081244756916e-03,
				1.7274795742160971e-03,
				-1.3162455290874140e-03,
				-6.7545768674548571e-03,
				-1.2649091157686360e-02,
				-1.6716304179238136e-02,
				-1.7197510782108797e-02,
				-1.3596499346620780e-02,
				-6.9868291858913656e-03,
				2.6749024662483915e-04,
				5.3205378079536356e-03,
				5.9160342583496478e-03,
				1.3315253327741007e-03,
				-7.1809341778384436e-03,
				-1.6675418005868969e-02,
				-2.3477612638899491e-02,
				-2.4535913884710905e-02,
				-1.8684911464330607e-02,
				-7.3344805567890610e-03,
				5.7374180898221482e-03,
				1.5512650992564294e-02,
				1.7473147856763446e-02,
				9.3938020032437418e-03,
				-7.4455519985093402e-03,
				-2.8119961347887860e-02,
				-4.5156916819615332e-02,
				-5.0630543320326286e-02,
				-3.8656497565533909e-02,
				-7.5127575228115338e-03,
				3.9321547762486558e-02,
				9.3614278244752436e-02,
				1.4427121931842748e-01,
				1.8017162476386320e-01,
				1.9313879100681586e-01,
				1.8017162476386320e-01,
				1.4427121931842751e-01,
				9.3614278244752464e-02,
				3.9321547762486558e-02,
				-7.5127575228115364e-03,
				-3.8656497565533937e-02,
				-5.0630543320326307e-02,
				-4.5156916819615346e-02,
				-2.8119961347887870e-02,
				-7.4455519985093428e-03,
				9.3938020032437453e-03,
				1.7473147856763460e-02,
				1.5512650992564308e-02,
				5.7374180898221525e-03,
				-7.3344805567890688e-03,
				-1.8684911464330625e-02,
				-2.4535913884710932e-02,
				-2.3477612638899522e-02,
				-1.6675418005868990e-02,
				-7.1809341778384540e-03,
				1.3315253327741024e-03,
				5.9160342583496582e-03,
				5.3205378079536443e-03,
				2.6749024662483828e-04,
				-6.9868291858913760e-03,
				-1.3596499346620801e-02,
				-1.7197510782108825e-02,
				-1.6716304179238160e-02,
				-1.2649091157686383e-02,
				-6.7545768674548692e-03,
				-1.3162455290874175e-03,
				1.7274795742160997e-03,
				1.4617081244756951e-03,
				-1.7487038487256860e-03,
				-6.4870453465228229e-03,
				-1.0879104257252109e-02,
				-1.3311801534662033e-02,
				-1.3005630497492465e-02,
				-1.0242214764190740e-02,
				-6.1875143951594493e-03,
				-2.4028275345276012e-03,
				-2.4372931853507498e-04,
				-3.7487739487449440e-04,
				-2.5711811115713226e-03,
				-5.8596239817359837e-03,
				-8.9273524108515068e-03,
				-1.0628497341601996e-02,
				-1.0396569452029150e-02,
				-8.4163697896445736e-03,
				-5.5073174677074130e-03,
				-2.7796545876842566e-03,
				-1.2050104824922968e-03,
				-1.2655686355987027e-03,
				-2.8066982719096387e-03,
				-5.1347804551325127e-03,
				-7.3085385936288967e-03,
				-8.5037132518824398e-03,
				-8.3112474918672023e-03,
				-6.8625670328002330e-03,
				-4.7463763594408469e-03,
				-2.7610321554119503e-03,
				-1.6048603962729292e-03,
				-1.6233947407633513e-03,
				-2.7038383813025881e-03,
				-4.3465798339497024e-03,
				-5.8758288950096467e-03,
				-6.7020860713855020e-03,
				-6.5354558625356296e-03,
				-5.4736205375881617e-03,
				-3.9399092034084482e-03,
				-2.5043518439826183e-03,
				-1.6620717932587308e-03,
				-1.6543838797502136e-03,
				-2.3963866919798275e-03,
				-3.5308590729152640e-03,
				-4.5798120202710678e-03,
				-5.1305356111941321e-03,
				-4.9844064367177074e-03,
				-4.2155557958559785e-03,
				-3.1238342658352247e-03,
				-2.1070912008664222e-03,
				-1.5061788775427643e-03,
				-1.4824855740463026e-03,
				-1.9713380801993307e-03,
				-2.7230862102406643e-03,
				-3.4100055346662776e-03,
				-3.7541400147500931e-03,
				-3.6267319478226739e-03,
				-3.0842741508272241e-03,
				-2.3326528386443742e-03,




				};

			for(j=0;j<firLength;j++)
				{
				sum_fir+=Fir[j];
				}

			for(j=0;j<3;j++)
				{

				datamid=0.0;
				now_fir=i_fir_list;
				for(i=0;i<firLength;i++)
					{
					datamid=datamid+now_fir->data[j]*Fir[i];
					now_fir=now_fir->last;
					}

				i_fir_list->band_pass_data[j]=datamid-mean[j]*sum_fir;
				}
			//i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]),0.5);
			i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]+i_fir_list->band_pass_data[2]*i_fir_list->band_pass_data[2]),0.5);
			for(j=0;j<3;j++)
				{
				datamid=0.0;
				now_fir=i_fir_list;
				now_fir->dataV[j]=now_fir->last->dataV[j]+(now_fir->last->data[j]+now_fir->data[j]-2*mean[j])*0.5/sample_rata;
				for(i=0;i<firLength;i++)
					{
					datamid=datamid+(now_fir->dataV[j])*Fir[i];
					now_fir=now_fir->last;
					}
				i_fir_list->band_pass_dataV[j]=datamid;
				}
			//		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
			i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]+i_fir_list->band_pass_dataV[2]*i_fir_list->band_pass_dataV[2]),0.5);
			for(j=0;j<3;j++)
				{
				datamid=0.0;
				now_fir=i_fir_list;
				now_fir->dataD[j]=now_fir->last->dataD[j]+(now_fir->last->dataV[j]+now_fir->dataV[j])*0.5/sample_rata;
				for(i=0;i<firLength;i++)
					{
					datamid=datamid+(now_fir->dataD[j])*Fir[i];
					now_fir=now_fir->last;
					}
				i_fir_list->band_pass_dataD[j]=datamid;
				}
			//		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
			i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]+i_fir_list->band_pass_dataD[2]*i_fir_list->band_pass_dataD[2]),0.5);
			return 1;
		}
	else if(i_fir_list->sample_rata==100&&band_pass_flag==1)//0.5-20
		{

		firLength=181;
		double Fir[181]={-2.3326528386443594e-03,
			-3.4991401073059857e-03,
			-3.1902161556800050e-03,
			-1.8321747820894412e-03,
			-1.4070070421972460e-03,
			-2.7230862102406400e-03,
			-4.1449470822111888e-03,
			-3.7459376416390956e-03,
			-2.0641338925180062e-03,
			-1.5314478025104973e-03,
			-3.1238342658352087e-03,
			-4.8371584220407698e-03,
			-4.3337724845796078e-03,
			-2.2800098465348933e-03,
			-1.6231050097107519e-03,
			-3.5308590729152749e-03,
			-5.5769427938035911e-03,
			-4.9529884964400741e-03,
			-2.4720700744171840e-03,
			-1.6717262071527992e-03,
			-3.9399092034084317e-03,
			-6.3666722528782629e-03,
			-5.6035935246459504e-03,
			-2.6314075695107091e-03,
			-1.6651642266041235e-03,
			-4.3465798339496651e-03,
			-7.2105703088624438e-03,
			-6.2867904458401846e-03,
			-2.7475763965830236e-03,
			-1.5886900320062310e-03,
			-4.7463763594408313e-03,
			-8.1156641180282225e-03,
			-7.0056400463759175e-03,
			-2.8080041807807730e-03,
			-1.4239044477121134e-03,
			-5.1347804551325500e-03,
			-9.0932338988772201e-03,
			-7.7660654292044020e-03,
			-2.7970289541027881e-03,
			-1.1469714315694300e-03,
			-5.5073174677073983e-03,
			-1.0161111084201540e-02,
			-8.5784437899555296e-03,
			-2.6942787605153495e-03,
			-7.2565534889431000e-04,
			-5.8596239817359863e-03,
			-1.1347497248949829e-02,
			-9.4602611119968365e-03,
			-2.4718453108292524e-03,
			-1.1414090262758513e-04,
			-6.1875143951594389e-03,
			-1.2697666294880817e-02,
			-1.0440807124764789e-02,
			-2.0891110380182633e-03,
			7.5651915801211304e-04,
			-6.4870453465228298e-03,
			-1.4286516693169288e-02,
			-1.1570073973127358e-02,
			-1.4826645513373565e-03,
			1.9972624254119388e-03,
			-6.7545768674548640e-03,
			-1.6244034399569333e-02,
			-1.2937114398833348e-02,
			-5.4494117956684876e-04,
			3.8017040510027883e-03,
			-6.9868291858913873e-03,
			-1.8812496760948979e-02,
			-1.4712257811415792e-02,
			9.2634237261963797e-04,
			6.5450263429814642e-03,
			-7.1809341778384505e-03,
			-2.2493892981147987e-02,
			-1.7259581539556857e-02,
			3.3680783700244204e-03,
			1.1068375759068461e-02,
			-7.3344805567890836e-03,
			-2.8513112948530032e-02,
			-2.1508798714193096e-02,
			7.9414965024144253e-03,
			1.9738996531280330e-02,
			-7.4455519985093472e-03,
			-4.0824913252199606e-02,
			-3.0721536310489000e-02,
			1.9120885349495815e-02,
			4.2811186928109209e-02,
			-7.5127575228115572e-03,
			-8.3172766670878195e-02,
			-6.9919968498284302e-02,
			8.6113546658194567e-02,
			2.9561658147867981e-01,
			3.9306790323197471e-01,
			2.9561658147867981e-01,
			8.6113546658194581e-02,
			-6.9919968498284329e-02,
			-8.3172766670878223e-02,
			-7.5127575228115598e-03,
			4.2811186928109236e-02,
			1.9120885349495825e-02,
			-3.0721536310489003e-02,
			-4.0824913252199641e-02,
			-7.4455519985093498e-03,
			1.9738996531280337e-02,
			7.9414965024144323e-03,
			-2.1508798714193120e-02,
			-2.8513112948530053e-02,
			-7.3344805567890914e-03,
			1.1068375759068475e-02,
			3.3680783700244239e-03,
			-1.7259581539556878e-02,
			-2.2493892981148015e-02,
			-7.1809341778384609e-03,
			6.5450263429814711e-03,
			9.2634237261963971e-04,
			-1.4712257811415809e-02,
			-1.8812496760949010e-02,
			-6.9868291858913977e-03,
			3.8017040510027961e-03,
			-5.4494117956684876e-04,
			-1.2937114398833370e-02,
			-1.6244034399569361e-02,
			-6.7545768674548761e-03,
			1.9972624254119440e-03,
			-1.4826645513373591e-03,
			-1.1570073973127386e-02,
			-1.4286516693169316e-02,
			-6.4870453465228428e-03,
			7.5651915801211477e-04,
			-2.0891110380182685e-03,
			-1.0440807124764816e-02,
			-1.2697666294880847e-02,
			-6.1875143951594554e-03,
			-1.1414090262758513e-04,
			-2.4718453108292589e-03,
			-9.4602611119968642e-03,
			-1.1347497248949861e-02,
			-5.8596239817360020e-03,
			-7.2565534889431347e-04,
			-2.6942787605153591e-03,
			-8.5784437899555574e-03,
			-1.0161111084201575e-02,
			-5.5073174677074182e-03,
			-1.1469714315694335e-03,
			-2.7970289541027985e-03,
			-7.7660654292044298e-03,
			-9.0932338988772531e-03,
			-5.1347804551325708e-03,
			-1.4239044477121169e-03,
			-2.8080041807807829e-03,
			-7.0056400463759470e-03,
			-8.1156641180282520e-03,
			-4.7463763594408513e-03,
			-1.5886900320062384e-03,
			-2.7475763965830349e-03,
			-6.2867904458402133e-03,
			-7.2105703088624750e-03,
			-4.3465798339496859e-03,
			-1.6651642266041300e-03,
			-2.6314075695107217e-03,
			-5.6035935246459790e-03,
			-6.3666722528782941e-03,
			-3.9399092034084517e-03,
			-1.6717262071528078e-03,
			-2.4720700744171984e-03,
			-4.9529884964400993e-03,
			-5.5769427938036223e-03,
			-3.5308590729152961e-03,
			-1.6231050097107618e-03,
			-2.2800098465349068e-03,
			-4.3337724845796339e-03,
			-4.8371584220407993e-03,
			-3.1238342658352282e-03,
			-1.5314478025105064e-03,
			-2.0641338925180201e-03,
			-3.7459376416391207e-03,
			-4.1449470822112183e-03,
			-2.7230862102406582e-03,
			-1.4070070421972559e-03,
			-1.8321747820894531e-03,
			-3.1902161556800297e-03,
			-3.4991401073060247e-03,
			-2.3326528386443763e-03,




			};

		for(j=0;j<firLength;j++)
			{
			sum_fir+=Fir[j];
			}

		for(j=0;j<3;j++)
			{

			datamid=0.0;
			now_fir=i_fir_list;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+now_fir->data[j]*Fir[i];
				now_fir=now_fir->last;
				}

			i_fir_list->band_pass_data[j]=datamid-mean[j]*sum_fir;
			}
		//		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]),0.5);
		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]+i_fir_list->band_pass_data[2]*i_fir_list->band_pass_data[2]),0.5);


		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataV[j]=now_fir->last->dataV[j]+(now_fir->last->data[j]+now_fir->data[j]-2*mean[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataV[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataV[j]=datamid;
			}
		//		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]+i_fir_list->band_pass_dataV[2]*i_fir_list->band_pass_dataV[2]),0.5);
		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataD[j]=now_fir->last->dataD[j]+(now_fir->last->dataV[j]+now_fir->dataV[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataD[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataD[j]=datamid;
			}
		//		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]+i_fir_list->band_pass_dataD[2]*i_fir_list->band_pass_dataD[2]),0.5);
		return 1;
		}
	else if(i_fir_list->sample_rata==100&&(band_pass_flag==2||band_pass_flag==4))//0.3-10  0.1-10
				{

				firLength=301;
				double Fir[301]={-1.3934901977829615e-03,
					-1.8159417519245753e-03,
					-2.1047061992379365e-03,
					-2.1499567281675455e-03,
					-1.9319560065597574e-03,
					-1.5336077824486048e-03,
					-1.1131764610959451e-03,
					-8.4586773282764453e-04,
					-8.5571492559512663e-04,
					-1.1641429939370940e-03,
					-1.6763388826177095e-03,
					-2.2127045829863049e-03,
					-2.5752520825855834e-03,
					-2.6245209995463341e-03,
					-2.3372518475216625e-03,
					-1.8211766253946077e-03,
					-1.2790312324263129e-03,
					-9.3350462293830287e-04,
					-9.4077162689895221e-04,
					-1.3260577655623985e-03,
					-1.9675936202030414e-03,
					-2.6375233932370771e-03,
					-3.0863445849885914e-03,
					-3.1397319857095246e-03,
					-2.7703067122125825e-03,
					-2.1150445844176149e-03,
					-1.4290329171544275e-03,
					-9.9084931593346887e-04,
					-9.9450274977262157e-04,
					-1.4697037836401406e-03,
					-2.2629691037629874e-03,
					-3.0896434805398041e-03,
					-3.6395636772003424e-03,
					-3.6973125284921167e-03,
					-3.2306007769072587e-03,
					-2.4107945111442089e-03,
					-1.5546360967761310e-03,
					-1.0065972753527060e-03,
					-1.0053738031440373e-03,
					-1.5860839569270741e-03,
					-2.5579388666770995e-03,
					-3.5692958764463449e-03,
					-4.2383209384534298e-03,
					-4.3009144849360951e-03,
					-3.7187912246025431e-03,
					-2.7038140209237104e-03,
					-1.6456047543273620e-03,
					-9.6672554881740698e-04,
					-9.5902862506833195e-04,
					-1.6643298430027724e-03,
					-2.8478287426786748e-03,
					-4.0784458396371038e-03,
					-4.8890672246237271e-03,
					-4.9573843372280107e-03,
					-4.2375689803696064e-03,
					-2.9893918921230977e-03,
					-1.6892661355065719e-03,
					-8.5315338472186943e-04,
					-8.3687322528905046e-04,
					-1.6908134983387932e-03,
					-3.1279156197627396e-03,
					-4.6219899287065240e-03,
					-5.6032676672302818e-03,
					-5.6788440317752488e-03,
					-4.7930527289633748e-03,
					-3.2628185712932083e-03,
					-1.6691643874906282e-03,
					-6.4136490201577951e-04,
					-6.1355241309235965e-04,
					-1.6475301337705620e-03,
					-3.3935290783997270e-03,
					-5.2097909555231794e-03,
					-6.4008237800856037e-03,
					-6.4863194218901269e-03,
					-5.3972072803381739e-03,
					-3.5194883154958849e-03,
					-1.5625414496258179e-03,
					-2.9599484306628491e-04,
					-2.5223929370514470e-04,
					-1.5090285192966766e-03,
					-3.6401534025372944e-03,
					-5.8603941401391838e-03,
					-7.3164248762943827e-03,
					-7.4165259229421188e-03,
					-6.0723665880914419e-03,
					-3.7550004343177984e-03,
					-1.3353600892311249e-03,
					2.3788693116028032e-04,
					3.0473249946160190e-04,
					-1.2362210827844447e-03,
					-3.8635274170506517e-03,
					-6.6084146410208293e-03,
					-8.4123588516069620e-03,
					-8.5356836076430822e-03,
					-6.8604886253879381e-03,
					-3.9652570935789742e-03,
					-9.3168387924516256e-04,
					1.0534705820681239e-03,
					1.1561602642038765e-03,
					-7.6279308836732713e-04,
					-4.0597396392069423e-03,
					-7.5208401297042239e-03,
					-9.8072001726968727e-03,
					-9.9708294562862142e-03,
					-7.8443429100596568e-03,
					-4.1465552109397862e-03,
					-2.4844224798785294e-04,
					2.3271192130121512e-03,
					2.4913851040193188e-03,
					3.8417223566559994e-05,
					-4.2253163338121661e-03,
					-8.7382536865734783e-03,
					-1.1749625514224836e-02,
					-1.1991733098263043e-02,
					-9.2038390171244738e-03,
					-4.2956701090024274e-03,
					9.3449579474537436e-04,
					4.4450971219227456e-03,
					4.7325123287797061e-03,
					1.4542781444556027e-03,
					-4.3573002295476306e-03,
					-1.0601141815511635e-02,
					-1.4850187602870650e-02,
					-1.5274622891964655e-02,
					-1.1402122422123587e-02,
					-4.4099287906940446e-03,
					3.1992627279992338e-03,
					8.4610861449535505e-03,
					9.0647035001510286e-03,
					4.3128967563563032e-03,
					-4.4533178832161045e-03,
					-1.4174787943096560e-02,
					-2.1085357894361143e-02,
					-2.2096384652325083e-02,
					-1.6069207429197555e-02,
					-4.4872709594348387e-03,
					8.7849658638558172e-03,
					1.8665591162767350e-02,
					2.0618219193568481e-02,
					1.2446574643172092e-02,
					-4.5116339631119861e-03,
					-2.5272940970094884e-02,
					-4.2331277335992394e-02,
					-4.7764061273754821e-02,
					-3.5721208137345535e-02,
					-4.5262962159261927e-03,
					4.2308025951629580e-02,
					9.6544322689801162e-02,
					1.4711299332650787e-01,
					1.8293486636295642e-01,
					1.9587085363289147e-01,
					1.8293486636295639e-01,
					1.4711299332650785e-01,
					9.6544322689801135e-02,
					4.2308025951629566e-02,
					-4.5262962159261918e-03,
					-3.5721208137345535e-02,
					-4.7764061273754814e-02,
					-4.2331277335992387e-02,
					-2.5272940970094880e-02,
					-4.5116339631119853e-03,
					1.2446574643172089e-02,
					2.0618219193568474e-02,
					1.8665591162767347e-02,
					8.7849658638558138e-03,
					-4.4872709594348361e-03,
					-1.6069207429197544e-02,
					-2.2096384652325073e-02,
					-2.1085357894361126e-02,
					-1.4174787943096552e-02,
					-4.4533178832161010e-03,
					4.3128967563563006e-03,
					9.0647035001510234e-03,
					8.4610861449535436e-03,
					3.1992627279992312e-03,
					-4.4099287906940411e-03,
					-1.1402122422123580e-02,
					-1.5274622891964643e-02,
					-1.4850187602870640e-02,
					-1.0601141815511625e-02,
					-4.3573002295476280e-03,
					1.4542781444556018e-03,
					4.7325123287797017e-03,
					4.4450971219227413e-03,
					9.3449579474537349e-04,
					-4.2956701090024231e-03,
					-9.2038390171244669e-03,
					-1.1991733098263025e-02,
					-1.1749625514224822e-02,
					-8.7382536865734661e-03,
					-4.2253163338121600e-03,
					3.8417223566559994e-05,
					2.4913851040193153e-03,
					2.3271192130121469e-03,
					-2.4844224798785381e-04,
					-4.1465552109397810e-03,
					-7.8443429100596446e-03,
					-9.9708294562862020e-03,
					-9.8072001726968588e-03,
					-7.5208401297042135e-03,
					-4.0597396392069380e-03,
					-7.6279308836732583e-04,
					1.1561602642038756e-03,
					1.0534705820681221e-03,
					-9.3168387924516213e-04,
					-3.9652570935789682e-03,
					-6.8604886253879251e-03,
					-8.5356836076430683e-03,
					-8.4123588516069481e-03,
					-6.6084146410208154e-03,
					-3.8635274170506460e-03,
					-1.2362210827844425e-03,
					3.0473249946160017e-04,
					2.3788693116027988e-04,
					-1.3353600892311228e-03,
					-3.7550004343177915e-03,
					-6.0723665880914298e-03,
					-7.4165259229421032e-03,
					-7.3164248762943671e-03,
					-5.8603941401391716e-03,
					-3.6401534025372871e-03,
					-1.5090285192966731e-03,
					-2.5223929370514383e-04,
					-2.9599484306628491e-04,
					-1.5625414496258144e-03,
					-3.5194883154958771e-03,
					-5.3972072803381609e-03,
					-6.4863194218901122e-03,
					-6.4008237800855889e-03,
					-5.2097909555231664e-03,
					-3.3935290783997183e-03,
					-1.6475301337705575e-03,
					-6.1355241309235748e-04,
					-6.4136490201577821e-04,
					-1.6691643874906245e-03,
					-3.2628185712932005e-03,
					-4.7930527289633627e-03,
					-5.6788440317752332e-03,
					-5.6032676672302679e-03,
					-4.6219899287065127e-03,
					-3.1279156197627305e-03,
					-1.6908134983387882e-03,
					-8.3687322528904872e-04,
					-8.5315338472186726e-04,
					-1.6892661355065672e-03,
					-2.9893918921230908e-03,
					-4.2375689803695943e-03,
					-4.9573843372279977e-03,
					-4.8890672246237124e-03,
					-4.0784458396370933e-03,
					-2.8478287426786674e-03,
					-1.6643298430027674e-03,
					-9.5902862506832913e-04,
					-9.6672554881740416e-04,
					-1.6456047543273575e-03,
					-2.7038140209237008e-03,
					-3.7187912246025327e-03,
					-4.3009144849360829e-03,
					-4.2383209384534160e-03,
					-3.5692958764463336e-03,
					-2.5579388666770917e-03,
					-1.5860839569270702e-03,
					-1.0053738031440341e-03,
					-1.0065972753527028e-03,
					-1.5546360967761263e-03,
					-2.4107945111442020e-03,
					-3.2306007769072496e-03,
					-3.6973125284921046e-03,
					-3.6395636772003298e-03,
					-3.0896434805397937e-03,
					-2.2629691037629792e-03,
					-1.4697037836401362e-03,
					-9.9450274977261875e-04,
					-9.9084931593346518e-04,
					-1.4290329171544223e-03,
					-2.1150445844176089e-03,
					-2.7703067122125742e-03,
					-3.1397319857095142e-03,
					-3.0863445849885810e-03,
					-2.6375233932370672e-03,
					-1.9675936202030344e-03,
					-1.3260577655623941e-03,
					-9.4077162689894884e-04,
					-9.3350462293829940e-04,
					-1.2790312324263090e-03,
					-1.8211766253946012e-03,
					-2.3372518475216551e-03,
					-2.6245209995463237e-03,
					-2.5752520825855730e-03,
					-2.2127045829862962e-03,
					-1.6763388826177036e-03,
					-1.1641429939370888e-03,
					-8.5571492559512359e-04,
					-8.4586773282764138e-04,
					-1.1131764610959410e-03,
					-1.5336077824486000e-03,
					-1.9319560065597509e-03,
					-2.1499567281675781e-03,
					-2.1047061992379612e-03,
					-1.8159417519245733e-03,
					-1.3934901977829676e-03,




					};

				for(j=0;j<firLength;j++)
					{
					sum_fir+=Fir[j];
					}

				for(j=0;j<3;j++)
					{

					datamid=0.0;
					now_fir=i_fir_list;
					for(i=0;i<firLength;i++)
						{
						datamid=datamid+now_fir->data[j]*Fir[i];
						now_fir=now_fir->last;
						}

					i_fir_list->band_pass_data[j]=datamid-mean[j]*sum_fir;
					}
				//		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]),0.5);
				i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]+i_fir_list->band_pass_data[2]*i_fir_list->band_pass_data[2]),0.5);


				for(j=0;j<3;j++)
					{
					datamid=0.0;
					now_fir=i_fir_list;
					now_fir->dataV[j]=now_fir->last->dataV[j]+(now_fir->last->data[j]+now_fir->data[j]-2*mean[j])*0.5/sample_rata;
					for(i=0;i<firLength;i++)
						{
						datamid=datamid+(now_fir->dataV[j])*Fir[i];
						now_fir=now_fir->last;
						}
					i_fir_list->band_pass_dataV[j]=datamid;
					}
				//		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
				i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]+i_fir_list->band_pass_dataV[2]*i_fir_list->band_pass_dataV[2]),0.5);
				for(j=0;j<3;j++)
					{
					datamid=0.0;
					now_fir=i_fir_list;
					now_fir->dataD[j]=now_fir->last->dataD[j]+(now_fir->last->dataV[j]+now_fir->dataV[j])*0.5/sample_rata;
					for(i=0;i<firLength;i++)
						{
						datamid=datamid+(now_fir->dataD[j])*Fir[i];
						now_fir=now_fir->last;
						}
					i_fir_list->band_pass_dataD[j]=datamid;
					}
				//		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
				i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]+i_fir_list->band_pass_dataD[2]*i_fir_list->band_pass_dataD[2]),0.5);
				return 1;
		}
	else if(i_fir_list->sample_rata==100&&(band_pass_flag==3||band_pass_flag==5))//0.3-20  0.1-20
						{

						firLength=301;
						double Fir[301]={-1.3934901977829680e-03,
							-2.0591471447144408e-03,
							-1.8538727075612120e-03,
							-1.0619062019629508e-03,
							-8.1587711918438763e-04,
							-1.5336077824486046e-03,
							-2.2873037091859128e-03,
							-2.0500592810437498e-03,
							-1.1477736688751846e-03,
							-8.6621314978765787e-04,
							-1.6763388826177119e-03,
							-2.5254768443396772e-03,
							-2.2533649041660718e-03,
							-1.2311770227447108e-03,
							-9.1091417486133632e-04,
							-1.8211766253946270e-03,
							-2.7737401261001098e-03,
							-2.4636447545635510e-03,
							-1.3112166818275656e-03,
							-9.4882567102745749e-04,
							-1.9675936202030366e-03,
							-3.0322274166934889e-03,
							-2.6807861348373944e-03,
							-1.3869204177044485e-03,
							-9.7868430286028054e-04,
							-2.1150445844176128e-03,
							-3.3011531372237226e-03,
							-2.9047225447061307e-03,
							-1.4572341447004877e-03,
							-9.9910047198487582e-04,
							-2.2629691037629905e-03,
							-3.5808371874591458e-03,
							-3.1354508223969545e-03,
							-1.5210097340542111e-03,
							-1.0085356973326630e-03,
							-2.4107945111442367e-03,
							-3.8717358729843561e-03,
							-3.3730522433562797e-03,
							-1.5769888733281438e-03,
							-1.0052731515594747e-03,
							-2.5579388666771147e-03,
							-4.1744807036909644e-03,
							-3.6177187982971135e-03,
							-1.6237816311932163e-03,
							-9.8737905270352886e-04,
							-2.7038140209237039e-03,
							-4.4899276499406242e-03,
							-3.8697863529772317e-03,
							-1.6598378688039001e-03,
							-9.5265170574443370e-04,
							-2.8478287426786791e-03,
							-4.8192204940044406e-03,
							-4.1297770935453003e-03,
							-1.6834088797336568e-03,
							-8.9855366071935506e-04,
							-2.9893918921231363e-03,
							-5.1638734694093172e-03,
							-4.3984547026415669e-03,
							-1.6924955101639549e-03,
							-8.2212046965219698e-04,
							-3.1279156197627448e-03,
							-5.5258807226008944e-03,
							-4.6768972857036111e-03,
							-1.6847772964388114e-03,
							-7.1983650204917433e-04,
							-3.2628185712931953e-03,
							-5.9078637280622400e-03,
							-4.9665954951301017e-03,
							-1.6575145018051572e-03,
							-5.8746357724257078e-04,
							-3.3935290783997322e-03,
							-6.3132734339130820e-03,
							-5.2695871293348710e-03,
							-1.6074107272802246e-03,
							-4.1980068672492970e-04,
							-3.5194883154959374e-03,
							-6.7466729945423421e-03,
							-5.5886456739866544e-03,
							-1.5304169354633805e-03,
							-2.1034085042177214e-04,
							-3.6401534025373005e-03,
							-7.2141419480249288e-03,
							-5.9275505396323746e-03,
							-1.4214462986003266e-03,
							4.9229416531821173e-05,
							-3.7550004343177732e-03,
							-7.7238682451614537e-03,
							-6.2914843847140835e-03,
							-1.2739495603850232e-03,
							3.6977829014592809e-04,
							-3.8635274170506577e-03,
							-8.2870395727145073e-03,
							-6.6876342299360672e-03,
							-1.0792653091030130e-03,
							7.6587920106025082e-04,
							-3.9652570935790480e-03,
							-8.9192279788624894e-03,
							-7.1261309766109194e-03,
							-8.2559372636274904e-04,
							1.2576398367714805e-03,
							-4.0597396392069484e-03,
							-9.6426201995473363e-03,
							-7.6215741354642569e-03,
							-4.9631350983196047e-04,
							1.8737256823679847e-03,
							-4.1465552109398070e-03,
							-1.0489766465078650e-02,
							-8.1956181778992769e-03,
							-6.7094731213988791e-05,
							2.6565976950868732e-03,
							-4.2253163338121730e-03,
							-1.1510210616485727e-02,
							-8.8815984277734218e-03,
							4.9933120082993514e-04,
							3.6721165742158186e-03,
							-4.2956701090024491e-03,
							-1.2782967711933184e-02,
							-9.7333597886456995e-03,
							1.2633068216435261e-03,
							5.0284434387973982e-03,
							-4.3573002295476376e-03,
							-1.4441906611321888e-02,
							-1.0843542046914519e-02,
							2.3296475355276520e-03,
							6.9167510321866766e-03,
							-4.4099287906940654e-03,
							-1.6732857535286499e-02,
							-1.2385712458498409e-02,
							3.8982232888794249e-03,
							9.7100959673527467e-03,
							-4.4533178832161105e-03,
							-2.0160885672232318e-02,
							-1.4726715709115976e-02,
							6.4038046670694005e-03,
							1.4247678786111913e-02,
							-4.4872709594348595e-03,
							-2.5953146443794522e-02,
							-1.8798288578548667e-02,
							1.1005527309833275e-02,
							2.2894361385982429e-02,
							-4.5116339631119922e-03,
							-3.8064585253172890e-02,
							-2.7862223348793808e-02,
							2.2174065035049116e-02,
							4.5897775014164935e-02,
							-4.5262962159262144e-03,
							-8.0226372897564457e-02,
							-6.6927151327180412e-02,
							8.9086409730582627e-02,
							2.9845867980668878e-01,
							3.9582831139215413e-01,
							2.9845867980668872e-01,
							8.9086409730582600e-02,
							-6.6927151327180398e-02,
							-8.0226372897564457e-02,
							-4.5262962159262135e-03,
							4.5897775014164935e-02,
							2.2174065035049106e-02,
							-2.7862223348793794e-02,
							-3.8064585253172883e-02,
							-4.5116339631119913e-03,
							2.2894361385982422e-02,
							1.1005527309833271e-02,
							-1.8798288578548667e-02,
							-2.5953146443794508e-02,
							-4.4872709594348569e-03,
							1.4247678786111910e-02,
							6.4038046670693962e-03,
							-1.4726715709115965e-02,
							-2.0160885672232308e-02,
							-4.4533178832161071e-03,
							9.7100959673527432e-03,
							3.8982232888794223e-03,
							-1.2385712458498399e-02,
							-1.6732857535286486e-02,
							-4.4099287906940619e-03,
							6.9167510321866740e-03,
							2.3296475355276502e-03,
							-1.0843542046914508e-02,
							-1.4441906611321874e-02,
							-4.3573002295476350e-03,
							5.0284434387973947e-03,
							1.2633068216435252e-03,
							-9.7333597886456909e-03,
							-1.2782967711933168e-02,
							-4.2956701090024448e-03,
							3.6721165742158142e-03,
							4.9933120082993514e-04,
							-8.8815984277734114e-03,
							-1.1510210616485713e-02,
							-4.2253163338121669e-03,
							2.6565976950868706e-03,
							-6.7094731213988791e-05,
							-8.1956181778992665e-03,
							-1.0489766465078635e-02,
							-4.1465552109398018e-03,
							1.8737256823679821e-03,
							-4.9631350983195830e-04,
							-7.6215741354642465e-03,
							-9.6426201995473224e-03,
							-4.0597396392069440e-03,
							1.2576398367714779e-03,
							-8.2559372636274774e-04,
							-7.1261309766109081e-03,
							-8.9192279788624738e-03,
							-3.9652570935790419e-03,
							7.6587920106024909e-04,
							-1.0792653091030112e-03,
							-6.6876342299360550e-03,
							-8.2870395727144917e-03,
							-3.8635274170506521e-03,
							3.6977829014592678e-04,
							-1.2739495603850211e-03,
							-6.2914843847140722e-03,
							-7.7238682451614381e-03,
							-3.7550004343177663e-03,
							4.9229416531821173e-05,
							-1.4214462986003235e-03,
							-5.9275505396323633e-03,
							-7.2141419480249132e-03,
							-3.6401534025372931e-03,
							-2.1034085042177127e-04,
							-1.5304169354633771e-03,
							-5.5886456739866440e-03,
							-6.7466729945423283e-03,
							-3.5194883154959296e-03,
							-4.1980068672492883e-04,
							-1.6074107272802212e-03,
							-5.2695871293348589e-03,
							-6.3132734339130664e-03,
							-3.3935290783997235e-03,
							-5.8746357724256905e-04,
							-1.6575145018051525e-03,
							-4.9665954951300896e-03,
							-5.9078637280622261e-03,
							-3.2628185712931875e-03,
							-7.1983650204917259e-04,
							-1.6847772964388066e-03,
							-4.6768972857035998e-03,
							-5.5258807226008805e-03,
							-3.1279156197627357e-03,
							-8.2212046965219438e-04,
							-1.6924955101639510e-03,
							-4.3984547026415565e-03,
							-5.1638734694093033e-03,
							-2.9893918921231294e-03,
							-8.9855366071935289e-04,
							-1.6834088797336524e-03,
							-4.1297770935452881e-03,
							-4.8192204940044284e-03,
							-2.8478287426786718e-03,
							-9.5265170574443132e-04,
							-1.6598378688038951e-03,
							-3.8697863529772204e-03,
							-4.4899276499406129e-03,
							-2.7038140209236943e-03,
							-9.8737905270352604e-04,
							-1.6237816311932118e-03,
							-3.6177187982971018e-03,
							-4.1744807036909514e-03,
							-2.5579388666771069e-03,
							-1.0052731515594721e-03,
							-1.5769888733281391e-03,
							-3.3730522433562697e-03,
							-3.8717358729843439e-03,
							-2.4107945111442298e-03,
							-1.0085356973326602e-03,
							-1.5210097340542061e-03,
							-3.1354508223969436e-03,
							-3.5808371874591332e-03,
							-2.2629691037629822e-03,
							-9.9910047198487279e-04,
							-1.4572341447004831e-03,
							-2.9047225447061198e-03,
							-3.3011531372237105e-03,
							-2.1150445844176067e-03,
							-9.7868430286027772e-04,
							-1.3869204177044442e-03,
							-2.6807861348373849e-03,
							-3.0322274166934777e-03,
							-1.9675936202030297e-03,
							-9.4882567102745467e-04,
							-1.3112166818275610e-03,
							-2.4636447545635419e-03,
							-2.7737401261001011e-03,
							-1.8211766253946205e-03,
							-9.1091417486133339e-04,
							-1.2311770227447060e-03,
							-2.2533649041660631e-03,
							-2.5254768443396672e-03,
							-1.6763388826177060e-03,
							-8.6621314978765408e-04,
							-1.1477736688751802e-03,
							-2.0500592810437420e-03,
							-2.2873037091859041e-03,
							-1.5336077824485998e-03,
							-8.1587711918438470e-04,
							-1.0619062019629668e-03,
							-1.8538727075612339e-03,
							-2.0591471447144387e-03,
							-1.3934901977829741e-03,





							};

						for(j=0;j<firLength;j++)
							{
							sum_fir+=Fir[j];
							}

						for(j=0;j<3;j++)
							{

							datamid=0.0;
							now_fir=i_fir_list;
							for(i=0;i<firLength;i++)
								{
								datamid=datamid+now_fir->data[j]*Fir[i];
								now_fir=now_fir->last;
								}

							i_fir_list->band_pass_data[j]=datamid-mean[j]*sum_fir;
							}
						//		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]),0.5);
						i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]+i_fir_list->band_pass_data[2]*i_fir_list->band_pass_data[2]),0.5);


						for(j=0;j<3;j++)
							{
							datamid=0.0;
							now_fir=i_fir_list;
							now_fir->dataV[j]=now_fir->last->dataV[j]+(now_fir->last->data[j]+now_fir->data[j]-2*mean[j])*0.5/sample_rata;
							for(i=0;i<firLength;i++)
								{
								datamid=datamid+(now_fir->dataV[j])*Fir[i];
								now_fir=now_fir->last;
								}
							i_fir_list->band_pass_dataV[j]=datamid;
							}
						//		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
						i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]+i_fir_list->band_pass_dataV[2]*i_fir_list->band_pass_dataV[2]),0.5);
						for(j=0;j<3;j++)
							{
							datamid=0.0;
							now_fir=i_fir_list;
							now_fir->dataD[j]=now_fir->last->dataD[j]+(now_fir->last->dataV[j]+now_fir->dataV[j])*0.5/sample_rata;
							for(i=0;i<firLength;i++)
								{
								datamid=datamid+(now_fir->dataD[j])*Fir[i];
								now_fir=now_fir->last;
								}
							i_fir_list->band_pass_dataD[j]=datamid;
							}
						//		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
						i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]+i_fir_list->band_pass_dataD[2]*i_fir_list->band_pass_dataD[2]),0.5);
						return 1;
		}
	else if(i_fir_list->sample_rata==200&&band_pass_flag==0)//0.5-10
		{

		firLength=361;
		double Fir[361]={-1.1599627156203653e-03,
			-1.3513804141545515e-03,
			-1.5332694123788089e-03,
			-1.6887766184948824e-03,
			-1.8029841838057294e-03,
			-1.8645102816544836e-03,
			-1.8668187911241884e-03,
			-1.8090917113925266e-03,
			-1.6965567452652741e-03,
			-1.5402137265742384e-03,
			-1.3559626763776057e-03,
			-1.1631975088320290e-03,
			-9.8298657456748358e-04,
			-8.3600830663262083e-04,
			-7.4044200038222649e-04,
			-7.1002635962914601e-04,
			-7.5248983732441018e-04,
			-8.6852704340490534e-04,
			-1.0514468055615898e-03,
			-1.2875540918299430e-03,
			-1.5572558407831877e-03,
			-1.8368068197719030e-03,
			-2.1005434116360272e-03,
			-2.3233978799414765e-03,
			-2.4834493001293064e-03,
			-2.5642543781053133e-03,
			-2.5567139967416787e-03,
			-2.4602691978870841e-03,
			-2.2832805046993795e-03,
			-2.0425217214412499e-03,
			-1.7618063973658549e-03,
			-1.4698535330309019e-03,
			-1.1975799265481785e-03,
			-9.7507133990883327e-04,
			-8.2852627395160034e-04,
			-7.7747953464935493e-04,
			-8.3259559515763714e-04,
			-9.9427466398135694e-04,
			-1.2522410683509725e-03,
			-1.5861905437874178e-03,
			-1.9674689959335058e-03,
			-2.3616503930592491e-03,
			-2.7317862188577344e-03,
			-3.0420233111918774e-03,
			-3.2612392371368093e-03,
			-3.3663303751960733e-03,
			-3.3448101546203505e-03,
			-3.1964324313856424e-03,
			-2.9336431643978257e-03,
			-2.5807745536125149e-03,
			-2.1720192124304867e-03,
			-1.7483457707424099e-03,
			-1.3536291015861198e-03,
			-1.0303564896150148e-03,
			-8.1532586459111397e-04,
			-7.3576709039982458e-04,
			-8.0628940799744309e-04,
			-1.0269888609260390e-03,
			-1.3829444672204317e-03,
			-1.8452004008041503e-03,
			-2.3731858266620195e-03,
			-2.9183784329575644e-03,
			-3.4288867136646815e-03,
			-3.8545232802731796e-03,
			-4.1518781373592745e-03,
			-4.2888845741868489e-03,
			-4.2484042670866123e-03,
			-4.0304405941984324e-03,
			-3.6527133685297572e-03,
			-3.1494831357300290e-03,
			-2.5686843699185028e-03,
			-1.9675977564371566e-03,
			-1.4074451986459023e-03,
			-9.4741134292545279e-04,
			-6.3866921342376046e-04,
			-5.1900612594937216e-04,
			-6.0860577406278936e-04,
			-9.0744536745818779e-04,
			-1.3946207930107140e-03,
			-2.0297309235400517e-03,
			-2.7562513710705067e-03,
			-3.5066275523056587e-03,
			-4.2086368636085969e-03,
			-4.7924286208576817e-03,
			-5.1975634967488119e-03,
			-5.3793518736309541e-03,
			-5.3138371258321122e-03,
			-5.0008829485004352e-03,
			-4.4649943797227983e-03,
			-3.7537150521758716e-03,
			-2.9336787118278049e-03,
			-2.0846285346840039e-03,
			-1.2919299165380588e-03,
			-6.3826942881801821e-04,
			-1.9533651811177386e-04,
			-1.6312937720701963e-05,
			-1.2994256207468155e-04,
			-5.3682368404778409e-04,
			-1.2083674720230605e-03,
			-2.0886173418156826e-03,
			-3.0988474949679864e-03,
			-4.1445811672236703e-03,
			-5.1244175708076998e-03,
			-5.9398567669696530e-03,
			-6.5051851730812118e-03,
			-6.7564459911755061e-03,
			-6.6585752688129033e-03,
			-6.2099332005789969e-03,
			-5.4436901271035379e-03,
			-4.4258176465003614e-03,
			-3.2497608336473729e-03,
			-2.0281970101602817e-03,
			-8.8258766559113559e-04,
			6.8527464690936843e-05,
			7.2138724973440274e-04,
			9.9785497050199523e-04,
			8.5414785898490771e-04,
			2.8651204564179199e-04,
			-6.6683077024448244e-04,
			-1.9277985871627272e-03,
			-3.3845749853751383e-03,
			-4.9013002141422724e-03,
			-6.3305168127369780e-03,
			-7.5272591527759131e-03,
			-8.3634730796966865e-03,
			-8.7413685270645199e-03,
			-8.6043569955240942e-03,
			-7.9444072362388225e-03,
			-6.8049537316430741e-03,
			-5.2788890491732715e-03,
			-3.5016282806181716e-03,
			-1.6397099612124107e-03,
			1.2415182323065449e-04,
			1.6082690346823961e-03,
			2.6498683674528673e-03,
			3.1219677927291664e-03,
			2.9475659623018199e-03,
			2.1096542570990568e-03,
			6.5589531316636348e-04,
			-1.3027306082346640e-03,
			-3.5994673328447716e-03,
			-6.0250883016961564e-03,
			-8.3459768874915574e-03,
			-1.0325496527625938e-02,
			-1.1746787484960278e-02,
			-1.2434906298921064e-02,
			-1.2276187308712943e-02,
			-1.1232863588304576e-02,
			-9.3513302795274790e-03,
			-6.7629422491932295e-03,
			-3.6768700634405029e-03,
			-3.6524070148720699e-04,
			2.8584987372614885e-03,
			5.6663987181127086e-03,
			7.7458689450264342e-03,
			8.8300731420607320e-03,
			8.7261802812045371e-03,
			7.3388596434618529e-03,
			4.6867033820176028e-03,
			9.0977070035575740e-04,
			-3.7328651304630030e-03,
			-8.8758760189334828e-03,
			-1.4070187800418476e-02,
			-1.8813832745031685e-02,
			-2.2588981563693381e-02,
			-2.4902390190499418e-02,
			-2.5326109857747928e-02,
			-2.3535174482940621e-02,
			-1.9339114964854066e-02,
			-1.2704550751062287e-02,
			-3.7667474136118648e-03,
			7.1711433359891059e-03,
			1.9651492938111303e-02,
			3.3087587144720272e-02,
			4.6799367015574321e-02,
			6.0057037927284916e-02,
			7.2129401412385316e-02,
			8.2333344591922875e-02,
			9.0080782371111640e-02,
			9.4919502558270891e-02,
			9.6564803379106889e-02,
			9.4919502558270891e-02,
			9.0080782371111612e-02,
			8.2333344591922875e-02,
			7.2129401412385330e-02,
			6.0057037927284916e-02,
			4.6799367015574321e-02,
			3.3087587144720272e-02,
			1.9651492938111303e-02,
			7.1711433359891042e-03,
			-3.7667474136118635e-03,
			-1.2704550751062287e-02,
			-1.9339114964854066e-02,
			-2.3535174482940624e-02,
			-2.5326109857747928e-02,
			-2.4902390190499418e-02,
			-2.2588981563693381e-02,
			-1.8813832745031685e-02,
			-1.4070187800418474e-02,
			-8.8758760189334793e-03,
			-3.7328651304630030e-03,
			9.0977070035575740e-04,
			4.6867033820176046e-03,
			7.3388596434618546e-03,
			8.7261802812045337e-03,
			8.8300731420607320e-03,
			7.7458689450264342e-03,
			5.6663987181127086e-03,
			2.8584987372614894e-03,
			-3.6524070148720699e-04,
			-3.6768700634405029e-03,
			-6.7629422491932312e-03,
			-9.3513302795274773e-03,
			-1.1232863588304573e-02,
			-1.2276187308712943e-02,
			-1.2434906298921067e-02,
			-1.1746787484960278e-02,
			-1.0325496527625938e-02,
			-8.3459768874915574e-03,
			-6.0250883016961564e-03,
			-3.5994673328447711e-03,
			-1.3027306082346640e-03,
			6.5589531316636348e-04,
			2.1096542570990555e-03,
			2.9475659623018212e-03,
			3.1219677927291664e-03,
			2.6498683674528677e-03,
			1.6082690346823966e-03,
			1.2415182323065449e-04,
			-1.6397099612124107e-03,
			-3.5016282806181707e-03,
			-5.2788890491732715e-03,
			-6.8049537316430767e-03,
			-7.9444072362388225e-03,
			-8.6043569955240925e-03,
			-8.7413685270645199e-03,
			-8.3634730796966865e-03,
			-7.5272591527759131e-03,
			-6.3305168127369763e-03,
			-4.9013002141422733e-03,
			-3.3845749853751374e-03,
			-1.9277985871627272e-03,
			-6.6683077024448200e-04,
			2.8651204564179199e-04,
			8.5414785898490684e-04,
			9.9785497050199523e-04,
			7.2138724973440230e-04,
			6.8527464690936843e-05,
			-8.8258766559113559e-04,
			-2.0281970101602817e-03,
			-3.2497608336473725e-03,
			-4.4258176465003614e-03,
			-5.4436901271035379e-03,
			-6.2099332005789987e-03,
			-6.6585752688129024e-03,
			-6.7564459911755078e-03,
			-6.5051851730812127e-03,
			-5.9398567669696530e-03,
			-5.1244175708076998e-03,
			-4.1445811672236712e-03,
			-3.0988474949679872e-03,
			-2.0886173418156830e-03,
			-1.2083674720230605e-03,
			-5.3682368404778409e-04,
			-1.2994256207468155e-04,
			-1.6312937720701963e-05,
			-1.9533651811177386e-04,
			-6.3826942881801821e-04,
			-1.2919299165380590e-03,
			-2.0846285346840044e-03,
			-2.9336787118278049e-03,
			-3.7537150521758725e-03,
			-4.4649943797227991e-03,
			-5.0008829485004352e-03,
			-5.3138371258321148e-03,
			-5.3793518736309550e-03,
			-5.1975634967488102e-03,
			-4.7924286208576817e-03,
			-4.2086368636085978e-03,
			-3.5066275523056595e-03,
			-2.7562513710705067e-03,
			-2.0297309235400517e-03,
			-1.3946207930107138e-03,
			-9.0744536745818779e-04,
			-6.0860577406278936e-04,
			-5.1900612594937259e-04,
			-6.3866921342376089e-04,
			-9.4741134292545257e-04,
			-1.4074451986459020e-03,
			-1.9675977564371566e-03,
			-2.5686843699185033e-03,
			-3.1494831357300294e-03,
			-3.6527133685297581e-03,
			-4.0304405941984324e-03,
			-4.2484042670866123e-03,
			-4.2888845741868497e-03,
			-4.1518781373592745e-03,
			-3.8545232802731800e-03,
			-3.4288867136646820e-03,
			-2.9183784329575644e-03,
			-2.3731858266620195e-03,
			-1.8452004008041503e-03,
			-1.3829444672204315e-03,
			-1.0269888609260392e-03,
			-8.0628940799744309e-04,
			-7.3576709039982480e-04,
			-8.1532586459111397e-04,
			-1.0303564896150146e-03,
			-1.3536291015861200e-03,
			-1.7483457707424105e-03,
			-2.1720192124304876e-03,
			-2.5807745536125157e-03,
			-2.9336431643978262e-03,
			-3.1964324313856446e-03,
			-3.3448101546203510e-03,
			-3.3663303751960750e-03,
			-3.2612392371368110e-03,
			-3.0420233111918792e-03,
			-2.7317862188577344e-03,
			-2.3616503930592499e-03,
			-1.9674689959335062e-03,
			-1.5861905437874182e-03,
			-1.2522410683509727e-03,
			-9.9427466398135716e-04,
			-8.3259559515763714e-04,
			-7.7747953464935536e-04,
			-8.2852627395160034e-04,
			-9.7507133990883382e-04,
			-1.1975799265481785e-03,
			-1.4698535330309021e-03,
			-1.7618063973658552e-03,
			-2.0425217214412512e-03,
			-2.2832805046993799e-03,
			-2.4602691978870858e-03,
			-2.5567139967416796e-03,
			-2.5642543781053155e-03,
			-2.4834493001293068e-03,
			-2.3233978799414774e-03,
			-2.1005434116360281e-03,
			-1.8368068197719043e-03,
			-1.5572558407831879e-03,
			-1.2875540918299443e-03,
			-1.0514468055615907e-03,
			-8.6852704340490534e-04,
			-7.5248983732441072e-04,
			-7.1002635962914601e-04,
			-7.4044200038222746e-04,
			-8.3600830663262083e-04,
			-9.8298657456748401e-04,
			-1.1631975088320292e-03,
			-1.3559626763776068e-03,
			-1.5402137265742391e-03,
			-1.6965567452652745e-03,
			-1.8090917113925279e-03,
			-1.8668187911241897e-03,
			-1.8645102816544849e-03,
			-1.8029841838057309e-03,
			-1.6887766184948642e-03,
			-1.5332694123788714e-03,
			-1.3513804141545231e-03,
			-1.1599627156203694e-03,



			};
		for(j=0;j<firLength;j++)
			{
			sum_fir+=Fir[j];
			}
		for(j=0;j<3;j++)
			{

			datamid=0.0;
			now_fir=i_fir_list;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+now_fir->data[j]*Fir[i];
				now_fir=now_fir->last;
				}

			i_fir_list->band_pass_data[j]=datamid-mean[j]*sum_fir;
			}
		//		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]),0.5);
		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]+i_fir_list->band_pass_data[2]*i_fir_list->band_pass_data[2]),0.5);


		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataV[j]=now_fir->last->dataV[j]+(now_fir->last->data[j]+now_fir->data[j]-2*mean[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataV[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataV[j]=datamid;
			}
		//		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]+i_fir_list->band_pass_dataV[2]*i_fir_list->band_pass_dataV[2]),0.5);
		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataD[j]=now_fir->last->dataD[j]+(now_fir->last->dataV[j]+now_fir->dataV[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataD[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataD[j]=datamid;
			}
		//		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]+i_fir_list->band_pass_dataD[2]*i_fir_list->band_pass_dataD[2]),0.5);
		return 1;
		}
	else if(i_fir_list->sample_rata==200&&band_pass_flag==1)//0.5-20
				{

				firLength=361;
				double Fir[361]={-1.1599627156203658e-03,
					-1.5060710995311501e-03,
					-1.7391303205345160e-03,
					-1.7704465385105937e-03,
					-1.5864159887195336e-03,
					-1.2571788737614300e-03,
					-9.1281549899176911e-04,
					-6.9500545703237251e-04,
					-7.0204679174990111e-04,
					-9.4850905002557759e-04,
					-1.3559626763776020e-03,
					-1.7797365362198295e-03,
					-2.0627369410397781e-03,
					-2.0963777578345377e-03,
					-1.8650547948559307e-03,
					-1.4560719366881441e-03,
					-1.0297173148966371e-03,
					-7.5957776487409450e-04,
					-7.6524091004565335e-04,
					-1.0634053240321270e-03,
					-1.5572558407831887e-03,
					-2.0697785538279262e-03,
					-2.4097257896398046e-03,
					-2.4457283401660367e-03,
					-2.1599094034417707e-03,
					-1.6592558090058748e-03,
					-1.1386736335317529e-03,
					-8.0830358643508432e-04,
					-8.1211667732874256e-04,
					-1.1692442502777814e-03,
					-1.7618063973658703e-03,
					-2.3757386249015572e-03,
					-2.7806667976374919e-03,
					-2.8191165316900175e-03,
					-2.4705975199346810e-03,
					-1.8646362353038235e-03,
					-1.2357978641779226e-03,
					-8.3611612360992712e-04,
					-8.3752605006683285e-04,
					-1.2619768323868575e-03,
					-1.9674689959335071e-03,
					-2.6974710204985017e-03,
					-3.1767283336126789e-03,
					-3.2177864102268254e-03,
					-2.7971038980982919e-03,
					-2.0700243947243228e-03,
					-1.3166139854128974e-03,
					-8.3702593086160636e-04,
					-8.3537170956612158e-04,
					-1.3369187891394308e-03,
					-2.1720192124304771e-03,
					-3.0353478261582619e-03,
					-3.6000016681784750e-03,
					-3.6439445851101085e-03,
					-3.1400082823201882e-03,
					-2.2731683379482101e-03,
					-1.3758747377123023e-03,
					-8.0379284731593519e-04,
					-7.9826391894540123e-04,
					-1.3885409639829384e-03,
					-2.3731858266620208e-03,
					-3.3905543574232057e-03,
					-4.0539775926945057e-03,
					-4.1012564214443180e-03,
					-3.5008173696211625e-03,
					-2.4717859697603369e-03,
					-1.4072683303699535e-03,
					-7.2740727041207187e-04,
					-7.1697682485034235e-04,
					-1.4101298133363009e-03,
					-2.5686843699185306e-03,
					-3.7655311044330819e-03,
					-4.5442717460061049e-03,
					-4.5956041016358990e-03,
					-3.8824676115895374e-03,
					-2.6635990187098605e-03,
					-1.4029373271117951e-03,
					-5.9625009680467972e-04,
					-5.7956549937430470e-04,
					-1.3932267209427200e-03,
					-2.7562513710705084e-03,
					-4.1646640925698088e-03,
					-5.0797744234833998e-03,
					-5.1362936282929195e-03,
					-4.2901217861520905e-03,
					-2.8463674121412636e-03,
					-1.3526688755018158e-03,
					-3.9468873045780402e-04,
					-3.6988489511960014e-04,
					-1.3266751549705091e-03,
					-2.9336787118278127e-03,
					-4.5954176194609852e-03,
					-5.6745609309150000e-03,
					-5.7380704256605134e-03,
					-4.7324971406031199e-03,
					-3.0179234624567769e-03,
					-1.2424818678010850e-03,
					-1.0063329008406102e-04,
					-6.4999944222174846e-05,
					-1.1949363898158165e-03,
					-3.0988474949679881e-03,
					-5.0703003327281278e-03,
					-6.3512438226524760e-03,
					-6.4246774749463342e-03,
					-5.2242138452293398e-03,
					-3.1762052691649556e-03,
					-1.0520406018881569e-03,
					3.1894369863888126e-04,
					3.6959082748570983e-04,
					-9.7495290195468635e-04,
					-3.2497608336473816e-03,
					-5.6105096055637047e-03,
					-7.1472506548831650e-03,
					-7.2355669882007588e-03,
					-5.7902456457803887e-03,
					-3.3192887511781996e-03,
					-7.4961221778862143e-04,
					9.1678575852882703e-04,
					9.8938552671585319e-04,
					-6.2989389898132110e-04,
					-3.3845749853751404e-03,
					-6.2532457033899281e-03,
					-8.1275581278285897e-03,
					-8.2396385556613699e-03,
					-6.4751010337779245e-03,
					-3.4454177447912327e-03,
					-2.8138571972104420e-04,
					1.7841036143958187e-03,
					1.8912253667593302e-03,
					-9.5505735936814095e-05,
					-3.5016282806181812e-03,
					-7.0679396452383025e-03,
					-9.4132993098778248e-03,
					-9.5664699807925923e-03,
					-7.3639352932390999e-03,
					-3.5530316344616207e-03,
					4.5381438918271728e-04,
					3.0955298870779606e-03,
					3.2627471640869362e-03,
					7.5355480081440690e-04,
					-3.5994673328447737e-03,
					-8.1973965965611000e-03,
					-1.1255486518626975e-02,
					-1.1488137963625336e-02,
					-8.6387958686039330e-03,
					-3.6407900253356842e-03,
					1.6744843665524036e-03,
					5.2358544566855304e-03,
					5.5246048332387859e-03,
					2.2025980084523864e-03,
					-3.6768700634405124e-03,
					-9.9840011609225333e-03,
					-1.4266644277235186e-02,
					-1.4682793132343061e-02,
					-1.0764597307894870e-02,
					-3.7075940176711964e-03,
					3.9613453499188897e-03,
					9.2574278325954339e-03,
					9.8606229949844797e-03,
					5.0783478731212042e-03,
					-3.7328651304630051e-03,
					-1.3494380947244311e-02,
					-2.0424457630318284e-02,
					-2.1428401082028776e-02,
					-1.5372405773285703e-02,
					-3.7526037029152405e-03,
					9.5519164872009885e-03,
					1.9448731931702101e-02,
					2.1398797446128631e-02,
					1.3211100822003467e-02,
					-3.7667474136118748e-03,
					-2.4541674377520955e-02,
					-4.1602598650593250e-02,
					-4.7028342487253814e-02,
					-3.4975352107978842e-02,
					-3.7752515680949473e-03,
					4.3053894561216943e-02,
					9.7274593665651068e-02,
					1.4782263543297211e-01,
					1.8362715919963524e-01,
					1.9655639891534471e-01,
					1.8362715919963524e-01,
					1.4782263543297208e-01,
					9.7274593665651068e-02,
					4.3053894561216957e-02,
					-3.7752515680949473e-03,
					-3.4975352107978842e-02,
					-4.7028342487253814e-02,
					-4.1602598650593250e-02,
					-2.4541674377520948e-02,
					-3.7667474136118735e-03,
					1.3211100822003467e-02,
					2.1398797446128631e-02,
					1.9448731931702105e-02,
					9.5519164872009885e-03,
					-3.7526037029152405e-03,
					-1.5372405773285703e-02,
					-2.1428401082028776e-02,
					-2.0424457630318280e-02,
					-1.3494380947244309e-02,
					-3.7328651304630051e-03,
					5.0783478731212042e-03,
					9.8606229949844814e-03,
					9.2574278325954357e-03,
					3.9613453499188879e-03,
					-3.7075940176711964e-03,
					-1.0764597307894870e-02,
					-1.4682793132343061e-02,
					-1.4266644277235192e-02,
					-9.9840011609225298e-03,
					-3.6768700634405124e-03,
					2.2025980084523868e-03,
					5.5246048332387851e-03,
					5.2358544566855295e-03,
					1.6744843665524036e-03,
					-3.6407900253356855e-03,
					-8.6387958686039330e-03,
					-1.1488137963625336e-02,
					-1.1255486518626975e-02,
					-8.1973965965611000e-03,
					-3.5994673328447733e-03,
					7.5355480081440690e-04,
					3.2627471640869362e-03,
					3.0955298870779602e-03,
					4.5381438918271858e-04,
					-3.5530316344616207e-03,
					-7.3639352932390982e-03,
					-9.5664699807925923e-03,
					-9.4132993098778282e-03,
					-7.0679396452383025e-03,
					-3.5016282806181803e-03,
					-9.5505735936814095e-05,
					1.8912253667593307e-03,
					1.7841036143958187e-03,
					-2.8138571972104333e-04,
					-3.4454177447912327e-03,
					-6.4751010337779245e-03,
					-8.2396385556613699e-03,
					-8.1275581278285880e-03,
					-6.2532457033899289e-03,
					-3.3845749853751396e-03,
					-6.2989389898132110e-04,
					9.8938552671585362e-04,
					9.1678575852882703e-04,
					-7.4961221778862186e-04,
					-3.3192887511781996e-03,
					-5.7902456457803895e-03,
					-7.2355669882007588e-03,
					-7.1472506548831650e-03,
					-5.6105096055637047e-03,
					-3.2497608336473811e-03,
					-9.7495290195468635e-04,
					3.6959082748570983e-04,
					3.1894369863888126e-04,
					-1.0520406018881565e-03,
					-3.1762052691649565e-03,
					-5.2242138452293398e-03,
					-6.4246774749463350e-03,
					-6.3512438226524777e-03,
					-5.0703003327281278e-03,
					-3.0988474949679890e-03,
					-1.1949363898158170e-03,
					-6.4999944222174846e-05,
					-1.0063329008406102e-04,
					-1.2424818678010850e-03,
					-3.0179234624567769e-03,
					-4.7324971406031207e-03,
					-5.7380704256605134e-03,
					-5.6745609309150000e-03,
					-4.5954176194609861e-03,
					-2.9336787118278127e-03,
					-1.3266751549705093e-03,
					-3.6988489511960014e-04,
					-3.9468873045780359e-04,
					-1.3526688755018167e-03,
					-2.8463674121412641e-03,
					-4.2901217861520896e-03,
					-5.1362936282929195e-03,
					-5.0797744234833998e-03,
					-4.1646640925698097e-03,
					-2.7562513710705084e-03,
					-1.3932267209427200e-03,
					-5.7956549937430426e-04,
					-5.9625009680467972e-04,
					-1.4029373271117951e-03,
					-2.6635990187098605e-03,
					-3.8824676115895383e-03,
					-4.5956041016358990e-03,
					-4.5442717460061040e-03,
					-3.7655311044330819e-03,
					-2.5686843699185310e-03,
					-1.4101298133363011e-03,
					-7.1697682485034257e-04,
					-7.2740727041207187e-04,
					-1.4072683303699535e-03,
					-2.4717859697603374e-03,
					-3.5008173696211625e-03,
					-4.1012564214443189e-03,
					-4.0539775926945057e-03,
					-3.3905543574232057e-03,
					-2.3731858266620208e-03,
					-1.3885409639829384e-03,
					-7.9826391894540101e-04,
					-8.0379284731593519e-04,
					-1.3758747377123023e-03,
					-2.2731683379482105e-03,
					-3.1400082823201882e-03,
					-3.6439445851101085e-03,
					-3.6000016681784755e-03,
					-3.0353478261582632e-03,
					-2.1720192124304780e-03,
					-1.3369187891394314e-03,
					-8.3537170956612158e-04,
					-8.3702593086160701e-04,
					-1.3166139854128974e-03,
					-2.0700243947243241e-03,
					-2.7971038980982932e-03,
					-3.2177864102268263e-03,
					-3.1767283336126789e-03,
					-2.6974710204985030e-03,
					-1.9674689959335075e-03,
					-1.2619768323868579e-03,
					-8.3752605006683285e-04,
					-8.3611612360992734e-04,
					-1.2357978641779231e-03,
					-1.8646362353038242e-03,
					-2.4705975199346810e-03,
					-2.8191165316900193e-03,
					-2.7806667976374919e-03,
					-2.3757386249015577e-03,
					-1.7618063973658706e-03,
					-1.1692442502777823e-03,
					-8.1211667732874256e-04,
					-8.0830358643508475e-04,
					-1.1386736335317531e-03,
					-1.6592558090058761e-03,
					-2.1599094034417715e-03,
					-2.4457283401660371e-03,
					-2.4097257896398059e-03,
					-2.0697785538279279e-03,
					-1.5572558407831890e-03,
					-1.0634053240321281e-03,
					-7.6524091004565400e-04,
					-7.5957776487409450e-04,
					-1.0297173148966377e-03,
					-1.4560719366881443e-03,
					-1.8650547948559329e-03,
					-2.0963777578345381e-03,
					-2.0627369410397790e-03,
					-1.7797365362198297e-03,
					-1.3559626763776031e-03,
					-9.4850905002557824e-04,
					-7.0204679174990122e-04,
					-6.9500545703237294e-04,
					-9.1281549899176976e-04,
					-1.2571788737614309e-03,
					-1.5864159887195352e-03,
					-1.7704465385105744e-03,
					-1.7391303205345871e-03,
					-1.5060710995311183e-03,
					-1.1599627156203699e-03,




					};
				for(j=0;j<firLength;j++)
					{
					sum_fir+=Fir[j];
					}
				for(j=0;j<3;j++)
					{

					datamid=0.0;
					now_fir=i_fir_list;
					for(i=0;i<firLength;i++)
						{
						datamid=datamid+now_fir->data[j]*Fir[i];
						now_fir=now_fir->last;
						}

					i_fir_list->band_pass_data[j]=datamid-mean[j]*sum_fir;
					}
				//		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]),0.5);
				i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]+i_fir_list->band_pass_data[2]*i_fir_list->band_pass_data[2]),0.5);


				for(j=0;j<3;j++)
					{
					datamid=0.0;
					now_fir=i_fir_list;
					now_fir->dataV[j]=now_fir->last->dataV[j]+(now_fir->last->data[j]+now_fir->data[j]-2*mean[j])*0.5/sample_rata;
					for(i=0;i<firLength;i++)
						{
						datamid=datamid+(now_fir->dataV[j])*Fir[i];
						now_fir=now_fir->last;
						}
					i_fir_list->band_pass_dataV[j]=datamid;
					}
				//		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
				i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]+i_fir_list->band_pass_dataV[2]*i_fir_list->band_pass_dataV[2]),0.5);
				for(j=0;j<3;j++)
					{
					datamid=0.0;
					now_fir=i_fir_list;
					now_fir->dataD[j]=now_fir->last->dataD[j]+(now_fir->last->dataV[j]+now_fir->dataV[j])*0.5/sample_rata;
					for(i=0;i<firLength;i++)
						{
						datamid=datamid+(now_fir->dataD[j])*Fir[i];
						now_fir=now_fir->last;
						}
					i_fir_list->band_pass_dataD[j]=datamid;
					}
				//		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
				i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]+i_fir_list->band_pass_dataD[2]*i_fir_list->band_pass_dataD[2]),0.5);
				return 1;
		}
	else if(i_fir_list->sample_rata==200&&(band_pass_flag==2||band_pass_flag==4))//0.3-10  0.1-10
		{
		firLength=541;

		double Fir[541]={-9.2099036038378532e-04,
			-7.8804826816350514e-04,
			-6.6560344061362866e-04,
			-5.6687547227462695e-04,
			-5.0305195443362731e-04,
			-4.8212458142003447e-04,
			-5.0801522925230963e-04,
			-5.8008622249482611e-04,
			-6.9309294300030314e-04,
			-8.3759419607064940e-04,
			-1.0007904473973064e-03,
			-1.1677166438897948e-03,
			-1.3226792145237351e-03,
			-1.4507998700714149e-03,
			-1.5395149164156340e-03,
			-1.5798796606311268e-03,
			-1.5675433814101799e-03,
			-1.5032900196379525e-03,
			-1.3930805785312536e-03,
			-1.2475813887482972e-03,
			-1.0812132551662164e-03,
			-9.1080504603679199e-04,
			-7.5397661608138985e-04,
			-6.2740578524895022e-04,
			-5.4514918710074384e-04,
			-5.1718531515799690e-04,
			-5.4832980445290475e-04,
			-6.3763933271860978e-04,
			-7.7837451944441324e-04,
			-9.5853814908441635e-04,
			-1.1619481531160475e-03,
			-1.3697506595220668e-03,
			-1.5622325114940184e-03,
			-1.7207597251464868e-03,
			-1.8296519661545247e-03,
			-1.8778052751213447e-03,
			-1.8598961554604190e-03,
			-1.7770380880220437e-03,
			-1.6368131495740684e-03,
			-1.4526618487227868e-03,
			-1.2426777301980229e-03,
			-1.0279134888687795e-03,
			-8.3035621871027751e-04,
			-6.7076573516148576e-04,
			-5.6658772472861297e-04,
			-5.3015062268610609e-04,
			-5.6733143777716296e-04,
			-6.7683314040934404e-04,
			-8.5015853938458274e-04,
			-1.0722982056842946e-03,
			-1.3230794514709333e-03,
			-1.5790565837738907e-03,
			-1.8157663436507616e-03,
			-2.0101324311648091e-03,
			-2.1427836247891099e-03,
			-2.2000535925879644e-03,
			-2.1754571889266504e-03,
			-2.0704856679088202e-03,
			-1.8946275302998378e-03,
			-1.6645966177239893e-03,
			-1.4028273596775336e-03,
			-1.1353710613629898e-03,
			-8.8938935754289306e-04,
			-6.9048502597345474e-04,
			-5.6013150133180209e-04,
			-5.1345808254886992e-04,
			-5.5761788704660181e-04,
			-6.9091251719947467e-04,
			-9.0277595818363658e-04,
			-1.1746371336738743e-03,
			-1.4815938115070816e-03,
			-1.7947487057919354e-03,
			-2.0839898846883352e-03,
			-2.3209490512706072e-03,
			-2.4818481466164577e-03,
			-2.5499498422015465e-03,
			-2.5173609120326093e-03,
			-2.3859964670479806e-03,
			-2.1675922672027342e-03,
			-1.8827443572853935e-03,
			-1.5590512379570593e-03,
			-1.2285242513423947e-03,
			-9.2450775236682355e-04,
			-6.7840413588373869e-04,
			-5.1652413990349946e-04,
			-4.5737696479821453e-04,
			-5.0967758766085958e-04,
			-6.7128325883947910e-04,
			-9.2918345122575824e-04,
			-1.2605657298138107e-03,
			-1.6348739179959412e-03,
			-2.0166749784740114e-03,
			-2.3690672229614647e-03,
			-2.6573034400949446e-03,
			-2.8522746288034552e-03,
			-2.9335066344339071e-03,
			-2.8913631482099544e-03,
			-2.7282208685875907e-03,
			-2.4584796038279720e-03,
			-2.1073826169179673e-03,
			-1.7087397545895546e-03,
			-1.3017563556190544e-03,
			-9.2726353456713112e-04,
			-6.2371066482157266e-04,
			-4.2331173523314162e-04,
			-3.4872998370800008e-04,
			-4.1063976990715308e-04,
			-6.0642476251474388e-04,
			-9.2016438994335105e-04,
			-1.3239361803047587e-03,
			-1.7803320420881636e-03,
			-2.2459644154696938e-03,
			-2.6756357782218845e-03,
			-3.0267727437604114e-03,
			-3.2636916931282249e-03,
			-3.3612706949638629e-03,
			-3.3076524683700241e-03,
			-3.1056912475649718e-03,
			-2.7729746824372565e-03,
			-2.3403892837598060e-03,
			-1.8493412139778430e-03,
			-1.3478794014496636e-03,
			-8.8608150223198922e-04,
			-5.1114349515264787e-04,
			-2.6265206842258714e-04,
			-1.6851079481957512e-04,
			-2.4193625100973236e-04,
			-4.7984317191924781e-04,
			-8.6280715728713074e-04,
			-1.3566415625985743e-03,
			-1.9154665600813400e-03,
			-2.4859984617802782e-03,
			-3.0126612251738065e-03,
			-3.4430325498542480e-03,
			-3.7330937104403427e-03,
			-3.8517604832979464e-03,
			-3.7842324736531100e-03,
			-3.5338050023559580e-03,
			-3.1219319124799489e-03,
			-2.5864957712039751e-03,
			-1.9784179024470525e-03,
			-1.3569073131266510e-03,
			-7.8378825350351668e-04,
			-3.1744647022797834e-04,
			-6.9834312824419518e-06,
			1.1284000836526972e-04,
			2.5354317567758977e-05,
			-2.6597224788052265e-04,
			-7.3743067972836655e-04,
			-1.3469646033695993e-03,
			-2.0379172193921657e-03,
			-2.7443031575346403e-03,
			-3.3971190584163721e-03,
			-3.9310935787960494e-03,
			-4.2912209155740550e-03,
			-4.4384286657659696e-03,
			-4.3538016122489434e-03,
			-4.0409122987702514e-03,
			-3.5259856147050032e-03,
			-2.8558317578400881e-03,
			-2.0937002074628681e-03,
			-1.3134155200516908e-03,
			-5.9233317583970750e-04,
			-3.7822358250078755e-06,
			3.9027251319353107e-04,
			5.4562083721612718e-04,
			4.4059792201310989e-04,
			7.8766065900046770e-05,
			-5.1082710083981203e-04,
			-1.2758972595056852e-03,
			-2.1455177714411132e-03,
			-3.0366641508699954e-03,
			-3.8621118097987728e-03,
			-4.5389428080685424e-03,
			-4.9968394044701686e-03,
			-5.1853430528545691e-03,
			-5.0793389195515149e-03,
			-4.6821819764329082e-03,
			-4.0260977778495107e-03,
			-3.1697493995113059e-03,
			-2.1931374329631778e-03,
			-1.1902658708177875e-03,
			-2.6023694791261148e-04,
			5.0239086906258580e-04,
			1.0170537242174349e-03,
			1.2255086096815426e-03,
			1.0981873138275063e-03,
			6.3790127253392042e-04,
			-1.1953798113192900e-04,
			-1.1079276778061561e-03,
			-2.2363446488090528e-03,
			-3.3974065727959773e-03,
			-4.4773856919170718e-03,
			-5.3672354801872664e-03,
			-5.9734753110310982e-03,
			-6.2278624174949846e-03,
			-6.0948685932705384e-03,
			-5.5761654078248781e-03,
			-4.7115908003906980e-03,
			-3.5763979419758700e-03,
			-2.2749440304833169e-03,
			-9.3132842805940036e-04,
			3.2219796078291040e-04,
			1.3579883121752859e-03,
			2.0657109495232774e-03,
			2.3637734346849855e-03,
			2.2083038115951678e-03,
			1.5987342434481875e-03,
			5.7933196288304162e-04,
			-7.6360523631937476e-04,
			-2.3087604573219398e-03,
			-3.9104757284739783e-03,
			-5.4121833258849901e-03,
			-6.6613801997739783e-03,
			-7.5247452268142716e-03,
			-7.9019373222448622e-03,
			-7.7366891333259091e-03,
			-7.0240232005336425e-03,
			-5.8127492393513962e-03,
			-4.2028248373273342e-03,
			-2.3376400760274124e-03,
			-3.9177573876898449e-04,
			1.4447611912945188e-03,
			2.9844462893490794e-03,
			4.0606549183290512e-03,
			4.5448405291744071e-03,
			4.3607762636084981e-03,
			3.4943738979672815e-03,
			1.9979539455294236e-03,
			-1.1679981628951848e-05,
			-2.3614511802506899e-03,
			-4.8360047833993728e-03,
			-7.1964238219141821e-03,
			-9.2021151553450583e-03,
			-1.0633951165805386e-02,
			-1.1316552798255641e-02,
			-1.1137586000254470e-02,
			-1.0062124842053854e-02,
			-8.1405010867291669e-03,
			-5.5085851061377634e-03,
			-2.3800849646007840e-03,
			9.6884449252551230e-04,
			4.2216836898676243e-03,
			7.0486768194433849e-03,
			9.1368371170709086e-03,
			1.0220305897430315e-02,
			1.0108397670110335e-02,
			8.7087474354680741e-03,
			6.0432886744458819e-03,
			2.2553117568610858e-03,
			-2.3934561482566973e-03,
			-7.5360015862024794e-03,
			-1.2722801055507309e-02,
			-1.7452784005121087e-02,
			-2.1210303569516521e-02,
			-2.3505355684549270e-02,
			-2.3913919959109343e-02,
			-2.2115177846259819e-02,
			-1.7922511198655740e-02,
			-1.1305590976966528e-02,
			-2.4015034641907277e-03,
			8.4863183807199517e-03,
			2.0901652188791666e-02,
			3.4260844192471288e-02,
			4.7888335453839595e-02,
			6.1059894106108653e-02,
			7.3050446110118419e-02,
			8.3182990982319571e-02,
			9.0874957753215704e-02,
			9.5678513253330877e-02,
			9.7311769218428879e-02,
			9.5678513253330918e-02,
			9.0874957753215677e-02,
			8.3182990982319585e-02,
			7.3050446110118419e-02,
			6.1059894106108667e-02,
			4.7888335453839609e-02,
			3.4260844192471288e-02,
			2.0901652188791666e-02,
			8.4863183807199569e-03,
			-2.4015034641907285e-03,
			-1.1305590976966534e-02,
			-1.7922511198655757e-02,
			-2.2115177846259833e-02,
			-2.3913919959109346e-02,
			-2.3505355684549270e-02,
			-2.1210303569516531e-02,
			-1.7452784005121090e-02,
			-1.2722801055507311e-02,
			-7.5360015862024829e-03,
			-2.3934561482566981e-03,
			2.2553117568610867e-03,
			6.0432886744458819e-03,
			8.7087474354680741e-03,
			1.0108397670110337e-02,
			1.0220305897430322e-02,
			9.1368371170709086e-03,
			7.0486768194433849e-03,
			4.2216836898676261e-03,
			9.6884449252551273e-04,
			-2.3800849646007844e-03,
			-5.5085851061377642e-03,
			-8.1405010867291686e-03,
			-1.0062124842053856e-02,
			-1.1137586000254470e-02,
			-1.1316552798255644e-02,
			-1.0633951165805386e-02,
			-9.2021151553450635e-03,
			-7.1964238219141838e-03,
			-4.8360047833993763e-03,
			-2.3614511802506908e-03,
			-1.1679981628951848e-05,
			1.9979539455294258e-03,
			3.4943738979672854e-03,
			4.3607762636085007e-03,
			4.5448405291744088e-03,
			4.0606549183290546e-03,
			2.9844462893490803e-03,
			1.4447611912945196e-03,
			-3.9177573876898449e-04,
			-2.3376400760274133e-03,
			-4.2028248373273359e-03,
			-5.8127492393514005e-03,
			-7.0240232005336460e-03,
			-7.7366891333259160e-03,
			-7.9019373222448709e-03,
			-7.5247452268142768e-03,
			-6.6613801997739835e-03,
			-5.4121833258849944e-03,
			-3.9104757284739800e-03,
			-2.3087604573219420e-03,
			-7.6360523631937541e-04,
			5.7933196288304206e-04,
			1.5987342434481888e-03,
			2.2083038115951695e-03,
			2.3637734346849881e-03,
			2.0657109495232787e-03,
			1.3579883121752868e-03,
			3.2219796078291127e-04,
			-9.3132842805940057e-04,
			-2.2749440304833191e-03,
			-3.5763979419758734e-03,
			-4.7115908003907024e-03,
			-5.5761654078248851e-03,
			-6.0948685932705410e-03,
			-6.2278624174949872e-03,
			-5.9734753110311043e-03,
			-5.3672354801872690e-03,
			-4.4773856919170770e-03,
			-3.3974065727959803e-03,
			-2.2363446488090563e-03,
			-1.1079276778061574e-03,
			-1.1953798113192943e-04,
			6.3790127253392085e-04,
			1.0981873138275076e-03,
			1.2255086096815435e-03,
			1.0170537242174358e-03,
			5.0239086906258667e-04,
			-2.6023694791261213e-04,
			-1.1902658708177892e-03,
			-2.1931374329631804e-03,
			-3.1697493995113107e-03,
			-4.0260977778495150e-03,
			-4.6821819764329151e-03,
			-5.0793389195515218e-03,
			-5.1853430528545760e-03,
			-4.9968394044701747e-03,
			-4.5389428080685442e-03,
			-3.8621118097987776e-03,
			-3.0366641508699980e-03,
			-2.1455177714411145e-03,
			-1.2758972595056867e-03,
			-5.1082710083981311e-04,
			7.8766065900046770e-05,
			4.4059792201311075e-04,
			5.4562083721612805e-04,
			3.9027251319353150e-04,
			-3.7822358250078755e-06,
			-5.9233317583970880e-04,
			-1.3134155200516921e-03,
			-2.0937002074628711e-03,
			-2.8558317578400915e-03,
			-3.5259856147050088e-03,
			-4.0409122987702592e-03,
			-4.3538016122489503e-03,
			-4.4384286657659757e-03,
			-4.2912209155740620e-03,
			-3.9310935787960546e-03,
			-3.3971190584163777e-03,
			-2.7443031575346438e-03,
			-2.0379172193921687e-03,
			-1.3469646033696017e-03,
			-7.3743067972836828e-04,
			-2.6597224788052351e-04,
			2.5354317567759410e-05,
			1.1284000836526972e-04,
			-6.9834312824415181e-06,
			-3.1744647022797877e-04,
			-7.8378825350351841e-04,
			-1.3569073131266529e-03,
			-1.9784179024470564e-03,
			-2.5864957712039799e-03,
			-3.1219319124799550e-03,
			-3.5338050023559641e-03,
			-3.7842324736531187e-03,
			-3.8517604832979556e-03,
			-3.7330937104403505e-03,
			-3.4430325498542550e-03,
			-3.0126612251738143e-03,
			-2.4859984617802843e-03,
			-1.9154665600813439e-03,
			-1.3566415625985765e-03,
			-8.6280715728713248e-04,
			-4.7984317191924932e-04,
			-2.4193625100973301e-04,
			-1.6851079481957555e-04,
			-2.6265206842258801e-04,
			-5.1114349515264874e-04,
			-8.8608150223199096e-04,
			-1.3478794014496660e-03,
			-1.8493412139778472e-03,
			-2.3403892837598117e-03,
			-2.7729746824372626e-03,
			-3.1056912475649788e-03,
			-3.3076524683700315e-03,
			-3.3612706949638690e-03,
			-3.2636916931282319e-03,
			-3.0267727437604183e-03,
			-2.6756357782218901e-03,
			-2.2459644154696990e-03,
			-1.7803320420881675e-03,
			-1.3239361803047617e-03,
			-9.2016438994335268e-04,
			-6.0642476251474497e-04,
			-4.1063976990715395e-04,
			-3.4872998370800073e-04,
			-4.2331173523314271e-04,
			-6.2371066482157418e-04,
			-9.2726353456713318e-04,
			-1.3017563556190573e-03,
			-1.7087397545895596e-03,
			-2.1073826169179721e-03,
			-2.4584796038279785e-03,
			-2.7282208685875963e-03,
			-2.8913631482099622e-03,
			-2.9335066344339149e-03,
			-2.8522746288034630e-03,
			-2.6573034400949511e-03,
			-2.3690672229614721e-03,
			-2.0166749784740171e-03,
			-1.6348739179959453e-03,
			-1.2605657298138137e-03,
			-9.2918345122576030e-04,
			-6.7128325883948105e-04,
			-5.0967758766086110e-04,
			-4.5737696479821561e-04,
			-5.1652413990350054e-04,
			-6.7840413588374053e-04,
			-9.2450775236682593e-04,
			-1.2285242513423978e-03,
			-1.5590512379570643e-03,
			-1.8827443572853996e-03,
			-2.1675922672027411e-03,
			-2.3859964670479871e-03,
			-2.5173609120326171e-03,
			-2.5499498422015530e-03,
			-2.4818481466164642e-03,
			-2.3209490512706150e-03,
			-2.0839898846883422e-03,
			-1.7947487057919410e-03,
			-1.4815938115070857e-03,
			-1.1746371336738774e-03,
			-9.0277595818363940e-04,
			-6.9091251719947640e-04,
			-5.5761788704660311e-04,
			-5.1345808254887144e-04,
			-5.6013150133180361e-04,
			-6.9048502597345647e-04,
			-8.8938935754289588e-04,
			-1.1353710613629931e-03,
			-1.4028273596775388e-03,
			-1.6645966177239954e-03,
			-1.8946275302998434e-03,
			-2.0704856679088272e-03,
			-2.1754571889266573e-03,
			-2.2000535925879735e-03,
			-2.1427836247891172e-03,
			-2.0101324311648161e-03,
			-1.8157663436507688e-03,
			-1.5790565837738965e-03,
			-1.3230794514709379e-03,
			-1.0722982056842985e-03,
			-8.5015853938458566e-04,
			-6.7683314040934653e-04,
			-5.6733143777716502e-04,
			-5.3015062268610771e-04,
			-5.6658772472861503e-04,
			-6.7076573516148782e-04,
			-8.3035621871028087e-04,
			-1.0279134888687830e-03,
			-1.2426777301980277e-03,
			-1.4526618487227918e-03,
			-1.6368131495740745e-03,
			-1.7770380880220505e-03,
			-1.8598961554604264e-03,
			-1.8778052751213517e-03,
			-1.8296519661545317e-03,
			-1.7207597251464937e-03,
			-1.5622325114940253e-03,
			-1.3697506595220725e-03,
			-1.1619481531160521e-03,
			-9.5853814908442015e-04,
			-7.7837451944441616e-04,
			-6.3763933271861217e-04,
			-5.4832980445290724e-04,
			-5.1718531515799874e-04,
			-5.4514918710074623e-04,
			-6.2740578524895249e-04,
			-7.5397661608139343e-04,
			-9.1080504603679589e-04,
			-1.0812132551662208e-03,
			-1.2475813887483022e-03,
			-1.3930805785312590e-03,
			-1.5032900196379592e-03,
			-1.5675433814101875e-03,
			-1.5798796606311340e-03,
			-1.5395149164156405e-03,
			-1.4507998700714214e-03,
			-1.3226792145237412e-03,
			-1.1677166438897998e-03,
			-1.0007904473973103e-03,
			-8.3759419607065287e-04,
			-6.9309294300030650e-04,
			-5.8008622249482893e-04,
			-5.0801522925231191e-04,
			-4.8212458142003674e-04,
			-5.0305195443362970e-04,
			-5.6687547227462652e-04,
			-6.6560344061365078e-04,
			-7.8804826816350926e-04,
			-9.2099036038381839e-04,



			};
		for(j=0;j<firLength;j++)
			{
			sum_fir+=Fir[j];
			}
		for(j=0;j<3;j++)
			{

			datamid=0.0;
			now_fir=i_fir_list;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+now_fir->data[j]*Fir[i];
				now_fir=now_fir->last;
				}

			i_fir_list->band_pass_data[j]=datamid-mean[j]*sum_fir;
			}
		//		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]),0.5);
		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]+i_fir_list->band_pass_data[2]*i_fir_list->band_pass_data[2]),0.5);


		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataV[j]=now_fir->last->dataV[j]+(now_fir->last->data[j]+now_fir->data[j]-2*mean[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataV[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataV[j]=datamid;
			}
		//		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]+i_fir_list->band_pass_dataV[2]*i_fir_list->band_pass_dataV[2]),0.5);
		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataD[j]=now_fir->last->dataD[j]+(now_fir->last->dataV[j]+now_fir->dataV[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataD[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataD[j]=datamid;
			}
		//		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]+i_fir_list->band_pass_dataD[2]*i_fir_list->band_pass_dataD[2]),0.5);
		return 1;
		}
	else if(i_fir_list->sample_rata==200&&(band_pass_flag==3||band_pass_flag==5)) //0.3-20 0.1-20
		{
		firLength=541;

		double Fir[541]={-7.7188074593987212e-04,
			-9.9603027029706507e-04,
			-1.1430252604327509e-03,
			-1.1568634454878276e-03,
			-1.0315742215661480e-03,
			-8.1501835066161436e-04,
			-5.9189136586438164e-04,
			-4.5192293060263440e-04,
			-4.5519300417451295e-04,
			-6.0795314082137230e-04,
			-8.5864752868663888e-04,
			-1.1162604567117465e-03,
			-1.2845053320326401e-03,
			-1.2990324612614536e-03,
			-1.1532963499778343e-03,
			-9.0272122976937995e-04,
			-6.4493843126178123e-04,
			-4.8309668494353572e-04,
			-4.8601249597531303e-04,
			-6.6053602348671234e-04,
			-9.4719118547236176e-04,
			-1.2414202283586348e-03,
			-1.4328910178956528e-03,
			-1.4481113993055218e-03,
			-1.2799118265123389e-03,
			-9.9200798193757470e-04,
			-6.9620483086476595e-04,
			-5.1034990678758784e-04,
			-5.1282596998290157e-04,
			-7.1113445160838490e-04,
			-1.0371211352280143e-03,
			-1.3713957371193060e-03,
			-1.5882451526843880e-03,
			-1.6041677843164066e-03,
			-1.4113134710927371e-03,
			-1.0824791691068575e-03,
			-7.4499046023498441e-04,
			-5.3278899658178570e-04,
			-5.3473097251143691e-04,
			-7.5903001230421814e-04,
			-1.1280296951106199e-03,
			-1.5060994658299340e-03,
			-1.7506853864653633e-03,
			-1.7673257900250715e-03,
			-1.5474241199680367e-03,
			-1.1737194947732405e-03,
			-7.9053139803598896e-04,
			-5.4942524462625727e-04,
			-5.5072839963611099e-04,
			-8.0343791285577757e-04,
			-1.2194946038478793e-03,
			-1.6454834872589915e-03,
			-1.9204045261978927e-03,
			-1.9377870499384751e-03,
			-1.6882107712827546e-03,
			-1.2653003983722736e-03,
			-8.3199034423475844e-04,
			-5.5915725018883212e-04,
			-5.5970440314385202e-04,
			-8.4349648232051751e-04,
			-1.3110816824173778e-03,
			-1.7895559844669220e-03,
			-2.0976962193826067e-03,
			-2.1158569642515525e-03,
			-1.8337022754955799e-03,
			-1.3567827773557639e-03,
			-8.6844355888743502e-04,
			-5.6074741995525948e-04,
			-5.6040618872850846e-04,
			-8.7825282440997209e-04,
			-1.4023476124818838e-03,
			-1.9384021050804223e-03,
			-2.2829877894727166e-03,
			-2.3019783770460889e-03,
			-1.9840117627318034e-03,
			-1.4477198168144287e-03,
			-8.9886298096860295e-04,
			-5.5279034585916840e-04,
			-5.5140942759723615e-04,
			-9.0664315463841844e-04,
			-1.4928428119057756e-03,
			-2.0922106828287095e-03,
			-2.4768828093800787e-03,
			-2.4967753064544019e-03,
			-2.1393655190524450e-03,
			-1.5376599054839997e-03,
			-9.2209164076667485e-04,
			-5.3366990917168104e-04,
			-5.3107400963987742e-04,
			-9.2746571488591168e-04,
			-1.5821143857468291e-03,
			-2.2513090529741962e-03,
			-2.6802171696830904e-03,
			-2.7011106309814685e-03,
			-2.3001408101500751e-03,
			-1.6261496161299202e-03,
			-9.3680962132196061e-04,
			-5.0150050926443346e-04,
			-4.9748335425438869e-04,
			-9.3934318248717677e-04,
			-1.6697091303642375e-03,
			-2.4162092515083271e-03,
			-2.8941341961452355e-03,
			-2.9161635142358074e-03,
			-2.4669163646660248e-03,
			-1.7127367276437919e-03,
			-9.4148649600963013e-04,
			-4.5404556772049218e-04,
			-4.4836014331613649e-04,
			-9.4066996984811381e-04,
			-1.7551765677150609e-03,
			-2.5876705537394525e-03,
			-3.1201871940615827e-03,
			-3.1435353072795072e-03,
			-2.6405411438780797e-03,
			-1.7969732657100008e-03,
			-9.3431406514795691e-04,
			-3.8860288893697475e-04,
			-3.8094759717398482e-04,
			-9.2953738330699782e-04,
			-1.8380719865324145e-03,
			-2.7667859804345902e-03,
			-3.3604823371651991e-03,
			-3.3853974358017897e-03,
			-2.8222301198658267e-03,
			-1.8784185386198852e-03,
			-9.1310979552756489e-04,
			-3.0184064258026829e-04,
			-2.9183929853825386e-04,
			-9.0362563368652569e-04,
			-1.9179594668939754e-03,
			-2.9551048031628614e-03,
			-3.6178823206346085e-03,
			-3.6447026801626776e-03,
			-3.0137009285067145e-03,
			-1.9566421447212560e-03,
			-8.7517565170663414e-04,
			-1.8955798216129140e-04,
			-1.7673028326501856e-04,
			-8.6004498315006496e-04,
			-1.9944148647006838e-03,
			-3.1548105565966525e-03,
			-3.8963039747458806e-03,
			-3.9254947566759795e-03,
			-3.2173740827695510e-03,
			-2.0312269281050482e-03,
			-8.1708714496734778e-04,
			-4.6327428002479885e-05,
			-3.0044243277023857e-05,
			-7.9509661592604922e-04,
			-2.0670287327938957e-03,
			-3.3689871961330711e-03,
			-4.2011655582456335e-03,
			-4.2333749940477909e-03,
			-3.4366750935388578e-03,
			-2.1017718594332734e-03,
			-7.3436977631419881e-04,
			1.3505419228893986e-04,
			1.5564054990569807e-04,
			-7.0390263923220044e-04,
			-2.1354091558438049e-03,
			-3.6020300117276883e-03,
			-4.5400807420373163e-03,
			-4.5762288752536412e-03,
			-3.6765058047901525e-03,
			-2.1678948193175748e-03,
			-6.2098712652796653e-04,
			3.6443629466090727e-04,
			3.9050467387357474e-04,
			-5.7981456484613883e-04,
			-2.1991844767382052e-03,
			-3.8603036745255403e-03,
			-4.9239755060900819e-03,
			-4.9653999943319099e-03,
			-3.9440083590270856e-03,
			-2.2292352623449058e-03,
			-4.6850040009377349e-04,
			6.5574848042658669e-04,
			6.8899845321778494e-04,
			-4.1342994962956985e-04,
			-2.2580058929888617e-03,
			-4.1532418382006298e-03,
			-5.3689643971868818e-03,
			-5.4176714591411606e-03,
			-4.2498600364330244e-03,
			-2.2854567407306144e-03,
			-2.6462573339489087e-04,
			1.0294729044537773e-03,
			1.0724602442609458e-03,
			-1.9087867574249425e-04,
			-2.3115499026355045e-03,
			-4.4952796234403814e-03,
			-5.8996676940083117e-03,
			-5.9587888540155974e-03,
			-4.6105880180561795e-03,
			-2.3362492676286288e-03,
			9.3802804821468602e-06,
			1.5171506697722070e-03,
			1.5739185771757960e-03,
			1.0934105568724753e-04,
			-2.3595205802747037e-03,
			-4.9094640542168043e-03,
			-6.5554528725943768e-03,
			-6.6301354576458627e-03,
			-5.0529859385244199e-03,
			-2.3813315013590133e-03,
			3.8378830793072761e-04,
			2.1701820787438171e-03,
			2.2475435961791133e-03,
			5.2264108394106874e-04,
			-2.4016516651440794e-03,
			-5.4347333993579024e-03,
			-7.4031298550908909e-03,
			-7.5024310674076684e-03,
			-5.6232596460668435e-03,
			-2.4204527331944921e-03,
			9.1109711825906252e-04,
			3.0785916091995206e-03,
			3.1890061978152619e-03,
			1.1120103401314168e-03,
			-2.4377084446544697e-03,
			-6.1421069422679300e-03,
			-8.5655120310646603e-03,
			-8.7069153507486879e-03,
			-6.4080990442552267e-03,
			-2.4533946628850409e-03,
			1.6913290218007067e-03,
			4.4159789078763853e-03,
			4.5849240000040660e-03,
			2.0016850719057019e-03,
			-2.4674894183636053e-03,
			-7.1757785818335109e-03,
			-1.0295069796047940e-02,
			-1.0517094892843148e-02,
			-7.5908659847105757e-03,
			-2.4799729477612124e-03,
			2.9419671409668794e-03,
			6.5662014054096345e-03,
			6.8550210725604327e-03,
			3.4759901858870648e-03,
			-2.4908277291187360e-03,
			-8.8792274472015934e-03,
			-1.3205408387919568e-02,
			-1.3612145515522693e-02,
			-9.6374419824967715e-03,
			-2.5000385130543338e-03,
			5.2427391705637408e-03,
			1.0580536218548087e-02,
			1.1181998975602013e-02,
			6.3605879655348856e-03,
			-2.5075923499343865e-03,
			-1.2319566910989012e-02,
			-1.9274332009471328e-02,
			-2.0269963047014568e-02,
			-1.4178998457914458e-02,
			-2.5134786129600876e-03,
			1.0829478829840471e-02,
			2.0744823812866658e-02,
			2.2690766900296741e-02,
			1.4483270404591924e-02,
			-2.5176890171172894e-03,
			-2.3307543588427120e-02,
			-4.0369876250908363e-02,
			-4.5786349362181115e-02,
			-3.3722455093228638e-02,
			-2.5202176339574195e-03,
			4.4295920087613627e-02,
			9.8489494995844001e-02,
			1.4900459020788048e-01,
			1.8478232998240263e-01,
			1.9770128981933233e-01,
			1.8478232998240260e-01,
			1.4900459020788046e-01,
			9.8489494995844001e-02,
			4.4295920087613627e-02,
			-2.5202176339574195e-03,
			-3.3722455093228625e-02,
			-4.5786349362181095e-02,
			-4.0369876250908342e-02,
			-2.3307543588427113e-02,
			-2.5176890171172885e-03,
			1.4483270404591918e-02,
			2.2690766900296734e-02,
			2.0744823812866662e-02,
			1.0829478829840469e-02,
			-2.5134786129600876e-03,
			-1.4178998457914451e-02,
			-2.0269963047014568e-02,
			-1.9274332009471325e-02,
			-1.2319566910989005e-02,
			-2.5075923499343865e-03,
			6.3605879655348821e-03,
			1.1181998975602013e-02,
			1.0580536218548079e-02,
			5.2427391705637399e-03,
			-2.5000385130543338e-03,
			-9.6374419824967663e-03,
			-1.3612145515522686e-02,
			-1.3205408387919563e-02,
			-8.8792274472015882e-03,
			-2.4908277291187352e-03,
			3.4759901858870644e-03,
			6.8550210725604310e-03,
			6.5662014054096319e-03,
			2.9419671409668755e-03,
			-2.4799729477612115e-03,
			-7.5908659847105696e-03,
			-1.0517094892843141e-02,
			-1.0295069796047933e-02,
			-7.1757785818335040e-03,
			-2.4674894183636031e-03,
			2.0016850719057015e-03,
			4.5849240000040642e-03,
			4.4159789078763818e-03,
			1.6913290218007046e-03,
			-2.4533946628850396e-03,
			-6.4080990442552214e-03,
			-8.7069153507486809e-03,
			-8.5655120310646551e-03,
			-6.1421069422679248e-03,
			-2.4377084446544671e-03,
			1.1120103401314168e-03,
			3.1890061978152580e-03,
			3.0785916091995184e-03,
			9.1109711825906165e-04,
			-2.4204527331944891e-03,
			-5.6232596460668383e-03,
			-7.5024310674076614e-03,
			-7.4031298550908866e-03,
			-5.4347333993578972e-03,
			-2.4016516651440773e-03,
			5.2264108394106830e-04,
			2.2475435961791116e-03,
			2.1701820787438150e-03,
			3.8378830793072674e-04,
			-2.3813315013590112e-03,
			-5.0529859385244147e-03,
			-6.6301354576458566e-03,
			-6.5554528725943716e-03,
			-4.9094640542168009e-03,
			-2.3595205802747024e-03,
			1.0934105568724710e-04,
			1.5739185771757938e-03,
			1.5171506697722048e-03,
			9.3802804821468602e-06,
			-2.3362492676286262e-03,
			-4.6105880180561743e-03,
			-5.9587888540155922e-03,
			-5.8996676940083021e-03,
			-4.4952796234403744e-03,
			-2.3115499026355019e-03,
			-1.9087867574249425e-04,
			1.0724602442609436e-03,
			1.0294729044537760e-03,
			-2.6462573339489087e-04,
			-2.2854567407306113e-03,
			-4.2498600364330209e-03,
			-5.4176714591411528e-03,
			-5.3689643971868732e-03,
			-4.1532418382006246e-03,
			-2.2580058929888586e-03,
			-4.1342994962956963e-04,
			6.8899845321778407e-04,
			6.5574848042658583e-04,
			-4.6850040009377241e-04,
			-2.2292352623449032e-03,
			-3.9440083590270812e-03,
			-4.9653999943319030e-03,
			-4.9239755060900741e-03,
			-3.8603036745255351e-03,
			-2.1991844767382022e-03,
			-5.7981456484613796e-04,
			3.9050467387357517e-04,
			3.6443629466090683e-04,
			-6.2098712652796501e-04,
			-2.1678948193175709e-03,
			-3.6765058047901456e-03,
			-4.5762288752536334e-03,
			-4.5400807420373085e-03,
			-3.6020300117276813e-03,
			-2.1354091558438014e-03,
			-7.0390263923219957e-04,
			1.5564054990569807e-04,
			1.3505419228893899e-04,
			-7.3436977631419751e-04,
			-2.1017718594332699e-03,
			-3.4366750935388522e-03,
			-4.2333749940477823e-03,
			-4.2011655582456257e-03,
			-3.3689871961330650e-03,
			-2.0670287327938914e-03,
			-7.9509661592604771e-04,
			-3.0044243277024291e-05,
			-4.6327428002479885e-05,
			-8.1708714496734583e-04,
			-2.0312269281050439e-03,
			-3.2173740827695441e-03,
			-3.9254947566759709e-03,
			-3.8963039747458711e-03,
			-3.1548105565966465e-03,
			-1.9944148647006786e-03,
			-8.6004498315006279e-04,
			-1.7673028326501813e-04,
			-1.8955798216129075e-04,
			-8.7517565170663219e-04,
			-1.9566421447212508e-03,
			-3.0137009285067066e-03,
			-3.6447026801626685e-03,
			-3.6178823206346007e-03,
			-2.9551048031628553e-03,
			-1.9179594668939711e-03,
			-9.0362563368652352e-04,
			-2.9183929853825299e-04,
			-3.0184064258026764e-04,
			-9.1310979552756239e-04,
			-1.8784185386198804e-03,
			-2.8222301198658193e-03,
			-3.3853974358017819e-03,
			-3.3604823371651922e-03,
			-2.7667859804345828e-03,
			-1.8380719865324099e-03,
			-9.2953738330699490e-04,
			-3.8094759717398374e-04,
			-3.8860288893697388e-04,
			-9.3431406514795431e-04,
			-1.7969732657099958e-03,
			-2.6405411438780728e-03,
			-3.1435353072794994e-03,
			-3.1201871940615741e-03,
			-2.5876705537394452e-03,
			-1.7551765677150553e-03,
			-9.4066996984811110e-04,
			-4.4836014331613475e-04,
			-4.5404556772049110e-04,
			-9.4148649600962774e-04,
			-1.7127367276437867e-03,
			-2.4669163646660179e-03,
			-2.9161635142357987e-03,
			-2.8941341961452277e-03,
			-2.4162092515083197e-03,
			-1.6697091303642328e-03,
			-9.3934318248717385e-04,
			-4.9748335425438695e-04,
			-5.0150050926443194e-04,
			-9.3680962132195768e-04,
			-1.6261496161299150e-03,
			-2.3001408101500673e-03,
			-2.7011106309814590e-03,
			-2.6802171696830818e-03,
			-2.2513090529741897e-03,
			-1.5821143857468237e-03,
			-9.2746571488590821e-04,
			-5.3107400963987568e-04,
			-5.3366990917167953e-04,
			-9.2209164076667159e-04,
			-1.5376599054839951e-03,
			-2.1393655190524372e-03,
			-2.4967753064543932e-03,
			-2.4768828093800709e-03,
			-2.0922106828287022e-03,
			-1.4928428119057708e-03,
			-9.0664315463841562e-04,
			-5.5140942759723431e-04,
			-5.5279034585916655e-04,
			-8.9886298096859948e-04,
			-1.4477198168144230e-03,
			-1.9840117627317956e-03,
			-2.3019783770460820e-03,
			-2.2829877894727083e-03,
			-1.9384021050804160e-03,
			-1.4023476124818790e-03,
			-8.7825282440996937e-04,
			-5.6040618872850619e-04,
			-5.6074741995525775e-04,
			-8.6844355888743199e-04,
			-1.3567827773557594e-03,
			-1.8337022754955738e-03,
			-2.1158569642515451e-03,
			-2.0976962193825972e-03,
			-1.7895559844669151e-03,
			-1.3110816824173728e-03,
			-8.4349648232051415e-04,
			-5.5970440314384985e-04,
			-5.5915725018882974e-04,
			-8.3199034423475486e-04,
			-1.2653003983722681e-03,
			-1.6882107712827470e-03,
			-1.9377870499384670e-03,
			-1.9204045261978851e-03,
			-1.6454834872589841e-03,
			-1.2194946038478743e-03,
			-8.0343791285577421e-04,
			-5.5072839963610850e-04,
			-5.4942524462625489e-04,
			-7.9053139803598581e-04,
			-1.1737194947732356e-03,
			-1.5474241199680302e-03,
			-1.7673257900250637e-03,
			-1.7506853864653555e-03,
			-1.5060994658299286e-03,
			-1.1280296951106143e-03,
			-7.5903001230421489e-04,
			-5.3473097251143431e-04,
			-5.3278899658178321e-04,
			-7.4499046023498083e-04,
			-1.0824791691068523e-03,
			-1.4113134710927306e-03,
			-1.6041677843163992e-03,
			-1.5882451526843810e-03,
			-1.3713957371192988e-03,
			-1.0371211352280089e-03,
			-7.1113445160838143e-04,
			-5.1282596998289919e-04,
			-5.1034990678758545e-04,
			-6.9620483086476226e-04,
			-9.9200798193757015e-04,
			-1.2799118265123326e-03,
			-1.4481113993055144e-03,
			-1.4328910178956461e-03,
			-1.2414202283586287e-03,
			-9.4719118547235655e-04,
			-6.6053602348670898e-04,
			-4.8601249597531027e-04,
			-4.8309668494353285e-04,
			-6.4493843126177776e-04,
			-9.0272122976937474e-04,
			-1.1532963499778280e-03,
			-1.2990324612614465e-03,
			-1.2845053320326336e-03,
			-1.1162604567117403e-03,
			-8.5864752868663444e-04,
			-6.0795314082136916e-04,
			-4.5519300417451051e-04,
			-4.5192293060263228e-04,
			-5.9189136586437817e-04,
			-8.1501835066161014e-04,
			-1.0315742215661421e-03,
			-1.1568634454878547e-03,
			-1.1430252604327058e-03,
			-9.9603027029705814e-04,
			-7.7188074593989315e-04,




			};
		for(j=0;j<firLength;j++)
			{
			sum_fir+=Fir[j];
			}
		for(j=0;j<3;j++)
			{

			datamid=0.0;
			now_fir=i_fir_list;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+now_fir->data[j]*Fir[i];
				now_fir=now_fir->last;
				}

			i_fir_list->band_pass_data[j]=datamid-mean[j]*sum_fir;
			}
		//		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]),0.5);
		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]+i_fir_list->band_pass_data[2]*i_fir_list->band_pass_data[2]),0.5);


		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataV[j]=now_fir->last->dataV[j]+(now_fir->last->data[j]+now_fir->data[j]-2*mean[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataV[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataV[j]=datamid;
			}
		//		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]+i_fir_list->band_pass_dataV[2]*i_fir_list->band_pass_dataV[2]),0.5);
		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataD[j]=now_fir->last->dataD[j]+(now_fir->last->dataV[j]+now_fir->dataV[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataD[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataD[j]=datamid;
			}
		//		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]+i_fir_list->band_pass_dataD[2]*i_fir_list->band_pass_dataD[2]),0.5);
		return 1;
		}

	return 0;

	};






int PGA_V_G_22_22(FIR_LIST *i_fir_list,BAND_PASS_RESULT *band_pass_data,int *count,int timespan,int *trig,int PGV_type,int band_pass_flag)
	{
	//返回    1 普通返回
	//返回    2 触发过程中取PGV PGD 等量标识




	// *trig  0 未触发时间间隔开始
	//        3 未触发期间
	//        1 触发起始点
	//        2 触发过程中

	int firLength,j,jjj,iii;
	double datamid;
	FIR_LIST *now_fir;
	int i_sample_rata=i_fir_list->sample_rata;


	if(*trig==1||*trig==2)
		{


		if(*trig==1)
			{
			for(jjj=0;jjj<3;jjj++)
				{
				band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
				band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
				band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);
				}
			band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
			band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
			band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
			now_fir=i_fir_list->last;
			for(iii=1;iii<i_sample_rata*3;iii++)
				{
				for(jjj=0;jjj<3;jjj++)
					{
					if(abs(now_fir->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
						band_pass_data->final_PGA_component[jjj]=abs(now_fir->band_pass_data[jjj]);
					if(abs(now_fir->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
						band_pass_data->final_PGV_component[jjj]=abs(now_fir->band_pass_dataV[jjj]);
					if(abs(now_fir->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
						band_pass_data->final_PGD_component[jjj]=abs(now_fir->band_pass_dataD[jjj]);
					}

				if(now_fir->band_pass_data[4]>band_pass_data->final_PGA)
					{
					band_pass_data->final_PGA=now_fir->band_pass_data[4];
					band_pass_data->utc_second_final_PGA=now_fir->utc_second; //utc时间秒
					band_pass_data->utc_nanosecond_final_PGA=now_fir->utc_nanosecond; //utc时间纳秒

					}
				//else
				//	{
				//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
				//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utc时间秒
				//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utc时间纳秒
				//	}
				if(now_fir->band_pass_dataV[4]>band_pass_data->final_PGV)
					{
					band_pass_data->final_PGV=now_fir->band_pass_dataV[4];
					band_pass_data->utc_second_final_PGV=now_fir->utc_second; //utc时间秒
					band_pass_data->utc_nanosecond_final_PGV=now_fir->utc_nanosecond; //utc时间纳秒
					}
				//else
				//	{
				//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
				//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utc时间秒
				//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utc时间纳秒
				//	}
				if(now_fir->band_pass_dataD[4]>band_pass_data->final_PGD)
					{
					band_pass_data->final_PGD=now_fir->band_pass_dataD[4];
					band_pass_data->utc_second_final_PGD=now_fir->utc_second; //utc时间秒
					band_pass_data->utc_nanosecond_final_PGD=now_fir->utc_nanosecond; //utc时间纳秒
					}

				now_fir=now_fir=now_fir->last;

				}

			*count=2;
			*trig=2;
			}
		else
			{

			for(jjj=0;jjj<3;jjj++)
				{
				if(abs(i_fir_list->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
					band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
				if(abs(i_fir_list->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
					band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
				if(abs(i_fir_list->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
					band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);

				}

			if(i_fir_list->band_pass_data[4]>band_pass_data->final_PGA)
				{
				band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
				band_pass_data->utc_second_final_PGA=i_fir_list->utc_second; //utc时间秒
				band_pass_data->utc_nanosecond_final_PGA=i_fir_list->utc_nanosecond; //utc时间纳秒

				}
			//else
			//	{
			//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
			//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utc时间秒
			//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utc时间纳秒
			//	}
			if(i_fir_list->band_pass_dataV[4]>band_pass_data->final_PGV)
				{
				band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
				band_pass_data->utc_second_final_PGV=i_fir_list->utc_second; //utc时间秒
				band_pass_data->utc_nanosecond_final_PGV=i_fir_list->utc_nanosecond; //utc时间纳秒
				}
			//else
			//	{
			//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
			//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utc时间秒
			//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utc时间纳秒
			//	}
			if(i_fir_list->band_pass_dataD[4]>band_pass_data->final_PGD)
				{
				band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
				band_pass_data->utc_second_final_PGD=i_fir_list->utc_second; //utc时间秒
				band_pass_data->utc_nanosecond_final_PGD=i_fir_list->utc_nanosecond; //utc时间纳秒
				}
			//else
			//	{
			//	band_pass_data->final_PGD=i_fir_list->last->final_PGD;
			//	band_pass_data->utc_second_final_PGD=i_fir_list->last->utc_second; //utc时间秒
			//	band_pass_data->utc_nanosecond_final_PGD=i_fir_list->last->utc_nanosecond; //utc时间纳秒
			//	}
			if(*count==timespan*i_sample_rata)

				{
				*count=2;
				return 2;
				}
			else
				{


				*count+=1;
				}

			}
		}
		else
			{
			if(*trig==0)
				{
					

			for(jjj=0;jjj<3;jjj++)
				{
				band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
				band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
				band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);
				}
			band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
			band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
			band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
			//now_fir=i_fir_list->last;
			//for(iii=1;iii<i_sample_rata*3;iii++)
			//	{
			//	for(jjj=0;jjj<3;jjj++)
			//		{
			//		if(abs(now_fir->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
			//			band_pass_data->final_PGA_component[jjj]=abs(now_fir->band_pass_data[jjj]);
			//		if(abs(now_fir->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
			//			band_pass_data->final_PGV_component[jjj]=abs(now_fir->band_pass_dataV[jjj]);
			//		if(abs(now_fir->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
			//			band_pass_data->final_PGD_component[jjj]=abs(now_fir->band_pass_dataD[jjj]);
			//		}

			//	if(now_fir->band_pass_data[4]>band_pass_data->final_PGA)
			//		{
			//		band_pass_data->final_PGA=now_fir->band_pass_data[4];
			//		band_pass_data->utc_second_final_PGA=now_fir->utc_second; //utc时间秒
			//		band_pass_data->utc_nanosecond_final_PGA=now_fir->utc_nanosecond; //utc时间纳秒

			//		}
			//	//else
			//	//	{
			//	//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
			//	//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utc时间秒
			//	//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utc时间纳秒
			//	//	}
			//	if(now_fir->band_pass_dataV[4]>band_pass_data->final_PGV)
			//		{
			//		band_pass_data->final_PGV=now_fir->band_pass_dataV[4];
			//		band_pass_data->utc_second_final_PGV=now_fir->utc_second; //utc时间秒
			//		band_pass_data->utc_nanosecond_final_PGV=now_fir->utc_nanosecond; //utc时间纳秒
			//		}
			//	//else
			//	//	{
			//	//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
			//	//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utc时间秒
			//	//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utc时间纳秒
			//	//	}
			//	if(now_fir->band_pass_dataD[4]>band_pass_data->final_PGD)
			//		{
			//		band_pass_data->final_PGD=now_fir->band_pass_dataD[4];
			//		band_pass_data->utc_second_final_PGD=now_fir->utc_second; //utc时间秒
			//		band_pass_data->utc_nanosecond_final_PGD=now_fir->utc_nanosecond; //utc时间纳秒
			//		}

			//	now_fir=now_fir=now_fir->last;



			//	}

			*count=2;
			/**count+=1;*/
			*trig=3;

				}
			else if(*trig==3)
				{
				for(jjj=0;jjj<3;jjj++)
					{
					if(abs(i_fir_list->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
						band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
					if(abs(i_fir_list->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
						band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
					if(abs(i_fir_list->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
						band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);

					}

				if(i_fir_list->band_pass_data[4]>band_pass_data->final_PGA)
					{
					band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
					band_pass_data->utc_second_final_PGA=i_fir_list->utc_second; //utc时间秒
					band_pass_data->utc_nanosecond_final_PGA=i_fir_list->utc_nanosecond; //utc时间纳秒

					}
				//else
				//	{
				//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
				//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utc时间秒
				//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utc时间纳秒
				//	}
				if(i_fir_list->band_pass_dataV[4]>band_pass_data->final_PGV)
					{
					band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
					band_pass_data->utc_second_final_PGV=i_fir_list->utc_second; //utc时间秒
					band_pass_data->utc_nanosecond_final_PGV=i_fir_list->utc_nanosecond; //utc时间纳秒
					}
				//else
				//	{
				//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
				//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utc时间秒
				//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utc时间纳秒
				//	}
				if(i_fir_list->band_pass_dataD[4]>band_pass_data->final_PGD)
					{
					band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
					band_pass_data->utc_second_final_PGD=i_fir_list->utc_second; //utc时间秒
					band_pass_data->utc_nanosecond_final_PGD=i_fir_list->utc_nanosecond; //utc时间纳秒
					}
				//else
				//	{
				//	band_pass_data->final_PGD=i_fir_list->last->final_PGD;
				//	band_pass_data->utc_second_final_PGD=i_fir_list->last->utc_second; //utc时间秒
				//	band_pass_data->utc_nanosecond_final_PGD=i_fir_list->last->utc_nanosecond; //utc时间纳秒
				//	}
				if(*count==timespan*i_sample_rata)
					{
					*count=1;
					*trig=0;
					return 3;

					}
				else
					{

					*count+=1;
					}

				}

			}
	return 1;
		




	}




int first_direction_22(FIR_LIST *i_fir_list,float threshold,int fir_length)
	{

	//**i_fir_list 触发时的数据结构体指针
	//**threshold  判定阈值 现在都给2
	//**fir_length 所使用的带通滤波器长度
	FIR_LIST *now_list=i_fir_list;
	FIR_LIST *first_fir;
	int i,j,k;
	int i_fir=(fir_length-1)/2;
	int sample_rata=i_fir_list->sample_rata;
	int numm=0.1*sample_rata;
	float mean,STD;
	float max,mda,chudong;

	//int before_num=(int)(i_fir_list->sample_rata*before_interval);
	//int after_num=(int)(i_fir_list->sample_rata*after_interval);
	for(i=0;i<i_fir;i++)
		{
		now_list=now_list->last;
		}
	first_fir=now_list;
	mean=0.0;
	STD=0.0;
	
	for(i=0;i<sample_rata*3;i++)
		{
		mean+=now_list->dataV[2];
		now_list=now_list->last;
		}

	mean=mean/(sample_rata*3);
	now_list=first_fir;
	for(i=0;i<sample_rata*3;i++)
		{
		STD+=(now_list->dataV[2]-mean)*(now_list->dataV[2]-mean);
		now_list=now_list->last;
		}
	STD=pow((float)(STD/(sample_rata*3)),(float)(0.5));
	now_list=first_fir;
	chudong=first_fir->dataV[2];
	for(i=0;i<numm/2;i++)
		{

		now_list=now_list->last;

		}

	max=abs(chudong-mean);
	//mda=now_list->dataV[2];

	for(i=0;i<numm;i++)
		{
		if((chudong-mean)*(now_list->dataV[2]-mean)>0&&abs(now_list->dataV[2]-mean)>max)
			{
			max=abs(now_list->dataV[2]-mean);
			}
		}

	//for(i=0;i<20;i++)
	//	{
	//	//if




	//	}



	if((max)>threshold*STD&&chudong-mean>0)
		{
		return 1;
		}
	else if((max)>threshold*STD&&chudong-mean<0)
		{
		return -1;
		}
	else
		{
		return 0;
		}


	}








int psa_struct_11(FIR_LIST *i_list,float sample_rata,float zuni,float *period,float *result,double *dx,double *x2,double *y0,double *y1,int *first,float * mean)
	{
	//double *dx,double *x2,double *y0,double *y1,int *first 这些变量都新弄一份
	//这个是计算 PSV的

	int j,i,k,kkk;
	double dp,z,w,xt,c1,c2,c3,dx0,sa2,y2;
	double dlt=1.0/sample_rata;
	for(kkk=0;kkk<3;kkk++)
		{

		
		for(j=0;j<3;j++)
			{
			//result[j]=0.0;//*在外面设置为零
			dp=period[j]/10.0;//
			//l=1;//
			//if(dp<dt)
			//	l=int(dt/dp+1.0-0.00001);
			//dlt=dt/l;//
			w=3.1415926535897932384*2/period[j];//
			z=exp(-1*zuni*w*dlt);//

			xt=w*pow(1.0-zuni*zuni,0.5)*dlt;//
			c1=2.0*z*cos(xt);//
			c2=-1*z*z;//
			c3=-1*z*sin(xt)/xt;//
			if(*first==1)
				{

				dx[kkk*3+j]=i_list->dataV[kkk];//*
				x2[kkk*3+j]=i_list->dataV[kkk];//*
				y0[kkk*3+j]=0.0;//*
				y1[kkk*3+j]=c3*i_list->dataV[kkk];//*


				}
			else
				{

				//for (i=0;i<i_list->data_num-1;i++)
				//	{

					dx0=dx[kkk*3+j];
					dx[kkk*3+j]=(i_list->dataV[kkk]-i_list->last->dataV[kkk]);
					//for(k=0;k<l;k++)
					//	{
					x2[kkk*3+j]=x2[kkk*3+j]+dx[kkk*3+j];
					y2=c1*y1[kkk*3+j]+c2*y0[kkk*3+j];
					//if(k==0)
					y2+=c3*(dx[kkk*3+j]-dx0);
					sa2=abs(x2[kkk*3+j]+y2);

					if(sa2>result[kkk*3+j])
						result[kkk*3+j]=sa2;
					y0[kkk*3+j]=y1[kkk*3+j];
					y1[kkk*3+j]=y2;

						//}
					//}
				}
			
			}
		}

	if(*first==1)
	*first=2;
	return 1;

	}




int coordinate_conversion(int a,float b,float c,FIR_LIST *fir_list)
	{
	float a0=fir_list->data[0];
	float a1=fir_list->data[1];
	float a2=fir_list->data[2];
	double Pi=3.14159265358979323;
	//这里默认正东为x，正北为y，向上为z
	//也就是说 data【0】 东西  data【1】 南北 data【2】 上下
	//这个可以是list1做，也可以是list做s
	//printf("cos(Pi=%f    )\n",cos(Pi));
	if(a==-1)
		{

		fir_list->data[2]=-1*a0;
		fir_list->data[0]=cos(Pi*(90+b)/180.0)*a1+cos(Pi*(90+c)/180.0)*a2;
		fir_list->data[1]=cos(Pi*b/180.0)*a1+cos(Pi*c/180.0)*a2;

		}
	else if(a==1)
		{
		fir_list->data[2]=a0;
		fir_list->data[0]=cos(Pi*(90+b)/180.0)*a1+cos(Pi*(90+c)/180.0)*a2;
		fir_list->data[1]=cos(Pi*b/180.0)*a1+cos(Pi*c/180.0)*a2;


		}
	else if(a==-2)
		{
		fir_list->data[2]=-1*a1;
		fir_list->data[0]=cos(Pi*(90+b)/180.0)*a2+cos(Pi*(90+c)/180.0)*a0;
		fir_list->data[1]=cos(Pi*b/180.0)*a2+cos(Pi*c/180.0)*a0;


		}
	else if(a==2)
		{
		fir_list->data[2]=a1;
		fir_list->data[0]=cos(Pi*(90+b)/180.0)*a2+cos(Pi*(90+c)/180.0)*a0;
		fir_list->data[1]=cos(Pi*b/180.0)*a2+cos(Pi*c/180.0)*a0;


		}
	else if(a==-3)
		{
		fir_list->data[2]=-1*a2;
		fir_list->data[0]=cos(Pi*(90+b)/180.0)*a0+cos(Pi*(90+c)/180.0)*a1;
		fir_list->data[1]=cos(Pi*b/180.0)*a0+cos(Pi*c/180.0)*a1;


		}
	else if(a==3)
		{
		fir_list->data[2]=a2;
		fir_list->data[0]=cos(Pi*(90+b)/180.0)*a0+cos(Pi*(90+c)/180.0)*a1;
		fir_list->data[1]=cos(Pi*b/180.0)*a0+cos(Pi*c/180.0)*a1;


		}
	return 1;

	}
int band_passstruct11_11(FIR_LIST *i_fir_list,int band_pass_flag,int num,float *mean)     //   这里需要再加一个参数标记事件后的数据点数，用以去除直流偏置从事件的前十秒开始？或者是3秒   第一次触发要调用一次用来计算3秒的值
	{
	//计算当前点的dataD dataV 以及 band_pass_data band_pass_dataV band_pass_dataD
	int firLength,j,jjj,i;
	double datamid;
	double sum_fir=0;
	int sample_rata=i_fir_list->sample_rata;
	FIR_LIST *now_fir;
	if (i_fir_list->sample_rata==50&&band_pass_flag==0)
		{

		firLength=81;
		double Fir[81]={-4.7987787339820936e-04,
			-8.9057350076593368e-04,
			-7.2903341056485352e-04,
			-9.3968046651590189e-04,
			-2.0015152670250906e-03,
			-1.8457782153191327e-03,
			-1.4331943313841396e-03,
			-3.2987790655067970e-03,
			-3.9188767708761094e-03,
			-2.2358326021832526e-03,
			-4.2761095213556272e-03,
			-6.9685597648698229e-03,
			-4.0562398557881119e-03,
			-4.5086713435378723e-03,
			-1.0324010165847381e-02,
			-7.7980789590883538e-03,
			-4.2123548102063557e-03,
			-1.2580685653923828e-02,
			-1.3896183105007932e-02,
			-4.6707793854684938e-03,
			-1.2139776287417038e-02,
			-2.1492365469531257e-02,
			-8.0968892823001046e-03,
			-8.2631555848332473e-03,
			-2.7966602054323594e-02,
			-1.6735759731169867e-02,
			-2.1834926757662077e-03,
			-2.9254096192636532e-02,
			-3.1499163705017090e-02,
			2.3107659525776346e-03,
			-2.0832464828927390e-02,
			-5.0853889965031082e-02,
			-1.1624388651572256e-03,
			1.8841462457617236e-03,
			-7.0730297852423088e-02,
			-2.3669862992490260e-02,
			4.9655253129437991e-02,
			-8.5754335252881606e-02,
			-1.1745446174509039e-01,
			2.7761355362248835e-01,
			5.7538029520670841e-01,
			2.7761355362248769e-01,
			-1.1745446174508975e-01,
			-8.5754335252880912e-02,
			4.9655253129437457e-02,
			-2.3669862992489934e-02,
			-7.0730297852421936e-02,
			1.8841462457616889e-03,
			-1.1624388651572048e-03,
			-5.0853889965029819e-02,
			-2.0832464828926815e-02,
			2.3107659525775617e-03,
			-3.1499163705016028e-02,
			-2.9254096192635470e-02,
			-2.1834926757661245e-03,
			-1.6735759731169159e-02,
			-2.7966602054322321e-02,
			-8.2631555848328413e-03,
			-8.0968892822996814e-03,
			-2.1492365469530057e-02,
			-1.2139776287416327e-02,
			-4.6707793854682024e-03,
			-1.3896183105007011e-02,
			-1.2580685653922945e-02,
			-4.2123548102060435e-03,
			-7.7980789590877501e-03,
			-1.0324010165846531e-02,
			-4.5086713435374846e-03,
			-4.0562398557877433e-03,
			-6.9685597648691568e-03,
			-4.2761095213552005e-03,
			-2.2358326021830158e-03,
			-3.9188767708756775e-03,
			-3.2987790655064630e-03,
			-1.4331943313839600e-03,
			-1.8457782153188935e-03,
			-2.0015152670248100e-03,
			-9.3968046651576485e-04,
			-7.2903341056474108e-04,
			-8.9057350076577387e-04,
			-4.7987787339812745e-04,
			};

		for(j=0;j<firLength;j++)
			{
			sum_fir+=Fir[j];
			}

		for(j=0;j<3;j++)
			{

			datamid=0.0;
			now_fir=i_fir_list;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+now_fir->data[j]*Fir[i];
				now_fir=now_fir->last;
				}

			i_fir_list->band_pass_data[j]=datamid-mean[j]*sum_fir;
			}
		//i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]),0.5);
		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]+i_fir_list->band_pass_data[2]*i_fir_list->band_pass_data[2]),0.5);


		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataV[j]=now_fir->last->dataV[j]+(now_fir->last->data[j]+now_fir->data[j]-2*mean[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataV[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataV[j]=datamid;
			}
//		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]+i_fir_list->band_pass_dataV[2]*i_fir_list->band_pass_dataV[2]),0.5);
		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataD[j]=now_fir->last->dataD[j]+(now_fir->last->dataV[j]+now_fir->dataV[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataD[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataD[j]=datamid;
			}
		//i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]+i_fir_list->band_pass_dataD[2]*i_fir_list->band_pass_dataD[2]),0.5);
		return 1;
		}
	else if (i_fir_list->sample_rata==50&&band_pass_flag==1)
		{




		firLength=151;
		double Fir[151]={-2.8052426906829513e-03,
			-4.2393366582970269e-03,
			-3.8887138369385330e-03,
			-2.2354116003412555e-03,
			-1.7151340451976370e-03,
			-3.3681835107814504e-03,
			-5.1779067586189562e-03,
			-4.6965135173902524e-03,
			-2.5638580821051682e-03,
			-1.8818136148366425e-03,
			-3.9473893023176630e-03,
			-6.1968403681345145e-03,
			-5.5591924712764754e-03,
			-2.8602285633303683e-03,
			-1.9855715179514558e-03,
			-4.5343773820232715e-03,
			-7.2993746523036347e-03,
			-6.4757972766725895e-03,
			-3.1075377181290190e-03,
			-2.0034515060087738e-03,
			-5.1201983246674521e-03,
			-8.4924282172401180e-03,
			-7.4477448916228876e-03,
			-3.2854307785719003e-03,
			-1.9068638995382889e-03,
			-5.6956197214221181e-03,
			-9.7890130188554095e-03,
			-8.4805326328304762e-03,
			-3.3686880184671422e-03,
			-1.6587501518070553e-03,
			-6.2513201008398845e-03,
			-1.1212180130190147e-02,
			-9.5865220664507079e-03,
			-3.3245287368907092e-03,
			-1.2085331900947341e-03,
			-6.7780883098406538e-03,
			-1.2801858768458711e-02,
			-1.0789770869833983e-02,
			-3.1075700373275851e-03,
			-4.8269424897207818e-04,
			-7.2670234585519751e-03,
			-1.4627552535563389e-02,
			-1.2135072981765502e-02,
			-2.6498708200075548e-03,
			6.3396297658225372e-04,
			-7.7097304696529074e-03,
			-1.6813951744110978e-02,
			-1.3706460562373948e-02,
			-1.8396919533613628e-03,
			2.3388911427624061e-03,
			-8.0985063426770101e-03,
			-1.9598293978969096e-02,
			-1.5669566680424962e-02,
			-4.7103250693004398e-04,
			5.0106092712312988e-03,
			-8.4265124453908481e-03,
			-2.3477962536707364e-02,
			-1.8384256507005932e-02,
			1.8961989182070325e-03,
			9.4930912865623281e-03,
			-8.6879284730553841e-03,
			-2.9673940083844816e-02,
			-2.2776743005803374e-02,
			6.4259738795488016e-03,
			1.8156146307088068e-02,
			-8.8780841635862553e-03,
			-4.2138499851260856e-02,
			-3.2106505797306333e-02,
			1.7595589150292312e-02,
			4.1258267838167328e-02,
			-8.9935654105577235e-03,
			-8.4619383336774115e-02,
			-7.1400968296348372e-02,
			8.4628282316732584e-02,
			2.9419739638965176e-01,
			3.9169381130492797e-01,
			2.9419739638965176e-01,
			8.4628282316732584e-02,
			-7.1400968296348372e-02,
			-8.4619383336774115e-02,
			-8.9935654105577252e-03,
			4.1258267838167349e-02,
			1.7595589150292319e-02,
			-3.2106505797306346e-02,
			-4.2138499851260863e-02,
			-8.8780841635862588e-03,
			1.8156146307088072e-02,
			6.4259738795488016e-03,
			-2.2776743005803384e-02,
			-2.9673940083844830e-02,
			-8.6879284730553893e-03,
			9.4930912865623333e-03,
			1.8961989182070343e-03,
			-1.8384256507005946e-02,
			-2.3477962536707378e-02,
			-8.4265124453908533e-03,
			5.0106092712313005e-03,
			-4.7103250693004398e-04,
			-1.5669566680424969e-02,
			-1.9598293978969110e-02,
			-8.0985063426770188e-03,
			2.3388911427624079e-03,
			-1.8396919533613663e-03,
			-1.3706460562373958e-02,
			-1.6813951744110992e-02,
			-7.7097304696529126e-03,
			6.3396297658225372e-04,
			-2.6498708200075574e-03,
			-1.2135072981765515e-02,
			-1.4627552535563406e-02,
			-7.2670234585519829e-03,
			-4.8269424897207731e-04,
			-3.1075700373275877e-03,
			-1.0789770869833994e-02,
			-1.2801858768458723e-02,
			-6.7780883098406616e-03,
			-1.2085331900947350e-03,
			-3.3245287368907140e-03,
			-9.5865220664507183e-03,
			-1.1212180130190158e-02,
			-6.2513201008398932e-03,
			-1.6587501518070587e-03,
			-3.3686880184671461e-03,
			-8.4805326328304884e-03,
			-9.7890130188554234e-03,
			-5.6956197214221250e-03,
			-1.9068638995382910e-03,
			-3.2854307785719064e-03,
			-7.4477448916228997e-03,
			-8.4924282172401319e-03,
			-5.1201983246674599e-03,
			-2.0034515060087777e-03,
			-3.1075377181290238e-03,
			-6.4757972766725999e-03,
			-7.2993746523036451e-03,
			-4.5343773820232776e-03,
			-1.9855715179514588e-03,
			-2.8602285633303726e-03,
			-5.5591924712764867e-03,
			-6.1968403681345232e-03,
			-3.9473893023176700e-03,
			-1.8818136148366458e-03,
			-2.5638580821051716e-03,
			-4.6965135173902611e-03,
			-5.1779067586189640e-03,
			-3.3681835107814543e-03,
			-1.7151340451976407e-03,
			-2.2354116003412351e-03,
			-3.8887138369385656e-03,
			-4.2393366582969870e-03,
			-2.8052426906829439e-03,

			};

		for(j=0;j<firLength;j++)
			{
			sum_fir+=Fir[j];
			}

		for(j=0;j<3;j++)
			{

			datamid=0.0;
			now_fir=i_fir_list;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+now_fir->data[j]*Fir[i];
				now_fir=now_fir->last;
				}

			i_fir_list->band_pass_data[j]=datamid-mean[j]*sum_fir;
			}
		//i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]),0.5);
				i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]+i_fir_list->band_pass_data[2]*i_fir_list->band_pass_data[2]),0.5);
		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataV[j]=now_fir->last->dataV[j]+(now_fir->last->data[j]+now_fir->data[j]-2*mean[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataV[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataV[j]=datamid;
			}
//		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]+i_fir_list->band_pass_dataV[2]*i_fir_list->band_pass_dataV[2]),0.5);
		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataD[j]=now_fir->last->dataD[j]+(now_fir->last->dataV[j]+now_fir->dataV[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataD[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataD[j]=datamid;
			}
//		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]+i_fir_list->band_pass_dataD[2]*i_fir_list->band_pass_dataD[2]),0.5);
		return 1;
		}
	else if(i_fir_list->sample_rata==100&&band_pass_flag==0)
		{

		firLength=191;
		double Fir[191]={-1.0096108503799409e-03,
			-1.3950482601184145e-03,
			-2.2527488512072823e-03,
			-2.9478325266950626e-03,
			-2.9241282941009309e-03,
			-2.1964877583498382e-03,
			-1.3932186866449717e-03,
			-1.2683702309322061e-03,
			-2.0587294816955936e-03,
			-3.2307108495224480e-03,
			-3.8728518839418980e-03,
			-3.4512139742405856e-03,
			-2.3045215990983815e-03,
			-1.4270997345429326e-03,
			-1.6661388536950924e-03,
			-2.9780040916341042e-03,
			-4.3915096269727697e-03,
			-4.7685469089617048e-03,
			-3.7708238360917514e-03,
			-2.2154696854772564e-03,
			-1.4639880273141859e-03,
			-2.2943598211664952e-03,
			-4.1868456476722750e-03,
			-5.6701595913976281e-03,
			-5.5118721440431517e-03,
			-3.7942060764075075e-03,
			-1.9423711063670419e-03,
			-1.6026343679009464e-03,
			-3.2475373165740244e-03,
			-5.6846723133800129e-03,
			-6.9564131921419870e-03,
			-5.9605784961465312e-03,
			-3.4555395583318526e-03,
			-1.5446848893690436e-03,
			-1.9729728155626920e-03,
			-4.6090756549750133e-03,
			-7.4249335517157806e-03,
			-8.0957173947760943e-03,
			-5.9658402480322953e-03,
			-2.7259882160986819e-03,
			-1.1326443571281007e-03,
			-2.7279163951726233e-03,
			-6.4379538633729206e-03,
			-9.3078652451388747e-03,
			-8.8937043531173623e-03,
			-5.3843686320969916e-03,
			-1.6236386602042371e-03,
			-8.6795329695463013e-04,
			-4.0358532878403434e-03,
			-8.7602540790057502e-03,
			-1.1177665546498936e-02,
			-9.1197841612625230e-03,
			-4.0841129832286773e-03,
			-2.1710181588843413e-04,
			-9.6506787169073674e-04,
			-6.0820299780298100e-03,
			-1.1571060989487639e-02,
			-1.2821283663388564e-02,
			-8.4992305065876590e-03,
			-1.9327687604891049e-03,
			1.3784923032710335e-03,
			-1.7050246429269466e-03,
			-9.0969663617697753e-03,
			-1.4856515017832844e-02,
			-1.3958829431456619e-02,
			-6.6666698386317613e-03,
			1.2562792472859616e-03,
			3.0131140370235859e-03,
			-3.4963797956000272e-03,
			-1.3462418900154581e-02,
			-1.8662168940531118e-02,
			-1.4193048970612182e-02,
			-2.9949266075571710e-03,
			5.9029683387124953e-03,
			4.5197236235567867e-03,
			-7.1079148261703534e-03,
			-2.0084767678293092e-02,
			-2.3311188040322776e-02,
			-1.2784038623879721e-02,
			4.0762178712041601e-03,
			1.3346915816899603e-02,
			5.7359043739684543e-03,
			-1.4720837908786619e-02,
			-3.2099574332974203e-02,
			-3.0404413640455791e-02,
			-7.3824560015768315e-03,
			2.0903522723558492e-02,
			3.0096061155356627e-02,
			6.5259347250955285e-03,
			-3.8462292200619481e-02,
			-7.0869487224785352e-02,
			-5.4107874682352952e-02,
			2.5259979404526650e-02,
			1.4370865641013861e-01,
			2.4982563870147181e-01,
			2.9230819959096299e-01,
			2.4982563870147181e-01,
			1.4370865641013864e-01,
			2.5259979404526654e-02,
			-5.4107874682352966e-02,
			-7.0869487224785366e-02,
			-3.8462292200619495e-02,
			6.5259347250955302e-03,
			3.0096061155356641e-02,
			2.0903522723558506e-02,
			-7.3824560015768349e-03,
			-3.0404413640455815e-02,
			-3.2099574332974223e-02,
			-1.4720837908786630e-02,
			5.7359043739684604e-03,
			1.3346915816899613e-02,
			4.0762178712041627e-03,
			-1.2784038623879739e-02,
			-2.3311188040322804e-02,
			-2.0084767678293116e-02,
			-7.1079148261703612e-03,
			4.5197236235567911e-03,
			5.9029683387125048e-03,
			-2.9949266075571736e-03,
			-1.4193048970612207e-02,
			-1.8662168940531153e-02,
			-1.3462418900154604e-02,
			-3.4963797956000320e-03,
			3.0131140370235911e-03,
			1.2562792472859642e-03,
			-6.6666698386317743e-03,
			-1.3958829431456649e-02,
			-1.4856515017832875e-02,
			-9.0969663617697927e-03,
			-1.7050246429269492e-03,
			1.3784923032710370e-03,
			-1.9327687604891093e-03,
			-8.4992305065876780e-03,
			-1.2821283663388595e-02,
			-1.1571060989487670e-02,
			-6.0820299780298256e-03,
			-9.6506787169073935e-04,
			-2.1710181588843587e-04,
			-4.0841129832286877e-03,
			-9.1197841612625508e-03,
			-1.1177665546498967e-02,
			-8.7602540790057779e-03,
			-4.0358532878403556e-03,
			-8.6795329695463187e-04,
			-1.6236386602042424e-03,
			-5.3843686320970089e-03,
			-8.8937043531173883e-03,
			-9.3078652451389042e-03,
			-6.4379538633729406e-03,
			-2.7279163951726333e-03,
			-1.1326443571281050e-03,
			-2.7259882160986914e-03,
			-5.9658402480323187e-03,
			-8.0957173947761238e-03,
			-7.4249335517158083e-03,
			-4.6090756549750297e-03,
			-1.9729728155626998e-03,
			-1.5446848893690497e-03,
			-3.4555395583318661e-03,
			-5.9605784961465555e-03,
			-6.9564131921420139e-03,
			-5.6846723133800337e-03,
			-3.2475373165740378e-03,
			-1.6026343679009538e-03,
			-1.9423711063670500e-03,
			-3.7942060764075232e-03,
			-5.5118721440431751e-03,
			-5.6701595913976532e-03,
			-4.1868456476722923e-03,
			-2.2943598211665065e-03,
			-1.4639880273141920e-03,
			-2.2154696854772668e-03,
			-3.7708238360917696e-03,
			-4.7685469089617273e-03,
			-4.3915096269727888e-03,
			-2.9780040916341185e-03,
			-1.6661388536951005e-03,
			-1.4270997345429397e-03,
			-2.3045215990983915e-03,
			-3.4512139742406017e-03,
			-3.8728518839419141e-03,
			-3.2307108495224631e-03,
			-2.0587294816956044e-03,
			-1.2683702309322122e-03,
			-1.3932186866449782e-03,
			-2.1964877583498486e-03,
			-2.9241282941009409e-03,
			-2.9478325266950032e-03,
			-2.2527488512072988e-03,
			-1.3950482601184288e-03,
			-1.0096108503799466e-03,



			};

		for(j=0;j<firLength;j++)
			{
			sum_fir+=Fir[j];
			}

		for(j=0;j<3;j++)
			{

			datamid=0.0;
			now_fir=i_fir_list;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+now_fir->data[j]*Fir[i];
				now_fir=now_fir->last;
				}

			i_fir_list->band_pass_data[j]=datamid-mean[j]*sum_fir;
			}
//		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]),0.5);
		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]+i_fir_list->band_pass_data[2]*i_fir_list->band_pass_data[2]),0.5);


		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataV[j]=now_fir->last->dataV[j]+(now_fir->last->data[j]+now_fir->data[j]-2*mean[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataV[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataV[j]=datamid;
			}
//		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]+i_fir_list->band_pass_dataV[2]*i_fir_list->band_pass_dataV[2]),0.5);
		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataD[j]=now_fir->last->dataD[j]+(now_fir->last->dataV[j]+now_fir->dataV[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataD[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataD[j]=datamid;
			}
//		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]+i_fir_list->band_pass_dataD[2]*i_fir_list->band_pass_dataD[2]),0.5);
		return 1;
		}
	else if(i_fir_list->sample_rata==100&&band_pass_flag==1)
		{

		firLength=301;
		double Fir[301]={-1.3934901977829615e-03,
			-1.8159417519245753e-03,
			-2.1047061992379365e-03,
			-2.1499567281675455e-03,
			-1.9319560065597574e-03,
			-1.5336077824486048e-03,
			-1.1131764610959451e-03,
			-8.4586773282764453e-04,
			-8.5571492559512663e-04,
			-1.1641429939370940e-03,
			-1.6763388826177095e-03,
			-2.2127045829863049e-03,
			-2.5752520825855834e-03,
			-2.6245209995463341e-03,
			-2.3372518475216625e-03,
			-1.8211766253946077e-03,
			-1.2790312324263129e-03,
			-9.3350462293830287e-04,
			-9.4077162689895221e-04,
			-1.3260577655623985e-03,
			-1.9675936202030414e-03,
			-2.6375233932370771e-03,
			-3.0863445849885914e-03,
			-3.1397319857095246e-03,
			-2.7703067122125825e-03,
			-2.1150445844176149e-03,
			-1.4290329171544275e-03,
			-9.9084931593346887e-04,
			-9.9450274977262157e-04,
			-1.4697037836401406e-03,
			-2.2629691037629874e-03,
			-3.0896434805398041e-03,
			-3.6395636772003424e-03,
			-3.6973125284921167e-03,
			-3.2306007769072587e-03,
			-2.4107945111442089e-03,
			-1.5546360967761310e-03,
			-1.0065972753527060e-03,
			-1.0053738031440373e-03,
			-1.5860839569270741e-03,
			-2.5579388666770995e-03,
			-3.5692958764463449e-03,
			-4.2383209384534298e-03,
			-4.3009144849360951e-03,
			-3.7187912246025431e-03,
			-2.7038140209237104e-03,
			-1.6456047543273620e-03,
			-9.6672554881740698e-04,
			-9.5902862506833195e-04,
			-1.6643298430027724e-03,
			-2.8478287426786748e-03,
			-4.0784458396371038e-03,
			-4.8890672246237271e-03,
			-4.9573843372280107e-03,
			-4.2375689803696064e-03,
			-2.9893918921230977e-03,
			-1.6892661355065719e-03,
			-8.5315338472186943e-04,
			-8.3687322528905046e-04,
			-1.6908134983387932e-03,
			-3.1279156197627396e-03,
			-4.6219899287065240e-03,
			-5.6032676672302818e-03,
			-5.6788440317752488e-03,
			-4.7930527289633748e-03,
			-3.2628185712932083e-03,
			-1.6691643874906282e-03,
			-6.4136490201577951e-04,
			-6.1355241309235965e-04,
			-1.6475301337705620e-03,
			-3.3935290783997270e-03,
			-5.2097909555231794e-03,
			-6.4008237800856037e-03,
			-6.4863194218901269e-03,
			-5.3972072803381739e-03,
			-3.5194883154958849e-03,
			-1.5625414496258179e-03,
			-2.9599484306628491e-04,
			-2.5223929370514470e-04,
			-1.5090285192966766e-03,
			-3.6401534025372944e-03,
			-5.8603941401391838e-03,
			-7.3164248762943827e-03,
			-7.4165259229421188e-03,
			-6.0723665880914419e-03,
			-3.7550004343177984e-03,
			-1.3353600892311249e-03,
			2.3788693116028032e-04,
			3.0473249946160190e-04,
			-1.2362210827844447e-03,
			-3.8635274170506517e-03,
			-6.6084146410208293e-03,
			-8.4123588516069620e-03,
			-8.5356836076430822e-03,
			-6.8604886253879381e-03,
			-3.9652570935789742e-03,
			-9.3168387924516256e-04,
			1.0534705820681239e-03,
			1.1561602642038765e-03,
			-7.6279308836732713e-04,
			-4.0597396392069423e-03,
			-7.5208401297042239e-03,
			-9.8072001726968727e-03,
			-9.9708294562862142e-03,
			-7.8443429100596568e-03,
			-4.1465552109397862e-03,
			-2.4844224798785294e-04,
			2.3271192130121512e-03,
			2.4913851040193188e-03,
			3.8417223566559994e-05,
			-4.2253163338121661e-03,
			-8.7382536865734783e-03,
			-1.1749625514224836e-02,
			-1.1991733098263043e-02,
			-9.2038390171244738e-03,
			-4.2956701090024274e-03,
			9.3449579474537436e-04,
			4.4450971219227456e-03,
			4.7325123287797061e-03,
			1.4542781444556027e-03,
			-4.3573002295476306e-03,
			-1.0601141815511635e-02,
			-1.4850187602870650e-02,
			-1.5274622891964655e-02,
			-1.1402122422123587e-02,
			-4.4099287906940446e-03,
			3.1992627279992338e-03,
			8.4610861449535505e-03,
			9.0647035001510286e-03,
			4.3128967563563032e-03,
			-4.4533178832161045e-03,
			-1.4174787943096560e-02,
			-2.1085357894361143e-02,
			-2.2096384652325083e-02,
			-1.6069207429197555e-02,
			-4.4872709594348387e-03,
			8.7849658638558172e-03,
			1.8665591162767350e-02,
			2.0618219193568481e-02,
			1.2446574643172092e-02,
			-4.5116339631119861e-03,
			-2.5272940970094884e-02,
			-4.2331277335992394e-02,
			-4.7764061273754821e-02,
			-3.5721208137345535e-02,
			-4.5262962159261927e-03,
			4.2308025951629580e-02,
			9.6544322689801162e-02,
			1.4711299332650787e-01,
			1.8293486636295642e-01,
			1.9587085363289147e-01,
			1.8293486636295639e-01,
			1.4711299332650785e-01,
			9.6544322689801135e-02,
			4.2308025951629566e-02,
			-4.5262962159261918e-03,
			-3.5721208137345535e-02,
			-4.7764061273754814e-02,
			-4.2331277335992387e-02,
			-2.5272940970094880e-02,
			-4.5116339631119853e-03,
			1.2446574643172089e-02,
			2.0618219193568474e-02,
			1.8665591162767347e-02,
			8.7849658638558138e-03,
			-4.4872709594348361e-03,
			-1.6069207429197544e-02,
			-2.2096384652325073e-02,
			-2.1085357894361126e-02,
			-1.4174787943096552e-02,
			-4.4533178832161010e-03,
			4.3128967563563006e-03,
			9.0647035001510234e-03,
			8.4610861449535436e-03,
			3.1992627279992312e-03,
			-4.4099287906940411e-03,
			-1.1402122422123580e-02,
			-1.5274622891964643e-02,
			-1.4850187602870640e-02,
			-1.0601141815511625e-02,
			-4.3573002295476280e-03,
			1.4542781444556018e-03,
			4.7325123287797017e-03,
			4.4450971219227413e-03,
			9.3449579474537349e-04,
			-4.2956701090024231e-03,
			-9.2038390171244669e-03,
			-1.1991733098263025e-02,
			-1.1749625514224822e-02,
			-8.7382536865734661e-03,
			-4.2253163338121600e-03,
			3.8417223566559994e-05,
			2.4913851040193153e-03,
			2.3271192130121469e-03,
			-2.4844224798785381e-04,
			-4.1465552109397810e-03,
			-7.8443429100596446e-03,
			-9.9708294562862020e-03,
			-9.8072001726968588e-03,
			-7.5208401297042135e-03,
			-4.0597396392069380e-03,
			-7.6279308836732583e-04,
			1.1561602642038756e-03,
			1.0534705820681221e-03,
			-9.3168387924516213e-04,
			-3.9652570935789682e-03,
			-6.8604886253879251e-03,
			-8.5356836076430683e-03,
			-8.4123588516069481e-03,
			-6.6084146410208154e-03,
			-3.8635274170506460e-03,
			-1.2362210827844425e-03,
			3.0473249946160017e-04,
			2.3788693116027988e-04,
			-1.3353600892311228e-03,
			-3.7550004343177915e-03,
			-6.0723665880914298e-03,
			-7.4165259229421032e-03,
			-7.3164248762943671e-03,
			-5.8603941401391716e-03,
			-3.6401534025372871e-03,
			-1.5090285192966731e-03,
			-2.5223929370514383e-04,
			-2.9599484306628491e-04,
			-1.5625414496258144e-03,
			-3.5194883154958771e-03,
			-5.3972072803381609e-03,
			-6.4863194218901122e-03,
			-6.4008237800855889e-03,
			-5.2097909555231664e-03,
			-3.3935290783997183e-03,
			-1.6475301337705575e-03,
			-6.1355241309235748e-04,
			-6.4136490201577821e-04,
			-1.6691643874906245e-03,
			-3.2628185712932005e-03,
			-4.7930527289633627e-03,
			-5.6788440317752332e-03,
			-5.6032676672302679e-03,
			-4.6219899287065127e-03,
			-3.1279156197627305e-03,
			-1.6908134983387882e-03,
			-8.3687322528904872e-04,
			-8.5315338472186726e-04,
			-1.6892661355065672e-03,
			-2.9893918921230908e-03,
			-4.2375689803695943e-03,
			-4.9573843372279977e-03,
			-4.8890672246237124e-03,
			-4.0784458396370933e-03,
			-2.8478287426786674e-03,
			-1.6643298430027674e-03,
			-9.5902862506832913e-04,
			-9.6672554881740416e-04,
			-1.6456047543273575e-03,
			-2.7038140209237008e-03,
			-3.7187912246025327e-03,
			-4.3009144849360829e-03,
			-4.2383209384534160e-03,
			-3.5692958764463336e-03,
			-2.5579388666770917e-03,
			-1.5860839569270702e-03,
			-1.0053738031440341e-03,
			-1.0065972753527028e-03,
			-1.5546360967761263e-03,
			-2.4107945111442020e-03,
			-3.2306007769072496e-03,
			-3.6973125284921046e-03,
			-3.6395636772003298e-03,
			-3.0896434805397937e-03,
			-2.2629691037629792e-03,
			-1.4697037836401362e-03,
			-9.9450274977261875e-04,
			-9.9084931593346518e-04,
			-1.4290329171544223e-03,
			-2.1150445844176089e-03,
			-2.7703067122125742e-03,
			-3.1397319857095142e-03,
			-3.0863445849885810e-03,
			-2.6375233932370672e-03,
			-1.9675936202030344e-03,
			-1.3260577655623941e-03,
			-9.4077162689894884e-04,
			-9.3350462293829940e-04,
			-1.2790312324263090e-03,
			-1.8211766253946012e-03,
			-2.3372518475216551e-03,
			-2.6245209995463237e-03,
			-2.5752520825855730e-03,
			-2.2127045829862962e-03,
			-1.6763388826177036e-03,
			-1.1641429939370888e-03,
			-8.5571492559512359e-04,
			-8.4586773282764138e-04,
			-1.1131764610959410e-03,
			-1.5336077824486000e-03,
			-1.9319560065597509e-03,
			-2.1499567281675781e-03,
			-2.1047061992379612e-03,
			-1.8159417519245733e-03,
			-1.3934901977829676e-03,



			};
		for(j=0;j<firLength;j++)
			{
			sum_fir+=Fir[j];
			}
		for(j=0;j<3;j++)
			{

			datamid=0.0;
			now_fir=i_fir_list;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+now_fir->data[j]*Fir[i];
				now_fir=now_fir->last;
				}

			i_fir_list->band_pass_data[j]=datamid-mean[j]*sum_fir;
			}
//		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]),0.5);
		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]+i_fir_list->band_pass_data[2]*i_fir_list->band_pass_data[2]),0.5);


		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataV[j]=now_fir->last->dataV[j]+(now_fir->last->data[j]+now_fir->data[j]-2*mean[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataV[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataV[j]=datamid;
			}
//		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]+i_fir_list->band_pass_dataV[2]*i_fir_list->band_pass_dataV[2]),0.5);
		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataD[j]=now_fir->last->dataD[j]+(now_fir->last->dataV[j]+now_fir->dataV[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataD[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataD[j]=datamid;
			}
//		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]+i_fir_list->band_pass_dataD[2]*i_fir_list->band_pass_dataD[2]),0.5);
		return 1;
		}
	else if(i_fir_list->sample_rata==200&&band_pass_flag==0)
		{
		firLength=301;

		double Fir[301]={-1.5738968347689628e-04,
			-1.7735491639294824e-04,
			-2.1736124094126334e-04,
			-2.7483905489700012e-04,
			-3.4266813193163193e-04,
			-4.1030106015100642e-04,
			-4.6590026089908369e-04,
			-4.9908565647348161e-04,
			-5.0368485858866155e-04,
			-4.7980096272096865e-04,
			-4.3459912811287315e-04,
			-3.8145932023061683e-04,
			-3.3750551620498548e-04,
			-3.1992389949451273e-04,
			-3.4182841427864982e-04,
			-4.0862956128619334e-04,
			-5.1584657092479044e-04,
			-6.4905509995696496e-04,
			-7.8621869932361810e-04,
			-9.0210075583715586e-04,
			-9.7391805542624665e-04,
			-9.8700968544837217e-04,
			-9.3916478239759282e-04,
			-8.4243680789333406e-04,
			-7.2175694572392348e-04,
			-6.1035700575723644e-04,
			-5.4277523357811595e-04,
			-5.4686940852928067e-04,
			-6.3663386121590247e-04,
			-8.0759555645765300e-04,
			-1.0361182005924534e-03,
			-1.2831404037890676e-03,
			-1.5018735401092786e-03,
			-1.6480075080620943e-03,
			-1.6902522160705587e-03,
			-1.6187724217614032e-03,
			-1.4493561975616916e-03,
			-1.2219729859712122e-03,
			-9.9357826868147307e-04,
			-8.2635727901226479e-04,
			-7.7376662014393995e-04,
			-8.6744203333462462e-04,
			-1.1080893063261379e-03,
			-1.4627990304460733e-03,
			-1.8699254737555102e-03,
			-2.2510004567963386e-03,
			-2.5274762640143944e-03,
			-2.6387982693635644e-03,
			-2.5577291433000224e-03,
			-2.2991713422791313e-03,
			-1.9199554375127431e-03,
			-1.5089616520395268e-03,
			-1.1691295962667500e-03,
			-9.9489997697284663e-04,
			-1.0499463509793807e-03,
			-1.3503416137936456e-03,
			-1.8574229089935940e-03,
			-2.4826907958067261e-03,
			-3.1044754803961948e-03,
			-3.5933784465069858e-03,
			-3.8412720032523487e-03,
			-3.7874595744862814e-03,
			-3.4358093523187173e-03,
			-2.8583194491591827e-03,
			-2.1833724736893233e-03,
			-1.5703255973366405e-03,
			-1.1753198885291142e-03,
			-1.1155270970319925e-03,
			-1.4398884580665875e-03,
			-2.1134488140001156e-03,
			-3.0197519628140561e-03,
			-3.9819340454248483e-03,
			-4.7989298359828224e-03,
			-5.2895315090100694e-03,
			-5.3347847421739408e-03,
			-4.9089772067057768e-03,
			-4.0914494807903403e-03,
			-3.0553263232042977e-03,
			-2.0342643861179957e-03,
			-1.2733736807093051e-03,
			-9.7444743993873348e-04,
			-1.2475579059199422e-03,
			-2.0803813561700931e-03,
			-3.3333020239832397e-03,
			-4.7630034661209093e-03,
			-6.0709747972200970e-03,
			-6.9675036714509026e-03,
			-7.2376487999995407e-03,
			-6.7944115044867989e-03,
			-5.7063144258142880e-03,
			-4.1915922126739454e-03,
			-2.5782559165073099e-03,
			-1.2369414329412996e-03,
			-5.0000439657026010e-04,
			-5.8423897384719532e-04,
			-1.5348385257546453e-03,
			-3.2045099423030948e-03,
			-5.2745989273480509e-03,
			-7.3160653117819293e-03,
			-8.8790713655859960e-03,
			-9.5928420397288355e-03,
			-9.2540312860429144e-03,
			-7.8830675166212654e-03,
			-5.7338544840285889e-03,
			-3.2517317719462481e-03,
			-9.8584385474959567e-04,
			5.2737308823975636e-04,
			8.8539160937573045e-04,
			-8.1278022656460546e-05,
			-2.2555652814956074e-03,
			-5.2408116952406677e-03,
			-8.4306412604161132e-03,
			-1.1130333116173553e-02,
			-1.2706151017152620e-02,
			-1.2731360484584070e-02,
			-1.1096337143008480e-02,
			-8.0559256539294525e-03,
			-4.1992280006084327e-03,
			-3.4304817834827792e-04,
			2.6329471431176831e-03,
			3.9772854451277720e-03,
			3.2439302636812226e-03,
			4.1585700052789186e-04,
			-4.0560792879092526e-03,
			-9.3139281317865166e-03,
			-1.4247613714347402e-02,
			-1.7717974336771903e-02,
			-1.8805230945223246e-02,
			-1.7031601742540699e-02,
			-1.2508339273051561e-02,
			-5.9695509104043653e-03,
			1.3240748146035209e-03,
			7.8028250387371500e-03,
			1.1892350786033203e-02,
			1.2350080720461974e-02,
			8.5682310423650879e-03,
			7.7979549076405419e-04,
			-9.8815104670206631e-03,
			-2.1491211233783846e-02,
			-3.1606466363625955e-02,
			-3.7661758554831441e-02,
			-3.7422874756706775e-02,
			-2.9419394015175061e-02,
			-1.3275490993334308e-02,
			1.0126511572124210e-02,
			3.8687978116648487e-02,
			6.9343825778920370e-02,
			9.8485912360757433e-02,
			1.2249350941875659e-01,
			1.3828375204993210e-01,
			1.4378957268385817e-01,
			1.3828375204993198e-01,
			1.2249350941875640e-01,
			9.8485912360757155e-02,
			6.9343825778920107e-02,
			3.8687978116648321e-02,
			1.0126511572124158e-02,
			-1.3275490993334225e-02,
			-2.9419394015174839e-02,
			-3.7422874756706463e-02,
			-3.7661758554831101e-02,
			-3.1606466363625629e-02,
			-2.1491211233783607e-02,
			-9.8815104670205468e-03,
			7.7979549076404465e-04,
			8.5682310423649734e-03,
			1.2350080720461792e-02,
			1.1892350786033016e-02,
			7.8028250387370190e-03,
			1.3240748146034983e-03,
			-5.9695509104042534e-03,
			-1.2508339273051316e-02,
			-1.7031601742540346e-02,
			-1.8805230945222844e-02,
			-1.7717974336771518e-02,
			-1.4247613714347076e-02,
			-9.3139281317862910e-03,
			-4.0560792879091503e-03,
			4.1585700052788145e-04,
			3.2439302636811385e-03,
			3.9772854451276627e-03,
			2.6329471431176059e-03,
			-3.4304817834826751e-04,
			-4.1992280006083061e-03,
			-8.0559256539291975e-03,
			-1.1096337143008119e-02,
			-1.2731360484583639e-02,
			-1.2706151017152188e-02,
			-1.1130333116173159e-02,
			-8.4306412604158061e-03,
			-5.2408116952404717e-03,
			-2.2555652814955185e-03,
			-8.1278022656457077e-05,
			8.8539160937569489e-04,
			5.2737308823973467e-04,
			-9.8584385474955491e-04,
			-3.2517317719461085e-03,
			-5.7338544840283339e-03,
			-7.8830675166209115e-03,
			-9.2540312860424894e-03,
			-9.5928420397283845e-03,
			-8.8790713655855676e-03,
			-7.3160653117815720e-03,
			-5.2745989273477829e-03,
			-3.2045099423029331e-03,
			-1.5348385257545655e-03,
			-5.8423897384716496e-04,
			-5.0000439657023278e-04,
			-1.2369414329412311e-03,
			-2.5782559165071638e-03,
			-4.1915922126737068e-03,
			-5.7063144258139575e-03,
			-6.7944115044863947e-03,
			-7.2376487999991001e-03,
			-6.9675036714504724e-03,
			-6.0709747972197223e-03,
			-4.7630034661206057e-03,
			-3.3333020239830237e-03,
			-2.0803813561699586e-03,
			-1.2475579059198585e-03,
			-9.7444743993866712e-04,
			-1.2733736807092175e-03,
			-2.0342643861178543e-03,
			-3.0553263232040791e-03,
			-4.0914494807900480e-03,
			-4.9089772067054177e-03,
			-5.3347847421735478e-03,
			-5.2895315090096687e-03,
			-4.7989298359824538e-03,
			-3.9819340454245395e-03,
			-3.0197519628138176e-03,
			-2.1134488139999473e-03,
			-1.4398884580664711e-03,
			-1.1155270970319006e-03,
			-1.1753198885290160e-03,
			-1.5703255973365086e-03,
			-2.1833724736891359e-03,
			-2.8583194491589325e-03,
			-3.4358093523184151e-03,
			-3.7874595744859440e-03,
			-3.8412720032520008e-03,
			-3.5933784465066554e-03,
			-3.1044754803959073e-03,
			-2.4826907958064920e-03,
			-1.8574229089934173e-03,
			-1.3503416137935148e-03,
			-1.0499463509792775e-03,
			-9.9489997697274797e-04,
			-1.1691295962666325e-03,
			-1.5089616520393724e-03,
			-1.9199554375125441e-03,
			-2.2991713422788910e-03,
			-2.5577291432997522e-03,
			-2.6387982693632807e-03,
			-2.5274762640141194e-03,
			-2.2510004567960896e-03,
			-1.8699254737553005e-03,
			-1.4627990304459074e-03,
			-1.1080893063260097e-03,
			-8.6744203333452400e-04,
			-7.7376662014384866e-04,
			-8.2635727901216656e-04,
			-9.9357826868135316e-04,
			-1.2219729859710637e-03,
			-1.4493561975615118e-03,
			-1.6187724217612007e-03,
			-1.6902522160703449e-03,
			-1.6480075080618820e-03,
			-1.5018735401090826e-03,
			-1.2831404037888989e-03,
			-1.0361182005923146e-03,
			-8.0759555645754327e-04,
			-6.3663386121581508e-04,
			-5.4686940852920413e-04,
			-5.4277523357803897e-04,
			-6.1035700575714949e-04,
			-7.2175694572381886e-04,
			-8.4243680789320959e-04,
			-9.3916478239745296e-04,
			-9.8700968544822277e-04,
			-9.7391805542609714e-04,
			-9.0210075583701556e-04,
			-7.8621869932349417e-04,
			-6.4905509995686088e-04,
			-5.1584657092470653e-04,
			-4.0862956128612563e-04,
			-3.4182841427859273e-04,
			-3.1992389949445831e-04,
			-3.3750551620492721e-04,
			-3.8145932023054988e-04,
			-4.3459912811279558e-04,
			-4.7980096272088148e-04,
			-5.0368485858856907e-04,
			-4.9908565647338837e-04,
			-4.6590026089899489e-04,
			-4.1030106015092717e-04,
			-3.4266813193156422e-04,
			-2.7483905489694477e-04,
			-2.1736124094121881e-04,
			-1.7735491639291114e-04,
			-1.5738968347686275e-04,


			};
		for(j=0;j<firLength;j++)
			{
			sum_fir+=Fir[j];
			}
		for(j=0;j<3;j++)
			{

			datamid=0.0;
			now_fir=i_fir_list;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+now_fir->data[j]*Fir[i];
				now_fir=now_fir->last;
				}

			i_fir_list->band_pass_data[j]=datamid-mean[j]*sum_fir;
			}
//		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]),0.5);
		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]+i_fir_list->band_pass_data[2]*i_fir_list->band_pass_data[2]),0.5);


		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataV[j]=now_fir->last->dataV[j]+(now_fir->last->data[j]+now_fir->data[j]-2*mean[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataV[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataV[j]=datamid;
			}
//		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]+i_fir_list->band_pass_dataV[2]*i_fir_list->band_pass_dataV[2]),0.5);
		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataD[j]=now_fir->last->dataD[j]+(now_fir->last->dataV[j]+now_fir->dataV[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataD[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataD[j]=datamid;
			}
//		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]+i_fir_list->band_pass_dataD[2]*i_fir_list->band_pass_dataD[2]),0.5);
		return 1;
		}
	else if(i_fir_list->sample_rata==200&&band_pass_flag==1)
		{
		firLength=541;

		double Fir[541]={-9.2099036038378532e-04,
			-7.8804826816350514e-04,
			-6.6560344061362866e-04,
			-5.6687547227462695e-04,
			-5.0305195443362731e-04,
			-4.8212458142003447e-04,
			-5.0801522925230963e-04,
			-5.8008622249482611e-04,
			-6.9309294300030314e-04,
			-8.3759419607064940e-04,
			-1.0007904473973064e-03,
			-1.1677166438897948e-03,
			-1.3226792145237351e-03,
			-1.4507998700714149e-03,
			-1.5395149164156340e-03,
			-1.5798796606311268e-03,
			-1.5675433814101799e-03,
			-1.5032900196379525e-03,
			-1.3930805785312536e-03,
			-1.2475813887482972e-03,
			-1.0812132551662164e-03,
			-9.1080504603679199e-04,
			-7.5397661608138985e-04,
			-6.2740578524895022e-04,
			-5.4514918710074384e-04,
			-5.1718531515799690e-04,
			-5.4832980445290475e-04,
			-6.3763933271860978e-04,
			-7.7837451944441324e-04,
			-9.5853814908441635e-04,
			-1.1619481531160475e-03,
			-1.3697506595220668e-03,
			-1.5622325114940184e-03,
			-1.7207597251464868e-03,
			-1.8296519661545247e-03,
			-1.8778052751213447e-03,
			-1.8598961554604190e-03,
			-1.7770380880220437e-03,
			-1.6368131495740684e-03,
			-1.4526618487227868e-03,
			-1.2426777301980229e-03,
			-1.0279134888687795e-03,
			-8.3035621871027751e-04,
			-6.7076573516148576e-04,
			-5.6658772472861297e-04,
			-5.3015062268610609e-04,
			-5.6733143777716296e-04,
			-6.7683314040934404e-04,
			-8.5015853938458274e-04,
			-1.0722982056842946e-03,
			-1.3230794514709333e-03,
			-1.5790565837738907e-03,
			-1.8157663436507616e-03,
			-2.0101324311648091e-03,
			-2.1427836247891099e-03,
			-2.2000535925879644e-03,
			-2.1754571889266504e-03,
			-2.0704856679088202e-03,
			-1.8946275302998378e-03,
			-1.6645966177239893e-03,
			-1.4028273596775336e-03,
			-1.1353710613629898e-03,
			-8.8938935754289306e-04,
			-6.9048502597345474e-04,
			-5.6013150133180209e-04,
			-5.1345808254886992e-04,
			-5.5761788704660181e-04,
			-6.9091251719947467e-04,
			-9.0277595818363658e-04,
			-1.1746371336738743e-03,
			-1.4815938115070816e-03,
			-1.7947487057919354e-03,
			-2.0839898846883352e-03,
			-2.3209490512706072e-03,
			-2.4818481466164577e-03,
			-2.5499498422015465e-03,
			-2.5173609120326093e-03,
			-2.3859964670479806e-03,
			-2.1675922672027342e-03,
			-1.8827443572853935e-03,
			-1.5590512379570593e-03,
			-1.2285242513423947e-03,
			-9.2450775236682355e-04,
			-6.7840413588373869e-04,
			-5.1652413990349946e-04,
			-4.5737696479821453e-04,
			-5.0967758766085958e-04,
			-6.7128325883947910e-04,
			-9.2918345122575824e-04,
			-1.2605657298138107e-03,
			-1.6348739179959412e-03,
			-2.0166749784740114e-03,
			-2.3690672229614647e-03,
			-2.6573034400949446e-03,
			-2.8522746288034552e-03,
			-2.9335066344339071e-03,
			-2.8913631482099544e-03,
			-2.7282208685875907e-03,
			-2.4584796038279720e-03,
			-2.1073826169179673e-03,
			-1.7087397545895546e-03,
			-1.3017563556190544e-03,
			-9.2726353456713112e-04,
			-6.2371066482157266e-04,
			-4.2331173523314162e-04,
			-3.4872998370800008e-04,
			-4.1063976990715308e-04,
			-6.0642476251474388e-04,
			-9.2016438994335105e-04,
			-1.3239361803047587e-03,
			-1.7803320420881636e-03,
			-2.2459644154696938e-03,
			-2.6756357782218845e-03,
			-3.0267727437604114e-03,
			-3.2636916931282249e-03,
			-3.3612706949638629e-03,
			-3.3076524683700241e-03,
			-3.1056912475649718e-03,
			-2.7729746824372565e-03,
			-2.3403892837598060e-03,
			-1.8493412139778430e-03,
			-1.3478794014496636e-03,
			-8.8608150223198922e-04,
			-5.1114349515264787e-04,
			-2.6265206842258714e-04,
			-1.6851079481957512e-04,
			-2.4193625100973236e-04,
			-4.7984317191924781e-04,
			-8.6280715728713074e-04,
			-1.3566415625985743e-03,
			-1.9154665600813400e-03,
			-2.4859984617802782e-03,
			-3.0126612251738065e-03,
			-3.4430325498542480e-03,
			-3.7330937104403427e-03,
			-3.8517604832979464e-03,
			-3.7842324736531100e-03,
			-3.5338050023559580e-03,
			-3.1219319124799489e-03,
			-2.5864957712039751e-03,
			-1.9784179024470525e-03,
			-1.3569073131266510e-03,
			-7.8378825350351668e-04,
			-3.1744647022797834e-04,
			-6.9834312824419518e-06,
			1.1284000836526972e-04,
			2.5354317567758977e-05,
			-2.6597224788052265e-04,
			-7.3743067972836655e-04,
			-1.3469646033695993e-03,
			-2.0379172193921657e-03,
			-2.7443031575346403e-03,
			-3.3971190584163721e-03,
			-3.9310935787960494e-03,
			-4.2912209155740550e-03,
			-4.4384286657659696e-03,
			-4.3538016122489434e-03,
			-4.0409122987702514e-03,
			-3.5259856147050032e-03,
			-2.8558317578400881e-03,
			-2.0937002074628681e-03,
			-1.3134155200516908e-03,
			-5.9233317583970750e-04,
			-3.7822358250078755e-06,
			3.9027251319353107e-04,
			5.4562083721612718e-04,
			4.4059792201310989e-04,
			7.8766065900046770e-05,
			-5.1082710083981203e-04,
			-1.2758972595056852e-03,
			-2.1455177714411132e-03,
			-3.0366641508699954e-03,
			-3.8621118097987728e-03,
			-4.5389428080685424e-03,
			-4.9968394044701686e-03,
			-5.1853430528545691e-03,
			-5.0793389195515149e-03,
			-4.6821819764329082e-03,
			-4.0260977778495107e-03,
			-3.1697493995113059e-03,
			-2.1931374329631778e-03,
			-1.1902658708177875e-03,
			-2.6023694791261148e-04,
			5.0239086906258580e-04,
			1.0170537242174349e-03,
			1.2255086096815426e-03,
			1.0981873138275063e-03,
			6.3790127253392042e-04,
			-1.1953798113192900e-04,
			-1.1079276778061561e-03,
			-2.2363446488090528e-03,
			-3.3974065727959773e-03,
			-4.4773856919170718e-03,
			-5.3672354801872664e-03,
			-5.9734753110310982e-03,
			-6.2278624174949846e-03,
			-6.0948685932705384e-03,
			-5.5761654078248781e-03,
			-4.7115908003906980e-03,
			-3.5763979419758700e-03,
			-2.2749440304833169e-03,
			-9.3132842805940036e-04,
			3.2219796078291040e-04,
			1.3579883121752859e-03,
			2.0657109495232774e-03,
			2.3637734346849855e-03,
			2.2083038115951678e-03,
			1.5987342434481875e-03,
			5.7933196288304162e-04,
			-7.6360523631937476e-04,
			-2.3087604573219398e-03,
			-3.9104757284739783e-03,
			-5.4121833258849901e-03,
			-6.6613801997739783e-03,
			-7.5247452268142716e-03,
			-7.9019373222448622e-03,
			-7.7366891333259091e-03,
			-7.0240232005336425e-03,
			-5.8127492393513962e-03,
			-4.2028248373273342e-03,
			-2.3376400760274124e-03,
			-3.9177573876898449e-04,
			1.4447611912945188e-03,
			2.9844462893490794e-03,
			4.0606549183290512e-03,
			4.5448405291744071e-03,
			4.3607762636084981e-03,
			3.4943738979672815e-03,
			1.9979539455294236e-03,
			-1.1679981628951848e-05,
			-2.3614511802506899e-03,
			-4.8360047833993728e-03,
			-7.1964238219141821e-03,
			-9.2021151553450583e-03,
			-1.0633951165805386e-02,
			-1.1316552798255641e-02,
			-1.1137586000254470e-02,
			-1.0062124842053854e-02,
			-8.1405010867291669e-03,
			-5.5085851061377634e-03,
			-2.3800849646007840e-03,
			9.6884449252551230e-04,
			4.2216836898676243e-03,
			7.0486768194433849e-03,
			9.1368371170709086e-03,
			1.0220305897430315e-02,
			1.0108397670110335e-02,
			8.7087474354680741e-03,
			6.0432886744458819e-03,
			2.2553117568610858e-03,
			-2.3934561482566973e-03,
			-7.5360015862024794e-03,
			-1.2722801055507309e-02,
			-1.7452784005121087e-02,
			-2.1210303569516521e-02,
			-2.3505355684549270e-02,
			-2.3913919959109343e-02,
			-2.2115177846259819e-02,
			-1.7922511198655740e-02,
			-1.1305590976966528e-02,
			-2.4015034641907277e-03,
			8.4863183807199517e-03,
			2.0901652188791666e-02,
			3.4260844192471288e-02,
			4.7888335453839595e-02,
			6.1059894106108653e-02,
			7.3050446110118419e-02,
			8.3182990982319571e-02,
			9.0874957753215704e-02,
			9.5678513253330877e-02,
			9.7311769218428879e-02,
			9.5678513253330918e-02,
			9.0874957753215677e-02,
			8.3182990982319585e-02,
			7.3050446110118419e-02,
			6.1059894106108667e-02,
			4.7888335453839609e-02,
			3.4260844192471288e-02,
			2.0901652188791666e-02,
			8.4863183807199569e-03,
			-2.4015034641907285e-03,
			-1.1305590976966534e-02,
			-1.7922511198655757e-02,
			-2.2115177846259833e-02,
			-2.3913919959109346e-02,
			-2.3505355684549270e-02,
			-2.1210303569516531e-02,
			-1.7452784005121090e-02,
			-1.2722801055507311e-02,
			-7.5360015862024829e-03,
			-2.3934561482566981e-03,
			2.2553117568610867e-03,
			6.0432886744458819e-03,
			8.7087474354680741e-03,
			1.0108397670110337e-02,
			1.0220305897430322e-02,
			9.1368371170709086e-03,
			7.0486768194433849e-03,
			4.2216836898676261e-03,
			9.6884449252551273e-04,
			-2.3800849646007844e-03,
			-5.5085851061377642e-03,
			-8.1405010867291686e-03,
			-1.0062124842053856e-02,
			-1.1137586000254470e-02,
			-1.1316552798255644e-02,
			-1.0633951165805386e-02,
			-9.2021151553450635e-03,
			-7.1964238219141838e-03,
			-4.8360047833993763e-03,
			-2.3614511802506908e-03,
			-1.1679981628951848e-05,
			1.9979539455294258e-03,
			3.4943738979672854e-03,
			4.3607762636085007e-03,
			4.5448405291744088e-03,
			4.0606549183290546e-03,
			2.9844462893490803e-03,
			1.4447611912945196e-03,
			-3.9177573876898449e-04,
			-2.3376400760274133e-03,
			-4.2028248373273359e-03,
			-5.8127492393514005e-03,
			-7.0240232005336460e-03,
			-7.7366891333259160e-03,
			-7.9019373222448709e-03,
			-7.5247452268142768e-03,
			-6.6613801997739835e-03,
			-5.4121833258849944e-03,
			-3.9104757284739800e-03,
			-2.3087604573219420e-03,
			-7.6360523631937541e-04,
			5.7933196288304206e-04,
			1.5987342434481888e-03,
			2.2083038115951695e-03,
			2.3637734346849881e-03,
			2.0657109495232787e-03,
			1.3579883121752868e-03,
			3.2219796078291127e-04,
			-9.3132842805940057e-04,
			-2.2749440304833191e-03,
			-3.5763979419758734e-03,
			-4.7115908003907024e-03,
			-5.5761654078248851e-03,
			-6.0948685932705410e-03,
			-6.2278624174949872e-03,
			-5.9734753110311043e-03,
			-5.3672354801872690e-03,
			-4.4773856919170770e-03,
			-3.3974065727959803e-03,
			-2.2363446488090563e-03,
			-1.1079276778061574e-03,
			-1.1953798113192943e-04,
			6.3790127253392085e-04,
			1.0981873138275076e-03,
			1.2255086096815435e-03,
			1.0170537242174358e-03,
			5.0239086906258667e-04,
			-2.6023694791261213e-04,
			-1.1902658708177892e-03,
			-2.1931374329631804e-03,
			-3.1697493995113107e-03,
			-4.0260977778495150e-03,
			-4.6821819764329151e-03,
			-5.0793389195515218e-03,
			-5.1853430528545760e-03,
			-4.9968394044701747e-03,
			-4.5389428080685442e-03,
			-3.8621118097987776e-03,
			-3.0366641508699980e-03,
			-2.1455177714411145e-03,
			-1.2758972595056867e-03,
			-5.1082710083981311e-04,
			7.8766065900046770e-05,
			4.4059792201311075e-04,
			5.4562083721612805e-04,
			3.9027251319353150e-04,
			-3.7822358250078755e-06,
			-5.9233317583970880e-04,
			-1.3134155200516921e-03,
			-2.0937002074628711e-03,
			-2.8558317578400915e-03,
			-3.5259856147050088e-03,
			-4.0409122987702592e-03,
			-4.3538016122489503e-03,
			-4.4384286657659757e-03,
			-4.2912209155740620e-03,
			-3.9310935787960546e-03,
			-3.3971190584163777e-03,
			-2.7443031575346438e-03,
			-2.0379172193921687e-03,
			-1.3469646033696017e-03,
			-7.3743067972836828e-04,
			-2.6597224788052351e-04,
			2.5354317567759410e-05,
			1.1284000836526972e-04,
			-6.9834312824415181e-06,
			-3.1744647022797877e-04,
			-7.8378825350351841e-04,
			-1.3569073131266529e-03,
			-1.9784179024470564e-03,
			-2.5864957712039799e-03,
			-3.1219319124799550e-03,
			-3.5338050023559641e-03,
			-3.7842324736531187e-03,
			-3.8517604832979556e-03,
			-3.7330937104403505e-03,
			-3.4430325498542550e-03,
			-3.0126612251738143e-03,
			-2.4859984617802843e-03,
			-1.9154665600813439e-03,
			-1.3566415625985765e-03,
			-8.6280715728713248e-04,
			-4.7984317191924932e-04,
			-2.4193625100973301e-04,
			-1.6851079481957555e-04,
			-2.6265206842258801e-04,
			-5.1114349515264874e-04,
			-8.8608150223199096e-04,
			-1.3478794014496660e-03,
			-1.8493412139778472e-03,
			-2.3403892837598117e-03,
			-2.7729746824372626e-03,
			-3.1056912475649788e-03,
			-3.3076524683700315e-03,
			-3.3612706949638690e-03,
			-3.2636916931282319e-03,
			-3.0267727437604183e-03,
			-2.6756357782218901e-03,
			-2.2459644154696990e-03,
			-1.7803320420881675e-03,
			-1.3239361803047617e-03,
			-9.2016438994335268e-04,
			-6.0642476251474497e-04,
			-4.1063976990715395e-04,
			-3.4872998370800073e-04,
			-4.2331173523314271e-04,
			-6.2371066482157418e-04,
			-9.2726353456713318e-04,
			-1.3017563556190573e-03,
			-1.7087397545895596e-03,
			-2.1073826169179721e-03,
			-2.4584796038279785e-03,
			-2.7282208685875963e-03,
			-2.8913631482099622e-03,
			-2.9335066344339149e-03,
			-2.8522746288034630e-03,
			-2.6573034400949511e-03,
			-2.3690672229614721e-03,
			-2.0166749784740171e-03,
			-1.6348739179959453e-03,
			-1.2605657298138137e-03,
			-9.2918345122576030e-04,
			-6.7128325883948105e-04,
			-5.0967758766086110e-04,
			-4.5737696479821561e-04,
			-5.1652413990350054e-04,
			-6.7840413588374053e-04,
			-9.2450775236682593e-04,
			-1.2285242513423978e-03,
			-1.5590512379570643e-03,
			-1.8827443572853996e-03,
			-2.1675922672027411e-03,
			-2.3859964670479871e-03,
			-2.5173609120326171e-03,
			-2.5499498422015530e-03,
			-2.4818481466164642e-03,
			-2.3209490512706150e-03,
			-2.0839898846883422e-03,
			-1.7947487057919410e-03,
			-1.4815938115070857e-03,
			-1.1746371336738774e-03,
			-9.0277595818363940e-04,
			-6.9091251719947640e-04,
			-5.5761788704660311e-04,
			-5.1345808254887144e-04,
			-5.6013150133180361e-04,
			-6.9048502597345647e-04,
			-8.8938935754289588e-04,
			-1.1353710613629931e-03,
			-1.4028273596775388e-03,
			-1.6645966177239954e-03,
			-1.8946275302998434e-03,
			-2.0704856679088272e-03,
			-2.1754571889266573e-03,
			-2.2000535925879735e-03,
			-2.1427836247891172e-03,
			-2.0101324311648161e-03,
			-1.8157663436507688e-03,
			-1.5790565837738965e-03,
			-1.3230794514709379e-03,
			-1.0722982056842985e-03,
			-8.5015853938458566e-04,
			-6.7683314040934653e-04,
			-5.6733143777716502e-04,
			-5.3015062268610771e-04,
			-5.6658772472861503e-04,
			-6.7076573516148782e-04,
			-8.3035621871028087e-04,
			-1.0279134888687830e-03,
			-1.2426777301980277e-03,
			-1.4526618487227918e-03,
			-1.6368131495740745e-03,
			-1.7770380880220505e-03,
			-1.8598961554604264e-03,
			-1.8778052751213517e-03,
			-1.8296519661545317e-03,
			-1.7207597251464937e-03,
			-1.5622325114940253e-03,
			-1.3697506595220725e-03,
			-1.1619481531160521e-03,
			-9.5853814908442015e-04,
			-7.7837451944441616e-04,
			-6.3763933271861217e-04,
			-5.4832980445290724e-04,
			-5.1718531515799874e-04,
			-5.4514918710074623e-04,
			-6.2740578524895249e-04,
			-7.5397661608139343e-04,
			-9.1080504603679589e-04,
			-1.0812132551662208e-03,
			-1.2475813887483022e-03,
			-1.3930805785312590e-03,
			-1.5032900196379592e-03,
			-1.5675433814101875e-03,
			-1.5798796606311340e-03,
			-1.5395149164156405e-03,
			-1.4507998700714214e-03,
			-1.3226792145237412e-03,
			-1.1677166438897998e-03,
			-1.0007904473973103e-03,
			-8.3759419607065287e-04,
			-6.9309294300030650e-04,
			-5.8008622249482893e-04,
			-5.0801522925231191e-04,
			-4.8212458142003674e-04,
			-5.0305195443362970e-04,
			-5.6687547227462652e-04,
			-6.6560344061365078e-04,
			-7.8804826816350926e-04,
			-9.2099036038381839e-04,



			};
		for(j=0;j<firLength;j++)
			{
			sum_fir+=Fir[j];
			}
		for(j=0;j<3;j++)
			{

			datamid=0.0;
			now_fir=i_fir_list;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+now_fir->data[j]*Fir[i];
				now_fir=now_fir->last;
				}

			i_fir_list->band_pass_data[j]=datamid-mean[j]*sum_fir;
			}
//		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]),0.5);
		i_fir_list->band_pass_data[4]=pow((double)(i_fir_list->band_pass_data[0]*i_fir_list->band_pass_data[0]+i_fir_list->band_pass_data[1]*i_fir_list->band_pass_data[1]+i_fir_list->band_pass_data[2]*i_fir_list->band_pass_data[2]),0.5);


		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataV[j]=now_fir->last->dataV[j]+(now_fir->last->data[j]+now_fir->data[j]-2*mean[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataV[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataV[j]=datamid;
			}
//		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
		i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]+i_fir_list->band_pass_dataV[2]*i_fir_list->band_pass_dataV[2]),0.5);
		for(j=0;j<3;j++)
			{
			datamid=0.0;
			now_fir=i_fir_list;
			now_fir->dataD[j]=now_fir->last->dataD[j]+(now_fir->last->dataV[j]+now_fir->dataV[j])*0.5/sample_rata;
			for(i=0;i<firLength;i++)
				{
				datamid=datamid+(now_fir->dataD[j])*Fir[i];
				now_fir=now_fir->last;
				}
			i_fir_list->band_pass_dataD[j]=datamid;
			}
//		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
		i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]+i_fir_list->band_pass_dataD[2]*i_fir_list->band_pass_dataD[2]),0.5);
		return 1;
		}

	return 0;

	};





int calculate_mean(FIR_LIST* fir_list,float *mean)
	{
	//¼ÆËãµ±Ç°µãÊ®ÃëµÄ¾ùÖµÒÔ¼°dataD£¬dataV£¨¶¼ÊÇ10ÃëÇ°¿ªÊ¼µÄ£©
	//fir_list µ±Ç°µãµÄlistÖ¸Õë mean ¼ÆËãµÃµ½µÄ¾ùÖµ
	int i,j,k;
	int sample_rata=fir_list->sample_rata;
	double mean_mid[3]={0.0,0.0,0.0};
	FIR_LIST *now_list;
	now_list=fir_list;

	for(i=0;i<10*sample_rata;i++)
		{
			for(j=0;j<3;j++)
			{
			mean_mid[j]+=now_list->data[j];
			}
			now_list=now_list->last;
		}

	for(j=0;j<3;j++)
		{
		mean[j]=mean_mid[j]/(10*sample_rata);
		}
	//now_list=fir_list;

	for(j=0;j<3;j++)
		{
		now_list->dataV[j]=(now_list->data[j]-mean[j])*0.5/sample_rata;
		now_list->dataD[j]=now_list->dataV[j]*0.5/sample_rata;
		}
	//now_list->data[4]=pow((double)(now_list->data[0]*now_list->data[0]+now_list->data[1]*now_list->data[1]),0.5);
	now_list->band_pass_data[4]=pow((double)(now_list->band_pass_data[0]*now_list->band_pass_data[0]+now_list->band_pass_data[1]*now_list->band_pass_data[1]+now_list->band_pass_data[2]*now_list->band_pass_data[2]),0.5);
	//now_list->dataV[4]=pow((double)(now_list->dataV[0]*now_list->dataV[0]+now_list->dataV[1]*now_list->dataV[1]),0.5);
	now_list->band_pass_dataV[4]=pow((double)(now_list->band_pass_dataV[0]*now_list->band_pass_dataV[0]+now_list->band_pass_dataV[1]*now_list->band_pass_dataV[1]+now_list->band_pass_dataV[2]*now_list->band_pass_dataV[2]),0.5);
	//now_list->dataD[4]=pow((double)(now_list->dataD[0]*now_list->dataD[0]+now_list->dataD[1]*now_list->dataD[1]),0.5);
	now_list->band_pass_dataD[4]=pow((double)(now_list->band_pass_dataD[0]*now_list->band_pass_dataD[0]+now_list->band_pass_dataD[1]*now_list->band_pass_dataD[1]+now_list->band_pass_dataD[2]*now_list->band_pass_dataD[2]),0.5);	
	
	
	
	
	now_list=now_list->next;

	for(i=0;i<10*sample_rata;i++)//ÕâÀï¼õÈ¥2ÊÇÎªÁËºÍºóÃæµÄ¼ÆËãpgv£¬pgdµÄº¯ÊýÅäºÏ
		{
		for(j=0;j<3;j++)
			{

			
		now_list->dataV[j]=now_list->last->dataV[j]+(now_list->last->data[j]+now_list->data[j]-2*mean[j])*0.5/sample_rata;
		now_list->dataD[j]=now_list->last->dataD[j]+(now_list->last->dataV[j]+now_list->dataV[j])*0.5/sample_rata;
			}

		//now_list->data[4]=pow((double)(now_list->data[0]*now_list->data[0]+now_list->data[1]*now_list->data[1]),0.5);
		//now_list->dataV[4]=pow((double)(now_list->dataV[0]*now_list->dataV[0]+now_list->dataV[1]*now_list->dataV[1]),0.5);
		//now_list->dataD[4]=pow((double)(now_list->dataD[0]*now_list->dataD[0]+now_list->dataD[1]*now_list->dataD[1]),0.5);

		now_list->data[4]=pow((double)(now_list->data[0]*now_list->data[0]+now_list->data[1]*now_list->data[1]+now_list->data[2]*now_list->data[2]),0.5);
		now_list->dataV[4]=pow((double)(now_list->dataV[0]*now_list->dataV[0]+now_list->dataV[1]*now_list->dataV[1]+now_list->dataV[2]*now_list->dataV[2]),0.5);
		now_list->dataD[4]=pow((double)(now_list->dataD[0]*now_list->dataD[0]+now_list->dataD[1]*now_list->dataD[1]+now_list->dataD[2]*now_list->dataD[2]),0.5);


		now_list=now_list->next;

		}

	return 1;

	}
int resample11_11(FIR_LIST1 *i_fir_list,int* location,FIR_LIST *i_result_list,int *first_time,int vector_type)
	{
	//²»ÔÙ¼ÆËãÃ¿¸öµãµÄdataV dataD ½öÊÇ¼ÆËãdata
	int firLength,j;
	int naomiao=1000000000;
	double datamid;
	FIR_LIST1 *now_fir;
	if (i_fir_list->sample_rata==50)
		{
		firLength=165;
		double Fir[165]={4.9641455551500924e-04 ,
			2.0861378186126486e-03 ,
			5.9371867707562944e-03 ,
			1.3518407568000015e-02 ,
			2.6341291481791776e-02 ,
			4.5433407622373294e-02 ,
			7.0694789139687478e-02 ,
			1.0032599556820671e-01 ,
			1.3057809289278391e-01 ,
			1.5604920102387312e-01 ,
			1.7062620696768016e-01 ,
			1.6896304436890949e-01 ,
			1.4815777196678998e-01 ,
			1.0912468872363833e-01 ,
			5.7136290507488259e-02 ,
			1.1765053278084471e-03 ,
			-4.7920119380674246e-02 ,
			-8.0159669026659580e-02 ,
			-8.9180647540351571e-02 ,
			-7.4271692869622138e-02 ,
			-4.0882959531061157e-02 ,
			6.8228177420737808e-04 ,
			3.8130031772198307e-02 ,
			6.0778152613811566e-02 ,
			6.2770953134357349e-02 ,
			4.4833613072213487e-02 ,
			1.3932419151181995e-02 ,
			-1.9102954449573384e-02 ,
			-4.3231019385772076e-02 ,
			-5.0891959762388125e-02 ,
			-4.0467483860047435e-02 ,
			-1.6646934188868603e-02 ,
			1.1421857776306230e-02 ,
			3.3520885458170509e-02 ,
			4.2052471614766961e-02 ,
			3.4686478875163976e-02 ,
			1.5010718732802113e-02 ,
			-9.0184186909654449e-03 ,
			-2.8202041261691381e-02 ,
			-3.5592116981032720e-02 ,
			-2.9022278850113357e-02 ,
			-1.1737280586981898e-02 ,
			9.0687831748027681e-03 ,
			2.5183300867102770e-02 ,
			3.0596161151405579e-02 ,
			2.3747045860466644e-02 ,
			7.9491966081399641e-03 ,
			-1.0118766864188540e-02 ,
			-2.3193387280601028e-02 ,
			-2.6332570666082029e-02 ,
			-1.8784540879037852e-02 ,
			-4.1077507236406095e-03 ,
			1.1444165095785774e-02 ,
			2.1558537605452899e-02 ,
			2.2417130381194396e-02 ,
			1.4133943714712835e-02 ,
			5.3451923686850724e-04 ,
			-1.2569329543819424e-02 ,
			-1.9844601735316731e-02 ,
			-1.8601266430032466e-02 ,
			-9.7773704037175096e-03 ,
			2.6131953072813414e-03 ,
			1.3278887077236207e-02 ,
			1.7898119909027670e-02 ,
			1.4864737610862301e-02 ,
			5.8270635558930455e-03 ,
			-5.1519181537227491e-03 ,
			-1.3402596621367304e-02 ,
			-1.5626465614023366e-02 ,
			-1.1208101352319783e-02 ,
			-2.3414092152496471e-03 ,
			7.0285444763493674e-03 ,
			1.2948329498229844e-02 ,
			1.3117763840411755e-02 ,
			7.7738022646380248e-03 ,
			-5.3902498426174137e-04 ,
			-8.1605460504767819e-03 ,
			-1.1917827562232376e-02 ,
			-1.0439942484953170e-02 ,
			-4.6419071140587440e-03 ,
			2.7851977222961761e-03 ,
			8.6102577645724345e-03 ,
			1.0461231321983511e-02 ,
			7.7837791788257886e-03 ,
			1.9749625036189324e-03 ,
			-4.3203501210721338e-03 ,
			-8.4047263965501690e-03 ,
			-8.6782014798381935e-03 ,
			-5.2549395514285063e-03 ,
			1.8646412280456107e-04 ,
			5.2110987409515743e-03 ,
			7.7106544334032724e-03 ,
			6.7820157458664413e-03 ,
			3.0379288862060821e-03 ,
			-1.7489311403861120e-03 ,
			-5.4753949627258797e-03 ,
			-6.6263311708058981e-03 ,
			-4.8832904244723091e-03 ,
			-1.1821673665924283e-03 ,
			2.7694433605619231e-03 ,
			5.2731165254131726e-03 ,
			5.3643358691174078e-03 ,
			3.1740611902241972e-03 ,
			-2.0336140420331846e-04 ,
			-3.2454664403018768e-03 ,
			-4.6825224974431584e-03 ,
			-4.0216886909035807e-03 ,
			-1.7007493067159065e-03 ,
			1.1677646005837593e-03 ,
			3.3223266015993025e-03 ,
			3.9024742248125765e-03 ,
			2.7853577250094648e-03 ,
			5.8068877506803373e-04 ,
			-1.6874003239461088e-03 ,
			-3.0506146168672896e-03 ,
			-3.0051155179690778e-03 ,
			-1.6882524498498489e-03 ,
			2.3345697643360156e-04 ,
			1.8932191551250081e-03 ,
			2.6105522313560601e-03 ,
			2.1650290090240278e-03 ,
			8.4961889270458214e-04 ,
			-6.9991983976259021e-04 ,
			-1.8066605034299885e-03 ,
			-2.0442478039422183e-03 ,
			-1.3947895802411611e-03 ,
			-2.1778805894814116e-04 ,
			9.3880999124384479e-04 ,
			1.5896069495257657e-03 ,
			1.5114885297533255e-03 ,
			8.1186820415698059e-04 ,
			-1.5058229368607759e-04 ,
			-9.4384608750351900e-04 ,
			-1.2530996766558678e-03 ,
			-1.0012813253543512e-03 ,
			-3.5580323523576812e-04 ,
			3.6915829402987393e-04 ,
			8.6166517210201825e-04 ,
			9.4321915671371191e-04 ,
			6.2839852380132605e-04 ,
			9.5907205753932231e-05 ,
			-4.0626184847617191e-04 ,
			-6.7339954953361109e-04 ,
			-6.2450419057352626e-04 ,
			-3.2049055349451757e-04 ,
			7.9630912629678407e-05 ,
			3.9808566929092065e-04 ,
			5.1498901799025597e-04 ,
			4.1035124916093260e-04 ,
			1.5844912981049161e-04 ,
			-1.1639279192463697e-04 ,
			-2.9853442979296894e-04 ,
			-3.2749921041051673e-04 ,
			-2.1457932271049809e-04 ,
			-2.7179669080954586e-05 ,
			1.4748545183980273e-04 ,
			2.4091962748403346e-04 ,
			2.2772734522904744e-04 ,
			1.2822291339905899e-04 ,
			-7.9288020909925007e-06 ,
			-1.2676835065509535e-04 ,
			-1.9181698110169713e-04 ,
			-1.9427077204277652e-04 ,
			-1.4987365019528419e-04 ,
			-1.0932778659256012e-04 ,
			};

		if(*location!=1)
			{
			if(*location==4)
				*location=1;
			else
				*location=*location+1;

			return 1;
			}
		else if((*location==1))
			{
			for(j=0;j<3;j++)
				{

				datamid=0.0;
				now_fir=i_fir_list;
				for(int i=0;i<firLength;i++)
					{

					datamid=datamid+now_fir->data[j]*Fir[i];
						
					now_fir=now_fir->last;
					}

				i_result_list->data[j]=datamid;

				}

			i_result_list->utc_nanosecond=i_fir_list->utc_nanosecond-8*(long)((double)(1.0)/200*naomiao);
			if(i_result_list->utc_nanosecond<0)
				{
				i_result_list->utc_nanosecond=i_result_list->utc_nanosecond+naomiao;
				i_result_list->utc_second=i_fir_list->utc_second-1;
				}
			else
				{
				i_result_list->utc_nanosecond=i_result_list->utc_nanosecond;
				i_result_list->utc_second=i_fir_list->utc_second;
				}



			i_result_list->sample_rata=i_fir_list->sample_rata;

			//if(*first_time==1)
			//	{
			//	int i;
			//	for(i=0;i<3;i++)
			//		{
			//	i_result_list->dataV[i]=i_result_list->data[i]/i_result_list->sample_rata/2;
			//		}
			//	
			//	}
			//else
			//	{
			//	int i;
			//	for(i=0;i<3;i++)
			//		{
			//		i_result_list->dataV[i]=i_result_list->last->dataV[i]+(i_result_list->data[i]+i_result_list->last->data[i])/i_result_list->sample_rata/2;
			//		}
			//	}

			//if(*first_time==1)
			//	{
			//	int i;
			//	for(i=0;i<3;i++)
			//		{
			//		i_result_list->dataD[i]=i_result_list->dataV[i]/i_result_list->sample_rata/2;
			//		}
			//	*first_time=2;
			//	}
			//else
			//	{
			//	int i;
			//	for(i=0;i<3;i++)
			//		{
			//		i_result_list->dataD[i]=i_result_list->last->dataD[i]+(i_result_list->dataV[i]+i_result_list->last->dataV[i])/i_result_list->sample_rata/2;
			//		}
			//	}


			//if(vector_type==3)
			//	{

			//	i_result_list->data[4]=pow((double)(i_result_list->data[0]*i_result_list->data[0]+i_result_list->data[1]*i_result_list->data[1]+i_result_list->data[2]*i_result_list->data[2]),0.5);
			//	i_result_list->dataV[4]=pow((double)(i_result_list->dataV[0]*i_result_list->dataV[0]+i_result_list->dataV[1]*i_result_list->dataV[1]+i_result_list->dataV[2]*i_result_list->dataV[2]),0.5);
			//	i_result_list->dataD[4]=pow((double)(i_result_list->dataD[0]*i_result_list->dataD[0]+i_result_list->dataD[1]*i_result_list->dataD[1]+i_result_list->dataD[2]*i_result_list->dataD[2]),0.5);
			//	}
			//if(vector_type==2)
			//	{
			//	i_result_list->data[4]=pow((double)(i_result_list->data[0]*i_result_list->data[0]+i_result_list->data[1]*i_result_list->data[1]),0.5);
			//	i_result_list->dataV[4]=pow((double)(i_result_list->dataV[0]*i_result_list->dataV[0]+i_result_list->dataV[1]*i_result_list->dataV[1]),0.5);
			//	i_result_list->dataD[4]=pow((double)(i_result_list->dataD[0]*i_result_list->dataD[0]+i_result_list->dataD[1]*i_result_list->dataD[1]),0.5);
			//	}




				//i_result_list->utc_nanosecond=i_fir_list->utc_nanosecond;
				//i_result_list->utc_second=i_fir_list->utc_second;
				*location=*location+1;



			return 2;
			}

		}
	else if(i_fir_list->sample_rata==100)
		{

		firLength=83;
		double Fir[83]={4.9565345342527083e-03 ,
			3.1012441821297185e-02 ,
			1.0048883061092734e-01 ,
			2.1432464632013803e-01 ,
			3.2147309841312671e-01 ,
			3.3257689284339487e-01 ,
			1.9671911052858826e-01 ,
			-2.1847188192472854e-02 ,
			-1.6830668715581221e-01 ,
			-1.3502859947402918e-01 ,
			2.0698376590843448e-02 ,
			1.2584673845204788e-01 ,
			7.5979361963327677e-02 ,
			-5.2065125506812915e-02 ,
			-9.9340495169607398e-02 ,
			-1.9375994274479631e-02 ,
			7.3734074958272375e-02 ,
			6.1050418002940150e-02 ,
			-2.8979006327531337e-02 ,
			-7.0035690205542567e-02 ,
			-1.3014245086577609e-02 ,
			5.5030976942061723e-02 ,
			4.0545902573336907e-02 ,
			-2.8082696658478529e-02 ,
			-5.0421390881957857e-02 ,
			-1.7834656757996754e-05 ,
			4.5125492822974823e-02 ,
			2.1825934854468827e-02 ,
			-3.0053224212681997e-02 ,
			-3.3722901951940665e-02 ,
			1.1271393644200866e-02 ,
			3.5431365435583353e-02 ,
			6.0254388777077712e-03 ,
			-2.9032820369749107e-02 ,
			-1.8365835664428589e-02 ,
			1.7836086199393315e-02 ,
			2.4247351654105947e-02 ,
			-5.3436698372127103e-03 ,
			-2.3919138424269258e-02 ,
			-5.5308831743347978e-03 ,
			1.8877344682117301e-02 ,
			1.2918176207598490e-02 ,
			-1.1241945793509300e-02 ,
			-1.6120030679164930e-02 ,
			3.1634775158068049e-03 ,
			1.5470185531616517e-02 ,
			3.6297028820528616e-03 ,
			-1.2015319995270593e-02 ,
			-8.0877471038021970e-03 ,
			7.1258049532141269e-03 ,
			9.8962295266822528e-03 ,
			-2.1322356093256500e-03 ,
			-9.3627724581123416e-03 ,
			-1.9441131165764229e-03 ,
			7.2009863690685938e-03 ,
			4.5314263521835270e-03 ,
			-4.2793203209142480e-03 ,
			-5.5154834009744748e-03 ,
			1.3955917406249388e-03 ,
			5.1484665442471916e-03 ,
			8.7622621642518812e-04 ,
			-3.8995330161913045e-03 ,
			-2.2518533600445283e-03 ,
			2.2932017382367091e-03 ,
			2.7219589883875212e-03 ,
			-7.7854861536424036e-04 ,
			-2.4778211240336200e-03 ,
			-3.5098761756623446e-04 ,
			1.8109138109091163e-03 ,
			9.8024453827756652e-04 ,
			-1.0162695697266276e-03 ,
			-1.1460775274288132e-03 ,
			3.2131491296885509e-04 ,
			9.8339892301504191e-04 ,
			1.4727257793976242e-04 ,
			-6.6105780015931408e-04 ,
			-3.6483672132473876e-04 ,
			3.3149350245799088e-04 ,
			3.8949042799572256e-04 ,
			-1.0531691484516781e-04 ,
			-4.1081214634534669e-04 ,
			-2.9400456671669945e-04 ,
			-3.0054312030186778e-05 ,



			};
			if(*location==2)
				{
				*location=1;
				return 1;
				}
			else if(*location==1)
				{
				for(j=0;j<3;j++)
					{

					datamid=0.0;
					now_fir=i_fir_list;
					for(int i=0;i<firLength;i++)
						{
		
							
							datamid=datamid+now_fir->data[j]*Fir[i];
							
						now_fir=now_fir->last;
						}

					i_result_list->data[j]=datamid;

					}


				i_result_list->utc_nanosecond=i_fir_list->utc_nanosecond-3*(long)((double)(1.0)/200*naomiao);
				if(i_result_list->utc_nanosecond<0)
					{
					i_result_list->utc_nanosecond=i_result_list->utc_nanosecond+naomiao;
					i_result_list->utc_second=i_fir_list->utc_second-1;
					}
				else
					{
					i_result_list->utc_nanosecond=i_result_list->utc_nanosecond;
					i_result_list->utc_second=i_fir_list->utc_second;
					}

				i_result_list->sample_rata=i_fir_list->sample_rata;


				//if(*first_time==1)
				//	{
				//	int i;
				//	for(i=0;i<3;i++)
				//		{


				//		i_result_list->dataV[i]=i_result_list->data[i]/i_result_list->sample_rata/2;
				//		}

				//	}
				//else
				//	{
				//	int i;
				//	for(i=0;i<3;i++)
				//		{


				//		i_result_list->dataV[i]=i_result_list->last->dataV[i]+(i_result_list->data[i]+i_result_list->last->data[i])/i_result_list->sample_rata/2;
				//		}
				//	}

				//if(*first_time==1)
				//	{
				//	int i;
				//	for(i=0;i<3;i++)
				//		{


				//		i_result_list->dataD[i]=i_result_list->dataV[i]/i_result_list->sample_rata/2;
				//		}
				//	*first_time=2;
				//	}
				//else
				//	{
				//	int i;
				//	for(i=0;i<3;i++)
				//		{


				//		i_result_list->dataD[i]=i_result_list->last->dataD[i]+(i_result_list->dataV[i]+i_result_list->last->dataV[i])/i_result_list->sample_rata/2;
				//		}
				//	}

				//if(vector_type==3)
				//	{

				//	i_result_list->data[4]=pow((double)(i_result_list->data[0]*i_result_list->data[0]+i_result_list->data[1]*i_result_list->data[1]+i_result_list->data[2]*i_result_list->data[2]),0.5);
				//	i_result_list->dataV[4]=pow((double)(i_result_list->dataV[0]*i_result_list->dataV[0]+i_result_list->dataV[1]*i_result_list->dataV[1]+i_result_list->dataV[2]*i_result_list->dataV[2]),0.5);
				//	i_result_list->dataD[4]=pow((double)(i_result_list->dataD[0]*i_result_list->dataD[0]+i_result_list->dataD[1]*i_result_list->dataD[1]+i_result_list->dataD[2]*i_result_list->dataD[2]),0.5);
				//	}
				//if(vector_type==2)
				//	{


				//	i_result_list->data[4]=pow((double)(i_result_list->data[0]*i_result_list->data[0]+i_result_list->data[1]*i_result_list->data[1]),0.5);
				//	i_result_list->dataV[4]=pow((double)(i_result_list->dataV[0]*i_result_list->dataV[0]+i_result_list->dataV[1]*i_result_list->dataV[1]),0.5);
				//	i_result_list->dataD[4]=pow((double)(i_result_list->dataD[0]*i_result_list->dataD[0]+i_result_list->dataD[1]*i_result_list->dataD[1]),0.5);
				//	}



					//i_result_list->utc_nanosecond=i_result_list->utc_nanosecond;
					//i_result_list->utc_second=i_fir_list->utc_second;
	

					*location=2;

				return 2;
				}

		}
	else if(i_fir_list->sample_rata==200)
	{

	firLength=67;
	double Fir[67]={1.4886232014446173e-02 ,
		9.1851349273268643e-02 ,
		2.6047741969153282e-01 ,
		4.1903807260132420e-01 ,
		3.6142776267982529e-01 ,
		5.3635129896806445e-02 ,
		-2.0642516820711648e-01 ,
		-1.3417437356981871e-01 ,
		1.0678925914463959e-01 ,
		1.3110904610289847e-01 ,
		-5.9839012834774406e-02 ,
		-1.1374072012772786e-01 ,
		3.9705674742332303e-02 ,
		9.6384227761483060e-02 ,
		-3.2458406593244046e-02 ,
		-8.1183199160868247e-02 ,
		3.1267951742535639e-02 ,
		6.7762677235589527e-02 ,
		-3.2650438666025502e-02 ,
		-5.5485761153308936e-02 ,
		3.4701623144736723e-02 ,
		4.3944728267247365e-02 ,
		-3.6323992075672058e-02 ,
		-3.3010592036806431e-02 ,
		3.6892278052976839e-02 ,
		2.2772355918283766e-02 ,
		-3.6105057284237935e-02 ,
		-1.3452071360375245e-02 ,
		3.3910011588727418e-02 ,
		5.3209414252957284e-03 ,
		-3.0451952421755281e-02 ,
		1.3738116713718546e-03 ,
		2.6022578843828491e-02 ,
		-6.4650955089932127e-03 ,
		-2.1005679046997568e-02 ,
		9.9007348380335033e-03 ,
		1.5819267723627881e-02 ,
		-1.1755090294112168e-02 ,
		-1.0859903710326909e-02 ,
		1.2219248710943006e-02 ,
		6.4563901039831444e-03 ,
		-1.1573208899084366e-02 ,
		-2.8378165457558905e-03 ,
		1.0146498063921651e-02 ,
		1.1824061445429080e-04 ,
		-8.2770293030431132e-03 ,
		1.6979174992666972e-03 ,
		6.2692515917090498e-03 ,
		-2.7016870210823411e-03 ,
		-4.3705580419491942e-03 ,
		3.0429124477103853e-03 ,
		2.7432617781152596e-03 ,
		-2.9141905023914016e-03 ,
		-1.4853585269858490e-03 ,
		2.4863028610634390e-03 ,
		5.9137377630140626e-04 ,
		-1.9525848762372313e-03 ,
		-6.7926205118237323e-05 ,
		1.3731131779887811e-03 ,
		-2.4591351689411063e-04 ,
		-9.5537729526887379e-04 ,
		2.4994144850725840e-04 ,
		4.7279117272521756e-04 ,
		-4.0482925924241020e-04 ,
		-4.6027107085052277e-04 ,
		1.1300349010339446e-04 ,
		2.1569728584449864e-04 ,

		};
	//if(*location==2)
	//	{
	//	*location=1;
	//	return 1;
	//	}
	//else if(*location==1)
	//	{
		for(j=0;j<3;j++)
			{

			datamid=0.0;
			now_fir=i_fir_list;
			for(int i=0;i<firLength;i++)
				{


				datamid=datamid+now_fir->data[j]*Fir[i];

				now_fir=now_fir->last;
				}

			i_result_list->data[j]=datamid;

			}


		i_result_list->utc_nanosecond=i_fir_list->utc_nanosecond-2*(long)((double)(1.0)/200*naomiao);
		if(i_result_list->utc_nanosecond<0)
			{
			i_result_list->utc_nanosecond=i_result_list->utc_nanosecond+naomiao;
			i_result_list->utc_second=i_fir_list->utc_second-1;
			}
		else
			{
			i_result_list->utc_nanosecond=i_result_list->utc_nanosecond;
			i_result_list->utc_second=i_fir_list->utc_second;
			}




		i_result_list->sample_rata=i_fir_list->sample_rata;


		//if(*first_time==1)
		//	{
		//	int i;
		//	for(i=0;i<3;i++)
		//		{


		//		i_result_list->dataV[i]=i_result_list->data[i]/i_result_list->sample_rata/2;
		//		}

		//	}
		//else
		//	{
		//	int i;
		//	for(i=0;i<3;i++)
		//		{


		//		i_result_list->dataV[i]=i_result_list->last->dataV[i]+(i_result_list->data[i]+i_result_list->last->data[i])/i_result_list->sample_rata/2;
		//		}
		//	}

		//if(*first_time==1)
		//	{
		//	int i;
		//	for(i=0;i<3;i++)
		//		{


		//		i_result_list->dataD[i]=i_result_list->dataV[i]/i_result_list->sample_rata/2;
		//		}
		//	*first_time=2;
		//	}
		//else
		//	{
		//	int i;
		//	for(i=0;i<3;i++)
		//		{


		//		i_result_list->dataD[i]=i_result_list->last->dataD[i]+(i_result_list->dataV[i]+i_result_list->last->dataV[i])/i_result_list->sample_rata/2;
		//		}
		//	}

		//if(vector_type==3)
		//	{

		//	i_result_list->data[4]=pow((double)(i_result_list->data[0]*i_result_list->data[0]+i_result_list->data[1]*i_result_list->data[1]+i_result_list->data[2]*i_result_list->data[2]),0.5);
		//	i_result_list->dataV[4]=pow((double)(i_result_list->dataV[0]*i_result_list->dataV[0]+i_result_list->dataV[1]*i_result_list->dataV[1]+i_result_list->dataV[2]*i_result_list->dataV[2]),0.5);
		//	i_result_list->dataD[4]=pow((double)(i_result_list->dataD[0]*i_result_list->dataD[0]+i_result_list->dataD[1]*i_result_list->dataD[1]+i_result_list->dataD[2]*i_result_list->dataD[2]),0.5);
		//	}
		//if(vector_type==2)
		//	{


		//	i_result_list->data[4]=pow((double)(i_result_list->data[0]*i_result_list->data[0]+i_result_list->data[1]*i_result_list->data[1]),0.5);
		//	i_result_list->dataV[4]=pow((double)(i_result_list->dataV[0]*i_result_list->dataV[0]+i_result_list->dataV[1]*i_result_list->dataV[1]),0.5);
		//	i_result_list->dataD[4]=pow((double)(i_result_list->dataD[0]*i_result_list->dataD[0]+i_result_list->dataD[1]*i_result_list->dataD[1]),0.5);
		//	}



		//i_result_list->utc_nanosecond=i_result_list->utc_nanosecond;
		//i_result_list->utc_second=i_fir_list->utc_second;


		//*location=2;

		return 2;
		

		}

	return 0;

	};




int PGA_V_G_11_11(FIR_LIST *i_fir_list,BAND_PASS_RESULT *band_pass_data,int *count,int timespan,int *trig,int PGV_type,int band_pass_flag)
	{
	//·µ»Ø    1 ÆÕÍ¨·µ»Ø
	//·µ»Ø    2 ´¥·¢¹ý³ÌÖÐÈ¡PGV PGD µÈÁ¿±êÊ¶




	// *trig  0 Î´´¥·¢Ê±¼ä¼ä¸ô¿ªÊ¼
	//        3 Î´´¥·¢ÆÚ¼ä
	//        1 ´¥·¢ÆðÊ¼µã
	//        2 ´¥·¢¹ý³ÌÖÐ

	int firLength,j,jjj,iii;
	double datamid;
	FIR_LIST *now_fir;
	int i_sample_rata=i_fir_list->sample_rata;
	if (i_fir_list->sample_rata==50&&band_pass_flag==0)
		{
		firLength=81;
		double Fir[81]={-4.7987787339820936e-04,
			-8.9057350076593368e-04,
			-7.2903341056485352e-04,
			-9.3968046651590189e-04,
			-2.0015152670250906e-03,
			-1.8457782153191327e-03,
			-1.4331943313841396e-03,
			-3.2987790655067970e-03,
			-3.9188767708761094e-03,
			-2.2358326021832526e-03,
			-4.2761095213556272e-03,
			-6.9685597648698229e-03,
			-4.0562398557881119e-03,
			-4.5086713435378723e-03,
			-1.0324010165847381e-02,
			-7.7980789590883538e-03,
			-4.2123548102063557e-03,
			-1.2580685653923828e-02,
			-1.3896183105007932e-02,
			-4.6707793854684938e-03,
			-1.2139776287417038e-02,
			-2.1492365469531257e-02,
			-8.0968892823001046e-03,
			-8.2631555848332473e-03,
			-2.7966602054323594e-02,
			-1.6735759731169867e-02,
			-2.1834926757662077e-03,
			-2.9254096192636532e-02,
			-3.1499163705017090e-02,
			2.3107659525776346e-03,
			-2.0832464828927390e-02,
			-5.0853889965031082e-02,
			-1.1624388651572256e-03,
			1.8841462457617236e-03,
			-7.0730297852423088e-02,
			-2.3669862992490260e-02,
			4.9655253129437991e-02,
			-8.5754335252881606e-02,
			-1.1745446174509039e-01,
			2.7761355362248835e-01,
			5.7538029520670841e-01,
			2.7761355362248769e-01,
			-1.1745446174508975e-01,
			-8.5754335252880912e-02,
			4.9655253129437457e-02,
			-2.3669862992489934e-02,
			-7.0730297852421936e-02,
			1.8841462457616889e-03,
			-1.1624388651572048e-03,
			-5.0853889965029819e-02,
			-2.0832464828926815e-02,
			2.3107659525775617e-03,
			-3.1499163705016028e-02,
			-2.9254096192635470e-02,
			-2.1834926757661245e-03,
			-1.6735759731169159e-02,
			-2.7966602054322321e-02,
			-8.2631555848328413e-03,
			-8.0968892822996814e-03,
			-2.1492365469530057e-02,
			-1.2139776287416327e-02,
			-4.6707793854682024e-03,
			-1.3896183105007011e-02,
			-1.2580685653922945e-02,
			-4.2123548102060435e-03,
			-7.7980789590877501e-03,
			-1.0324010165846531e-02,
			-4.5086713435374846e-03,
			-4.0562398557877433e-03,
			-6.9685597648691568e-03,
			-4.2761095213552005e-03,
			-2.2358326021830158e-03,
			-3.9188767708756775e-03,
			-3.2987790655064630e-03,
			-1.4331943313839600e-03,
			-1.8457782153188935e-03,
			-2.0015152670248100e-03,
			-9.3968046651576485e-04,
			-7.2903341056474108e-04,
			-8.9057350076577387e-04,
			-4.7987787339812745e-04,
			};
		if(*trig==1||*trig==2)
			{
			//if(PGV_type==1)
			//	{
			//	datamid=0.0;
			//	now_fir=i_fir_list;
			//	for(int i=0;i<firLength;i++)
			//		{
			//		datamid=datamid+now_fir->dataV[4]*Fir[i];
			//		now_fir=now_fir->last;
			//		}
			//	i_fir_list->band_pass_dataV[4]=datamid;



			//	datamid=0.0;
			//	now_fir=i_fir_list;
			//	for(int i=0;i<firLength;i++)
			//		{
			//		datamid=datamid+now_fir->dataD[4]*Fir[i];
			//		now_fir=now_fir->last;
			//		}
			//	i_fir_list->band_pass_dataD[4]=datamid;

			//	}
			//else if(PGV_type==2)
			//	{
			//	for(int j=0;j<3;j++)
			//		{


			//		datamid=0.0;
			//		now_fir=i_fir_list;
			//		for(int i=0;i<firLength;i++)
			//			{
			//			datamid=datamid+now_fir->dataV[j]*Fir[i];
			//			now_fir=now_fir->last;
			//			}
			//		i_fir_list->band_pass_dataV[j]=datamid;

			//		}
			//	i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
			//	for(int j=0;j<3;j++)
			//		{


			//		datamid=0.0;
			//		now_fir=i_fir_list;
			//		for(int i=0;i<firLength;i++)
			//			{
			//			datamid=datamid+now_fir->dataD[j]*Fir[i];
			//			now_fir=now_fir->last;
			//			}
			//		i_fir_list->band_pass_dataD[j]=datamid;
			//		}
			//	i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
			//	}

			if(*trig==1)
				{
				for(jjj=0;jjj<3;jjj++)
					{
					band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
					band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
					band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);
					}
				band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
				band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
				band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
				now_fir=i_fir_list->last;
				for(iii=1;iii<i_sample_rata*3;iii++)
					{
					for(jjj=0;jjj<3;jjj++)
						{
						if(abs(now_fir->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
							band_pass_data->final_PGA_component[jjj]=abs(now_fir->band_pass_data[jjj]);
						if(abs(now_fir->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
							band_pass_data->final_PGV_component[jjj]=abs(now_fir->band_pass_dataV[jjj]);
						if(abs(now_fir->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
							band_pass_data->final_PGD_component[jjj]=abs(now_fir->band_pass_dataD[jjj]);
						}

					if(now_fir->band_pass_data[4]>band_pass_data->final_PGA)
						{
						band_pass_data->final_PGA=now_fir->band_pass_data[4];
						band_pass_data->utc_second_final_PGA=now_fir->utc_second; //utcÊ±¼äÃë
						band_pass_data->utc_nanosecond_final_PGA=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë

						}
					//else
					//	{
					//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
					//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utcÊ±¼äÃë
					//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
					//	}
					if(now_fir->band_pass_dataV[4]>band_pass_data->final_PGV)
						{
						band_pass_data->final_PGV=now_fir->band_pass_dataV[4];
						band_pass_data->utc_second_final_PGV=now_fir->utc_second; //utcÊ±¼äÃë
						band_pass_data->utc_nanosecond_final_PGV=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
						}
					//else
					//	{
					//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
					//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utcÊ±¼äÃë
					//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
					//	}
					if(now_fir->band_pass_dataD[4]>band_pass_data->final_PGD)
						{
						band_pass_data->final_PGD=now_fir->band_pass_dataD[4];
						band_pass_data->utc_second_final_PGD=now_fir->utc_second; //utcÊ±¼äÃë
						band_pass_data->utc_nanosecond_final_PGD=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
						}

					now_fir=now_fir->last;

					}

				*count=2;
				*trig=2;
				}
			else
				{

				for(jjj=0;jjj<3;jjj++)
					{
					if(abs(i_fir_list->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
						band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
					if(abs(i_fir_list->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
						band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
					if(abs(i_fir_list->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
						band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);

					}

				if(i_fir_list->band_pass_data[4]>band_pass_data->final_PGA)
					{
					band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
					band_pass_data->utc_second_final_PGA=i_fir_list->utc_second; //utcÊ±¼äÃë
					band_pass_data->utc_nanosecond_final_PGA=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë

					}
				//else
				//	{
				//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
				//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utcÊ±¼äÃë
				//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
				//	}
				if(i_fir_list->band_pass_dataV[4]>band_pass_data->final_PGV)
					{
					band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
					band_pass_data->utc_second_final_PGV=i_fir_list->utc_second; //utcÊ±¼äÃë
					band_pass_data->utc_nanosecond_final_PGV=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
					}
				//else
				//	{
				//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
				//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utcÊ±¼äÃë
				//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
				//	}
				if(i_fir_list->band_pass_dataD[4]>band_pass_data->final_PGD)
					{
					band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
					band_pass_data->utc_second_final_PGD=i_fir_list->utc_second; //utcÊ±¼äÃë
					band_pass_data->utc_nanosecond_final_PGD=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
					}
				//else
				//	{
				//	band_pass_data->final_PGD=i_fir_list->last->final_PGD;
				//	band_pass_data->utc_second_final_PGD=i_fir_list->last->utc_second; //utcÊ±¼äÃë
				//	band_pass_data->utc_nanosecond_final_PGD=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
				//	}
				if(*count==timespan*50)

					{
					*count=1;
					return 2;
					}
				else
					{


					*count+=1;
					}

				}
			}
			else
				{
				if(*trig==0)
					{
					

				for(jjj=0;jjj<3;jjj++)
					{
					band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
					band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
					band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);
					}
				band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
				band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
				band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
				//now_fir=i_fir_list->last;
				//for(iii=1;iii<i_sample_rata*3;iii++)
				//	{
				//	for(jjj=0;jjj<3;jjj++)
				//		{
				//		if(abs(now_fir->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
				//			band_pass_data->final_PGA_component[jjj]=abs(now_fir->band_pass_data[jjj]);
				//		if(abs(now_fir->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
				//			band_pass_data->final_PGV_component[jjj]=abs(now_fir->band_pass_dataV[jjj]);
				//		if(abs(now_fir->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
				//			band_pass_data->final_PGD_component[jjj]=abs(now_fir->band_pass_dataD[jjj]);
				//		}

				//	if(now_fir->band_pass_data[4]>band_pass_data->final_PGA)
				//		{
				//		band_pass_data->final_PGA=now_fir->band_pass_data[4];
				//		band_pass_data->utc_second_final_PGA=now_fir->utc_second; //utcÊ±¼äÃë
				//		band_pass_data->utc_nanosecond_final_PGA=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë

				//		}
				//	//else
				//	//	{
				//	//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
				//	//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utcÊ±¼äÃë
				//	//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
				//	//	}
				//	if(now_fir->band_pass_dataV[4]>band_pass_data->final_PGV)
				//		{
				//		band_pass_data->final_PGV=now_fir->band_pass_dataV[4];
				//		band_pass_data->utc_second_final_PGV=now_fir->utc_second; //utcÊ±¼äÃë
				//		band_pass_data->utc_nanosecond_final_PGV=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
				//		}
				//	//else
				//	//	{
				//	//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
				//	//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utcÊ±¼äÃë
				//	//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
				//	//	}
				//	if(now_fir->band_pass_dataD[4]>band_pass_data->final_PGD)
				//		{
				//		band_pass_data->final_PGD=now_fir->band_pass_dataD[4];
				//		band_pass_data->utc_second_final_PGD=now_fir->utc_second; //utcÊ±¼äÃë
				//		band_pass_data->utc_nanosecond_final_PGD=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
				//		}

				//	now_fir=now_fir=now_fir->last;



				//	}

				*count=2;
				/**count+=1;*/
				*trig=3;

					}
				else if(*trig==3)
					{
					for(jjj=0;jjj<3;jjj++)
						{
						if(abs(i_fir_list->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
							band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
						if(abs(i_fir_list->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
							band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
						if(abs(i_fir_list->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
							band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);

						}

					if(i_fir_list->band_pass_data[4]>band_pass_data->final_PGA)
						{
						band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
						band_pass_data->utc_second_final_PGA=i_fir_list->utc_second; //utcÊ±¼äÃë
						band_pass_data->utc_nanosecond_final_PGA=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë

						}
					//else
					//	{
					//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
					//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utcÊ±¼äÃë
					//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
					//	}
					if(i_fir_list->band_pass_dataV[4]>band_pass_data->final_PGV)
						{
						band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
						band_pass_data->utc_second_final_PGV=i_fir_list->utc_second; //utcÊ±¼äÃë
						band_pass_data->utc_nanosecond_final_PGV=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
						}
					//else
					//	{
					//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
					//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utcÊ±¼äÃë
					//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
					//	}
					if(i_fir_list->band_pass_dataD[4]>band_pass_data->final_PGD)
						{
						band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
						band_pass_data->utc_second_final_PGD=i_fir_list->utc_second; //utcÊ±¼äÃë
						band_pass_data->utc_nanosecond_final_PGD=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
						}
					//else
					//	{
					//	band_pass_data->final_PGD=i_fir_list->last->final_PGD;
					//	band_pass_data->utc_second_final_PGD=i_fir_list->last->utc_second; //utcÊ±¼äÃë
					//	band_pass_data->utc_nanosecond_final_PGD=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
					//	}
					if(*count==timespan*50)
						{
						*count=1;
						*trig=0;
						return 3;

						}
					else
						{

						*count+=1;
						}

					}

				}
		return 1;
		}
	else if (i_fir_list->sample_rata==50&&band_pass_flag==1)
			{
			firLength=151;
			double Fir[151]={-2.8052426906829513e-03,
				-4.2393366582970269e-03,
				-3.8887138369385330e-03,
				-2.2354116003412555e-03,
				-1.7151340451976370e-03,
				-3.3681835107814504e-03,
				-5.1779067586189562e-03,
				-4.6965135173902524e-03,
				-2.5638580821051682e-03,
				-1.8818136148366425e-03,
				-3.9473893023176630e-03,
				-6.1968403681345145e-03,
				-5.5591924712764754e-03,
				-2.8602285633303683e-03,
				-1.9855715179514558e-03,
				-4.5343773820232715e-03,
				-7.2993746523036347e-03,
				-6.4757972766725895e-03,
				-3.1075377181290190e-03,
				-2.0034515060087738e-03,
				-5.1201983246674521e-03,
				-8.4924282172401180e-03,
				-7.4477448916228876e-03,
				-3.2854307785719003e-03,
				-1.9068638995382889e-03,
				-5.6956197214221181e-03,
				-9.7890130188554095e-03,
				-8.4805326328304762e-03,
				-3.3686880184671422e-03,
				-1.6587501518070553e-03,
				-6.2513201008398845e-03,
				-1.1212180130190147e-02,
				-9.5865220664507079e-03,
				-3.3245287368907092e-03,
				-1.2085331900947341e-03,
				-6.7780883098406538e-03,
				-1.2801858768458711e-02,
				-1.0789770869833983e-02,
				-3.1075700373275851e-03,
				-4.8269424897207818e-04,
				-7.2670234585519751e-03,
				-1.4627552535563389e-02,
				-1.2135072981765502e-02,
				-2.6498708200075548e-03,
				6.3396297658225372e-04,
				-7.7097304696529074e-03,
				-1.6813951744110978e-02,
				-1.3706460562373948e-02,
				-1.8396919533613628e-03,
				2.3388911427624061e-03,
				-8.0985063426770101e-03,
				-1.9598293978969096e-02,
				-1.5669566680424962e-02,
				-4.7103250693004398e-04,
				5.0106092712312988e-03,
				-8.4265124453908481e-03,
				-2.3477962536707364e-02,
				-1.8384256507005932e-02,
				1.8961989182070325e-03,
				9.4930912865623281e-03,
				-8.6879284730553841e-03,
				-2.9673940083844816e-02,
				-2.2776743005803374e-02,
				6.4259738795488016e-03,
				1.8156146307088068e-02,
				-8.8780841635862553e-03,
				-4.2138499851260856e-02,
				-3.2106505797306333e-02,
				1.7595589150292312e-02,
				4.1258267838167328e-02,
				-8.9935654105577235e-03,
				-8.4619383336774115e-02,
				-7.1400968296348372e-02,
				8.4628282316732584e-02,
				2.9419739638965176e-01,
				3.9169381130492797e-01,
				2.9419739638965176e-01,
				8.4628282316732584e-02,
				-7.1400968296348372e-02,
				-8.4619383336774115e-02,
				-8.9935654105577252e-03,
				4.1258267838167349e-02,
				1.7595589150292319e-02,
				-3.2106505797306346e-02,
				-4.2138499851260863e-02,
				-8.8780841635862588e-03,
				1.8156146307088072e-02,
				6.4259738795488016e-03,
				-2.2776743005803384e-02,
				-2.9673940083844830e-02,
				-8.6879284730553893e-03,
				9.4930912865623333e-03,
				1.8961989182070343e-03,
				-1.8384256507005946e-02,
				-2.3477962536707378e-02,
				-8.4265124453908533e-03,
				5.0106092712313005e-03,
				-4.7103250693004398e-04,
				-1.5669566680424969e-02,
				-1.9598293978969110e-02,
				-8.0985063426770188e-03,
				2.3388911427624079e-03,
				-1.8396919533613663e-03,
				-1.3706460562373958e-02,
				-1.6813951744110992e-02,
				-7.7097304696529126e-03,
				6.3396297658225372e-04,
				-2.6498708200075574e-03,
				-1.2135072981765515e-02,
				-1.4627552535563406e-02,
				-7.2670234585519829e-03,
				-4.8269424897207731e-04,
				-3.1075700373275877e-03,
				-1.0789770869833994e-02,
				-1.2801858768458723e-02,
				-6.7780883098406616e-03,
				-1.2085331900947350e-03,
				-3.3245287368907140e-03,
				-9.5865220664507183e-03,
				-1.1212180130190158e-02,
				-6.2513201008398932e-03,
				-1.6587501518070587e-03,
				-3.3686880184671461e-03,
				-8.4805326328304884e-03,
				-9.7890130188554234e-03,
				-5.6956197214221250e-03,
				-1.9068638995382910e-03,
				-3.2854307785719064e-03,
				-7.4477448916228997e-03,
				-8.4924282172401319e-03,
				-5.1201983246674599e-03,
				-2.0034515060087777e-03,
				-3.1075377181290238e-03,
				-6.4757972766725999e-03,
				-7.2993746523036451e-03,
				-4.5343773820232776e-03,
				-1.9855715179514588e-03,
				-2.8602285633303726e-03,
				-5.5591924712764867e-03,
				-6.1968403681345232e-03,
				-3.9473893023176700e-03,
				-1.8818136148366458e-03,
				-2.5638580821051716e-03,
				-4.6965135173902611e-03,
				-5.1779067586189640e-03,
				-3.3681835107814543e-03,
				-1.7151340451976407e-03,
				-2.2354116003412351e-03,
				-3.8887138369385656e-03,
				-4.2393366582969870e-03,
				-2.8052426906829439e-03,
				};
			if(*trig==1||*trig==2)
				{
				//if(PGV_type==1)
				//	{
				//	datamid=0.0;
				//	now_fir=i_fir_list;
				//	for(int i=0;i<firLength;i++)
				//		{
				//		datamid=datamid+now_fir->dataV[4]*Fir[i];
				//		now_fir=now_fir->last;
				//		}
				//	i_fir_list->band_pass_dataV[4]=datamid;



				//	datamid=0.0;
				//	now_fir=i_fir_list;
				//	for(int i=0;i<firLength;i++)
				//		{
				//		datamid=datamid+now_fir->dataD[4]*Fir[i];
				//		now_fir=now_fir->last;
				//		}
				//	i_fir_list->band_pass_dataD[4]=datamid;

				//	}
				//else if(PGV_type==2)
				//	{
				//	for(int j=0;j<3;j++)
				//		{


				//		datamid=0.0;
				//		now_fir=i_fir_list;
				//		for(int i=0;i<firLength;i++)
				//			{
				//			datamid=datamid+now_fir->dataV[j]*Fir[i];
				//			now_fir=now_fir->last;
				//			}
				//		i_fir_list->band_pass_dataV[j]=datamid;

				//		}
				//	i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
				//	for(int j=0;j<3;j++)
				//		{


				//		datamid=0.0;
				//		now_fir=i_fir_list;
				//		for(int i=0;i<firLength;i++)
				//			{
				//			datamid=datamid+now_fir->dataD[j]*Fir[i];
				//			now_fir=now_fir->last;
				//			}
				//		i_fir_list->band_pass_dataD[j]=datamid;
				//		}
				//	i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
				//	}




				if(*trig==1)
					{
					for(jjj=0;jjj<3;jjj++)
						{
						band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
						band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
						band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);
						}
					band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
					band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
					band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];

					now_fir=i_fir_list->last;
					for(iii=1;iii<i_sample_rata*3;iii++)
						{
						for(jjj=0;jjj<3;jjj++)
							{
							if(abs(now_fir->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
								band_pass_data->final_PGA_component[jjj]=abs(now_fir->band_pass_data[jjj]);
							if(abs(now_fir->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
								band_pass_data->final_PGV_component[jjj]=abs(now_fir->band_pass_dataV[jjj]);
							if(abs(now_fir->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
								band_pass_data->final_PGD_component[jjj]=abs(now_fir->band_pass_dataD[jjj]);

							}
						if(now_fir->band_pass_data[4]>band_pass_data->final_PGA)
							{
							band_pass_data->final_PGA=now_fir->band_pass_data[4];
							band_pass_data->utc_second_final_PGA=now_fir->utc_second; //utcÊ±¼äÃë
							band_pass_data->utc_nanosecond_final_PGA=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë

							}
						//else
						//	{
						//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
						//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utcÊ±¼äÃë
						//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
						//	}
						if(now_fir->band_pass_dataV[4]>band_pass_data->final_PGV)
							{
							band_pass_data->final_PGV=now_fir->band_pass_dataV[4];
							band_pass_data->utc_second_final_PGV=now_fir->utc_second; //utcÊ±¼äÃë
							band_pass_data->utc_nanosecond_final_PGV=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
							}
						//else
						//	{
						//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
						//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utcÊ±¼äÃë
						//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
						//	}
						if(now_fir->band_pass_dataD[4]>band_pass_data->final_PGD)
							{
							band_pass_data->final_PGD=now_fir->band_pass_dataD[4];
							band_pass_data->utc_second_final_PGD=now_fir->utc_second; //utcÊ±¼äÃë
							band_pass_data->utc_nanosecond_final_PGD=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
							}

						now_fir=now_fir->last;



						}





					*count=2;
					*trig=2;
					}
				else
					{
					for(jjj=0;jjj<3;jjj++)
						{
						if(abs(i_fir_list->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
							band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
						if(abs(i_fir_list->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
							band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
						if(abs(i_fir_list->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
							band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);
						}




					if(i_fir_list->band_pass_data[4]>band_pass_data->final_PGA)
						{
						band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
						band_pass_data->utc_second_final_PGA=i_fir_list->utc_second; //utcÊ±¼äÃë
						band_pass_data->utc_nanosecond_final_PGA=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë

						}
					//else
					//	{
					//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
					//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utcÊ±¼äÃë
					//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
					//	}
					if(i_fir_list->band_pass_dataV[4]>band_pass_data->final_PGV)
						{
						band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
						band_pass_data->utc_second_final_PGV=i_fir_list->utc_second; //utcÊ±¼äÃë
						band_pass_data->utc_nanosecond_final_PGV=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
						}
					//else
					//	{
					//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
					//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utcÊ±¼äÃë
					//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
					//	}
					if(i_fir_list->band_pass_dataD[4]>band_pass_data->final_PGD)
						{
						band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
						band_pass_data->utc_second_final_PGD=i_fir_list->utc_second; //utcÊ±¼äÃë
						band_pass_data->utc_nanosecond_final_PGD=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
						}
					//else
					//	{
					//	band_pass_data->final_PGD=i_fir_list->last->final_PGD;
					//	band_pass_data->utc_second_final_PGD=i_fir_list->last->utc_second; //utcÊ±¼äÃë
					//	band_pass_data->utc_nanosecond_final_PGD=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
					//	}
					if(*count==timespan*50)

						{
						*count=1;
						return 2;
						}
					else
						{


						*count+=1;
						}



					}
				}
			else
								{
								if(*trig==0)
									{


									for(jjj=0;jjj<3;jjj++)
										{
										band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
										band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
										band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);
										}
									band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
									band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
									band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
									//now_fir=i_fir_list->last;
									//for(iii=1;iii<i_sample_rata*3;iii++)
									//	{
									//	for(jjj=0;jjj<3;jjj++)
									//		{
									//		if(abs(now_fir->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
									//			band_pass_data->final_PGA_component[jjj]=abs(now_fir->band_pass_data[jjj]);
									//		if(abs(now_fir->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
									//			band_pass_data->final_PGV_component[jjj]=abs(now_fir->band_pass_dataV[jjj]);
									//		if(abs(now_fir->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
									//			band_pass_data->final_PGD_component[jjj]=abs(now_fir->band_pass_dataD[jjj]);
									//		}

									//	if(now_fir->band_pass_data[4]>band_pass_data->final_PGA)
									//		{
									//		band_pass_data->final_PGA=now_fir->band_pass_data[4];
									//		band_pass_data->utc_second_final_PGA=now_fir->utc_second; //utcÊ±¼äÃë
									//		band_pass_data->utc_nanosecond_final_PGA=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë

									//		}
									//	//else
									//	//	{
									//	//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
									//	//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utcÊ±¼äÃë
									//	//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
									//	//	}
									//	if(now_fir->band_pass_dataV[4]>band_pass_data->final_PGV)
									//		{
									//		band_pass_data->final_PGV=now_fir->band_pass_dataV[4];
									//		band_pass_data->utc_second_final_PGV=now_fir->utc_second; //utcÊ±¼äÃë
									//		band_pass_data->utc_nanosecond_final_PGV=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
									//		}
									//	//else
									//	//	{
									//	//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
									//	//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utcÊ±¼äÃë
									//	//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
									//	//	}
									//	if(now_fir->band_pass_dataD[4]>band_pass_data->final_PGD)
									//		{
									//		band_pass_data->final_PGD=now_fir->band_pass_dataD[4];
									//		band_pass_data->utc_second_final_PGD=now_fir->utc_second; //utcÊ±¼äÃë
									//		band_pass_data->utc_nanosecond_final_PGD=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
									//		}

									//	now_fir=now_fir=now_fir->last;



									//	}


									*count=2;
									*trig=3;

									}
								else if(*trig==3)
									{
									for(jjj=0;jjj<3;jjj++)
										{
										if(abs(i_fir_list->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
											band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
										if(abs(i_fir_list->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
											band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
										if(abs(i_fir_list->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
											band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);

										}

									if(i_fir_list->band_pass_data[4]>band_pass_data->final_PGA)
										{
										band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
										band_pass_data->utc_second_final_PGA=i_fir_list->utc_second; //utcÊ±¼äÃë
										band_pass_data->utc_nanosecond_final_PGA=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë

										}
									//else
									//	{
									//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
									//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utcÊ±¼äÃë
									//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
									//	}
									if(i_fir_list->band_pass_dataV[4]>band_pass_data->final_PGV)
										{
										band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
										band_pass_data->utc_second_final_PGV=i_fir_list->utc_second; //utcÊ±¼äÃë
										band_pass_data->utc_nanosecond_final_PGV=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
										}
									//else
									//	{
									//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
									//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utcÊ±¼äÃë
									//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
									//	}
									if(i_fir_list->band_pass_dataD[4]>band_pass_data->final_PGD)
										{
										band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
										band_pass_data->utc_second_final_PGD=i_fir_list->utc_second; //utcÊ±¼äÃë
										band_pass_data->utc_nanosecond_final_PGD=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
										}
									//else
									//	{
									//	band_pass_data->final_PGD=i_fir_list->last->final_PGD;
									//	band_pass_data->utc_second_final_PGD=i_fir_list->last->utc_second; //utcÊ±¼äÃë
									//	band_pass_data->utc_nanosecond_final_PGD=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
									//	}
									if(*count==timespan*50)
										{
										*count=1;
										*trig=0;
										return 3;

										}
									else
										{

										*count+=1;
										}

									}

				}
			return 1;
			}
	else if(i_fir_list->sample_rata==100&&band_pass_flag==0)
		{
		firLength=191;
		double Fir[191]={-1.0096108503799409e-03,
			-1.3950482601184145e-03,
			-2.2527488512072823e-03,
			-2.9478325266950626e-03,
			-2.9241282941009309e-03,
			-2.1964877583498382e-03,
			-1.3932186866449717e-03,
			-1.2683702309322061e-03,
			-2.0587294816955936e-03,
			-3.2307108495224480e-03,
			-3.8728518839418980e-03,
			-3.4512139742405856e-03,
			-2.3045215990983815e-03,
			-1.4270997345429326e-03,
			-1.6661388536950924e-03,
			-2.9780040916341042e-03,
			-4.3915096269727697e-03,
			-4.7685469089617048e-03,
			-3.7708238360917514e-03,
			-2.2154696854772564e-03,
			-1.4639880273141859e-03,
			-2.2943598211664952e-03,
			-4.1868456476722750e-03,
			-5.6701595913976281e-03,
			-5.5118721440431517e-03,
			-3.7942060764075075e-03,
			-1.9423711063670419e-03,
			-1.6026343679009464e-03,
			-3.2475373165740244e-03,
			-5.6846723133800129e-03,
			-6.9564131921419870e-03,
			-5.9605784961465312e-03,
			-3.4555395583318526e-03,
			-1.5446848893690436e-03,
			-1.9729728155626920e-03,
			-4.6090756549750133e-03,
			-7.4249335517157806e-03,
			-8.0957173947760943e-03,
			-5.9658402480322953e-03,
			-2.7259882160986819e-03,
			-1.1326443571281007e-03,
			-2.7279163951726233e-03,
			-6.4379538633729206e-03,
			-9.3078652451388747e-03,
			-8.8937043531173623e-03,
			-5.3843686320969916e-03,
			-1.6236386602042371e-03,
			-8.6795329695463013e-04,
			-4.0358532878403434e-03,
			-8.7602540790057502e-03,
			-1.1177665546498936e-02,
			-9.1197841612625230e-03,
			-4.0841129832286773e-03,
			-2.1710181588843413e-04,
			-9.6506787169073674e-04,
			-6.0820299780298100e-03,
			-1.1571060989487639e-02,
			-1.2821283663388564e-02,
			-8.4992305065876590e-03,
			-1.9327687604891049e-03,
			1.3784923032710335e-03,
			-1.7050246429269466e-03,
			-9.0969663617697753e-03,
			-1.4856515017832844e-02,
			-1.3958829431456619e-02,
			-6.6666698386317613e-03,
			1.2562792472859616e-03,
			3.0131140370235859e-03,
			-3.4963797956000272e-03,
			-1.3462418900154581e-02,
			-1.8662168940531118e-02,
			-1.4193048970612182e-02,
			-2.9949266075571710e-03,
			5.9029683387124953e-03,
			4.5197236235567867e-03,
			-7.1079148261703534e-03,
			-2.0084767678293092e-02,
			-2.3311188040322776e-02,
			-1.2784038623879721e-02,
			4.0762178712041601e-03,
			1.3346915816899603e-02,
			5.7359043739684543e-03,
			-1.4720837908786619e-02,
			-3.2099574332974203e-02,
			-3.0404413640455791e-02,
			-7.3824560015768315e-03,
			2.0903522723558492e-02,
			3.0096061155356627e-02,
			6.5259347250955285e-03,
			-3.8462292200619481e-02,
			-7.0869487224785352e-02,
			-5.4107874682352952e-02,
			2.5259979404526650e-02,
			1.4370865641013861e-01,
			2.4982563870147181e-01,
			2.9230819959096299e-01,
			2.4982563870147181e-01,
			1.4370865641013864e-01,
			2.5259979404526654e-02,
			-5.4107874682352966e-02,
			-7.0869487224785366e-02,
			-3.8462292200619495e-02,
			6.5259347250955302e-03,
			3.0096061155356641e-02,
			2.0903522723558506e-02,
			-7.3824560015768349e-03,
			-3.0404413640455815e-02,
			-3.2099574332974223e-02,
			-1.4720837908786630e-02,
			5.7359043739684604e-03,
			1.3346915816899613e-02,
			4.0762178712041627e-03,
			-1.2784038623879739e-02,
			-2.3311188040322804e-02,
			-2.0084767678293116e-02,
			-7.1079148261703612e-03,
			4.5197236235567911e-03,
			5.9029683387125048e-03,
			-2.9949266075571736e-03,
			-1.4193048970612207e-02,
			-1.8662168940531153e-02,
			-1.3462418900154604e-02,
			-3.4963797956000320e-03,
			3.0131140370235911e-03,
			1.2562792472859642e-03,
			-6.6666698386317743e-03,
			-1.3958829431456649e-02,
			-1.4856515017832875e-02,
			-9.0969663617697927e-03,
			-1.7050246429269492e-03,
			1.3784923032710370e-03,
			-1.9327687604891093e-03,
			-8.4992305065876780e-03,
			-1.2821283663388595e-02,
			-1.1571060989487670e-02,
			-6.0820299780298256e-03,
			-9.6506787169073935e-04,
			-2.1710181588843587e-04,
			-4.0841129832286877e-03,
			-9.1197841612625508e-03,
			-1.1177665546498967e-02,
			-8.7602540790057779e-03,
			-4.0358532878403556e-03,
			-8.6795329695463187e-04,
			-1.6236386602042424e-03,
			-5.3843686320970089e-03,
			-8.8937043531173883e-03,
			-9.3078652451389042e-03,
			-6.4379538633729406e-03,
			-2.7279163951726333e-03,
			-1.1326443571281050e-03,
			-2.7259882160986914e-03,
			-5.9658402480323187e-03,
			-8.0957173947761238e-03,
			-7.4249335517158083e-03,
			-4.6090756549750297e-03,
			-1.9729728155626998e-03,
			-1.5446848893690497e-03,
			-3.4555395583318661e-03,
			-5.9605784961465555e-03,
			-6.9564131921420139e-03,
			-5.6846723133800337e-03,
			-3.2475373165740378e-03,
			-1.6026343679009538e-03,
			-1.9423711063670500e-03,
			-3.7942060764075232e-03,
			-5.5118721440431751e-03,
			-5.6701595913976532e-03,
			-4.1868456476722923e-03,
			-2.2943598211665065e-03,
			-1.4639880273141920e-03,
			-2.2154696854772668e-03,
			-3.7708238360917696e-03,
			-4.7685469089617273e-03,
			-4.3915096269727888e-03,
			-2.9780040916341185e-03,
			-1.6661388536951005e-03,
			-1.4270997345429397e-03,
			-2.3045215990983915e-03,
			-3.4512139742406017e-03,
			-3.8728518839419141e-03,
			-3.2307108495224631e-03,
			-2.0587294816956044e-03,
			-1.2683702309322122e-03,
			-1.3932186866449782e-03,
			-2.1964877583498486e-03,
			-2.9241282941009409e-03,
			-2.9478325266950032e-03,
			-2.2527488512072988e-03,
			-1.3950482601184288e-03,
			-1.0096108503799466e-03,



			};
		if(*trig==1||*trig==2)
			{


			//if(PGV_type==1)
			//	{
			//	datamid=0.0;
			//	now_fir=i_fir_list;
			//	for(int i=0;i<firLength;i++)
			//		{
			//		datamid=datamid+now_fir->dataV[4]*Fir[i];
			//		now_fir=now_fir->last;
			//		}
			//	i_fir_list->band_pass_dataV[4]=datamid;



			//	datamid=0.0;
			//	now_fir=i_fir_list;
			//	for(int i=0;i<firLength;i++)
			//		{
			//		datamid=datamid+now_fir->dataD[4]*Fir[i];
			//		now_fir=now_fir->last;
			//		}
			//	i_fir_list->band_pass_dataD[4]=datamid;

			//	}
			//else if(PGV_type==2)
			//	{
			//	for(int j=0;j<3;j++)
			//		{


			//		datamid=0.0;
			//		now_fir=i_fir_list;
			//		for(int i=0;i<firLength;i++)
			//			{
			//			datamid=datamid+now_fir->dataV[j]*Fir[i];
			//			now_fir=now_fir->last;
			//			}
			//		i_fir_list->band_pass_dataV[j]=datamid;

			//		}
			//	i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
			//	for(int j=0;j<3;j++)
			//		{


			//		datamid=0.0;
			//		now_fir=i_fir_list;
			//		for(int i=0;i<firLength;i++)
			//			{
			//			datamid=datamid+now_fir->dataD[j]*Fir[i];
			//			now_fir=now_fir->last;
			//			}
			//		i_fir_list->band_pass_dataD[j]=datamid;
			//		}
			//	i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
			//	}

			if(*trig==1)
				{
				for(jjj=0;jjj<3;jjj++)
					{
					band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
					band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
					band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);
					}
				band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
				band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
				band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];

				now_fir=i_fir_list->last;
				for(iii=1;iii<i_sample_rata*3;iii++)
					{
					for(jjj=0;jjj<3;jjj++)
						{
						if(abs(now_fir->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
							band_pass_data->final_PGA_component[jjj]=abs(now_fir->band_pass_data[jjj]);
						if(abs(now_fir->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
							band_pass_data->final_PGV_component[jjj]=abs(now_fir->band_pass_dataV[jjj]);
						if(abs(now_fir->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
							band_pass_data->final_PGD_component[jjj]=abs(now_fir->band_pass_dataD[jjj]);
						}

					if(now_fir->band_pass_data[4]>band_pass_data->final_PGA)
						{
						band_pass_data->final_PGA=now_fir->band_pass_data[4];
						band_pass_data->utc_second_final_PGA=now_fir->utc_second; //utcÊ±¼äÃë
						band_pass_data->utc_nanosecond_final_PGA=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë

						}
					//else
					//	{
					//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
					//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utcÊ±¼äÃë
					//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
					//	}
					if(now_fir->band_pass_dataV[4]>band_pass_data->final_PGV)
						{
						band_pass_data->final_PGV=now_fir->band_pass_dataV[4];
						band_pass_data->utc_second_final_PGV=now_fir->utc_second; //utcÊ±¼äÃë
						band_pass_data->utc_nanosecond_final_PGV=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
						}
					//else
					//	{
					//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
					//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utcÊ±¼äÃë
					//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
					//	}
					if(now_fir->band_pass_dataD[4]>band_pass_data->final_PGD)
						{
						band_pass_data->final_PGD=now_fir->band_pass_dataD[4];
						band_pass_data->utc_second_final_PGD=now_fir->utc_second; //utcÊ±¼äÃë
						band_pass_data->utc_nanosecond_final_PGD=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
						}

					now_fir=now_fir->last;



					}




				*trig=2;
				*count=2;
				}
			else
				{
				for(jjj=0;jjj<3;jjj++)
					{
					if(abs(i_fir_list->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
						band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
					if(abs(i_fir_list->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
						band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
					if(abs(i_fir_list->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
						band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);
					}

				if(i_fir_list->band_pass_data[4]>band_pass_data->final_PGA)
					{
					band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
					band_pass_data->utc_second_final_PGA=i_fir_list->utc_second; //utcÊ±¼äÃë
					band_pass_data->utc_nanosecond_final_PGA=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë

					}
				if(i_fir_list->band_pass_dataV[4]>band_pass_data->final_PGV)
					{
					band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
					band_pass_data->utc_second_final_PGV=i_fir_list->utc_second; //utcÊ±¼äÃë
					band_pass_data->utc_nanosecond_final_PGV=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
					}
				if(i_fir_list->band_pass_dataD[4]>band_pass_data->final_PGD)
					{
					band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
					band_pass_data->utc_second_final_PGD=i_fir_list->utc_second; //utcÊ±¼äÃë
					band_pass_data->utc_nanosecond_final_PGD=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
					}
				if(*count==timespan*100)

					{
					*count=1;
					return 2;
					}
				else
					{


					*count+=1;
					}



				}
			}
		else
							{
							if(*trig==0)
								{


								for(jjj=0;jjj<3;jjj++)
									{
									band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
									band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
									band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);
									}
								band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
								band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
								band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
								//now_fir=i_fir_list->last;
								//for(iii=1;iii<i_sample_rata*3;iii++)
								//	{
								//	for(jjj=0;jjj<3;jjj++)
								//		{
								//		if(abs(now_fir->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
								//			band_pass_data->final_PGA_component[jjj]=abs(now_fir->band_pass_data[jjj]);
								//		if(abs(now_fir->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
								//			band_pass_data->final_PGV_component[jjj]=abs(now_fir->band_pass_dataV[jjj]);
								//		if(abs(now_fir->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
								//			band_pass_data->final_PGD_component[jjj]=abs(now_fir->band_pass_dataD[jjj]);
								//		}

								//	if(now_fir->band_pass_data[4]>band_pass_data->final_PGA)
								//		{
								//		band_pass_data->final_PGA=now_fir->band_pass_data[4];
								//		band_pass_data->utc_second_final_PGA=now_fir->utc_second; //utcÊ±¼äÃë
								//		band_pass_data->utc_nanosecond_final_PGA=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë

								//		}
								//	//else
								//	//	{
								//	//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
								//	//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utcÊ±¼äÃë
								//	//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
								//	//	}
								//	if(now_fir->band_pass_dataV[4]>band_pass_data->final_PGV)
								//		{
								//		band_pass_data->final_PGV=now_fir->band_pass_dataV[4];
								//		band_pass_data->utc_second_final_PGV=now_fir->utc_second; //utcÊ±¼äÃë
								//		band_pass_data->utc_nanosecond_final_PGV=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
								//		}
								//	//else
								//	//	{
								//	//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
								//	//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utcÊ±¼äÃë
								//	//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
								//	//	}
								//	if(now_fir->band_pass_dataD[4]>band_pass_data->final_PGD)
								//		{
								//		band_pass_data->final_PGD=now_fir->band_pass_dataD[4];
								//		band_pass_data->utc_second_final_PGD=now_fir->utc_second; //utcÊ±¼äÃë
								//		band_pass_data->utc_nanosecond_final_PGD=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
								//		}

								//	now_fir=now_fir=now_fir->last;



								//	}


								*count=2;
								*trig=3;

								}
							else if(*trig==3)
								{
								for(jjj=0;jjj<3;jjj++)
									{
									if(abs(i_fir_list->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
										band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
									if(abs(i_fir_list->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
										band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
									if(abs(i_fir_list->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
										band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);

									}

								if(i_fir_list->band_pass_data[4]>band_pass_data->final_PGA)
									{
									band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
									band_pass_data->utc_second_final_PGA=i_fir_list->utc_second; //utcÊ±¼äÃë
									band_pass_data->utc_nanosecond_final_PGA=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë

									}
								//else
								//	{
								//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
								//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utcÊ±¼äÃë
								//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
								//	}
								if(i_fir_list->band_pass_dataV[4]>band_pass_data->final_PGV)
									{
									band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
									band_pass_data->utc_second_final_PGV=i_fir_list->utc_second; //utcÊ±¼äÃë
									band_pass_data->utc_nanosecond_final_PGV=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
									}
								//else
								//	{
								//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
								//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utcÊ±¼äÃë
								//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
								//	}
								if(i_fir_list->band_pass_dataD[4]>band_pass_data->final_PGD)
									{
									band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
									band_pass_data->utc_second_final_PGD=i_fir_list->utc_second; //utcÊ±¼äÃë
									band_pass_data->utc_nanosecond_final_PGD=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
									}
								//else
								//	{
								//	band_pass_data->final_PGD=i_fir_list->last->final_PGD;
								//	band_pass_data->utc_second_final_PGD=i_fir_list->last->utc_second; //utcÊ±¼äÃë
								//	band_pass_data->utc_nanosecond_final_PGD=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
								//	}
								if(*count==timespan*100)
									{
									*count=1;
									*trig=0;
									return 3;

									}
								else
									{

									*count+=1;
									}

								}

				}
		return 1;
		}
	else if(i_fir_list->sample_rata==100&&band_pass_flag==1)
				{
				firLength=301;
				double Fir[301]={-1.3934901977829615e-03,
					-1.8159417519245753e-03,
					-2.1047061992379365e-03,
					-2.1499567281675455e-03,
					-1.9319560065597574e-03,
					-1.5336077824486048e-03,
					-1.1131764610959451e-03,
					-8.4586773282764453e-04,
					-8.5571492559512663e-04,
					-1.1641429939370940e-03,
					-1.6763388826177095e-03,
					-2.2127045829863049e-03,
					-2.5752520825855834e-03,
					-2.6245209995463341e-03,
					-2.3372518475216625e-03,
					-1.8211766253946077e-03,
					-1.2790312324263129e-03,
					-9.3350462293830287e-04,
					-9.4077162689895221e-04,
					-1.3260577655623985e-03,
					-1.9675936202030414e-03,
					-2.6375233932370771e-03,
					-3.0863445849885914e-03,
					-3.1397319857095246e-03,
					-2.7703067122125825e-03,
					-2.1150445844176149e-03,
					-1.4290329171544275e-03,
					-9.9084931593346887e-04,
					-9.9450274977262157e-04,
					-1.4697037836401406e-03,
					-2.2629691037629874e-03,
					-3.0896434805398041e-03,
					-3.6395636772003424e-03,
					-3.6973125284921167e-03,
					-3.2306007769072587e-03,
					-2.4107945111442089e-03,
					-1.5546360967761310e-03,
					-1.0065972753527060e-03,
					-1.0053738031440373e-03,
					-1.5860839569270741e-03,
					-2.5579388666770995e-03,
					-3.5692958764463449e-03,
					-4.2383209384534298e-03,
					-4.3009144849360951e-03,
					-3.7187912246025431e-03,
					-2.7038140209237104e-03,
					-1.6456047543273620e-03,
					-9.6672554881740698e-04,
					-9.5902862506833195e-04,
					-1.6643298430027724e-03,
					-2.8478287426786748e-03,
					-4.0784458396371038e-03,
					-4.8890672246237271e-03,
					-4.9573843372280107e-03,
					-4.2375689803696064e-03,
					-2.9893918921230977e-03,
					-1.6892661355065719e-03,
					-8.5315338472186943e-04,
					-8.3687322528905046e-04,
					-1.6908134983387932e-03,
					-3.1279156197627396e-03,
					-4.6219899287065240e-03,
					-5.6032676672302818e-03,
					-5.6788440317752488e-03,
					-4.7930527289633748e-03,
					-3.2628185712932083e-03,
					-1.6691643874906282e-03,
					-6.4136490201577951e-04,
					-6.1355241309235965e-04,
					-1.6475301337705620e-03,
					-3.3935290783997270e-03,
					-5.2097909555231794e-03,
					-6.4008237800856037e-03,
					-6.4863194218901269e-03,
					-5.3972072803381739e-03,
					-3.5194883154958849e-03,
					-1.5625414496258179e-03,
					-2.9599484306628491e-04,
					-2.5223929370514470e-04,
					-1.5090285192966766e-03,
					-3.6401534025372944e-03,
					-5.8603941401391838e-03,
					-7.3164248762943827e-03,
					-7.4165259229421188e-03,
					-6.0723665880914419e-03,
					-3.7550004343177984e-03,
					-1.3353600892311249e-03,
					2.3788693116028032e-04,
					3.0473249946160190e-04,
					-1.2362210827844447e-03,
					-3.8635274170506517e-03,
					-6.6084146410208293e-03,
					-8.4123588516069620e-03,
					-8.5356836076430822e-03,
					-6.8604886253879381e-03,
					-3.9652570935789742e-03,
					-9.3168387924516256e-04,
					1.0534705820681239e-03,
					1.1561602642038765e-03,
					-7.6279308836732713e-04,
					-4.0597396392069423e-03,
					-7.5208401297042239e-03,
					-9.8072001726968727e-03,
					-9.9708294562862142e-03,
					-7.8443429100596568e-03,
					-4.1465552109397862e-03,
					-2.4844224798785294e-04,
					2.3271192130121512e-03,
					2.4913851040193188e-03,
					3.8417223566559994e-05,
					-4.2253163338121661e-03,
					-8.7382536865734783e-03,
					-1.1749625514224836e-02,
					-1.1991733098263043e-02,
					-9.2038390171244738e-03,
					-4.2956701090024274e-03,
					9.3449579474537436e-04,
					4.4450971219227456e-03,
					4.7325123287797061e-03,
					1.4542781444556027e-03,
					-4.3573002295476306e-03,
					-1.0601141815511635e-02,
					-1.4850187602870650e-02,
					-1.5274622891964655e-02,
					-1.1402122422123587e-02,
					-4.4099287906940446e-03,
					3.1992627279992338e-03,
					8.4610861449535505e-03,
					9.0647035001510286e-03,
					4.3128967563563032e-03,
					-4.4533178832161045e-03,
					-1.4174787943096560e-02,
					-2.1085357894361143e-02,
					-2.2096384652325083e-02,
					-1.6069207429197555e-02,
					-4.4872709594348387e-03,
					8.7849658638558172e-03,
					1.8665591162767350e-02,
					2.0618219193568481e-02,
					1.2446574643172092e-02,
					-4.5116339631119861e-03,
					-2.5272940970094884e-02,
					-4.2331277335992394e-02,
					-4.7764061273754821e-02,
					-3.5721208137345535e-02,
					-4.5262962159261927e-03,
					4.2308025951629580e-02,
					9.6544322689801162e-02,
					1.4711299332650787e-01,
					1.8293486636295642e-01,
					1.9587085363289147e-01,
					1.8293486636295639e-01,
					1.4711299332650785e-01,
					9.6544322689801135e-02,
					4.2308025951629566e-02,
					-4.5262962159261918e-03,
					-3.5721208137345535e-02,
					-4.7764061273754814e-02,
					-4.2331277335992387e-02,
					-2.5272940970094880e-02,
					-4.5116339631119853e-03,
					1.2446574643172089e-02,
					2.0618219193568474e-02,
					1.8665591162767347e-02,
					8.7849658638558138e-03,
					-4.4872709594348361e-03,
					-1.6069207429197544e-02,
					-2.2096384652325073e-02,
					-2.1085357894361126e-02,
					-1.4174787943096552e-02,
					-4.4533178832161010e-03,
					4.3128967563563006e-03,
					9.0647035001510234e-03,
					8.4610861449535436e-03,
					3.1992627279992312e-03,
					-4.4099287906940411e-03,
					-1.1402122422123580e-02,
					-1.5274622891964643e-02,
					-1.4850187602870640e-02,
					-1.0601141815511625e-02,
					-4.3573002295476280e-03,
					1.4542781444556018e-03,
					4.7325123287797017e-03,
					4.4450971219227413e-03,
					9.3449579474537349e-04,
					-4.2956701090024231e-03,
					-9.2038390171244669e-03,
					-1.1991733098263025e-02,
					-1.1749625514224822e-02,
					-8.7382536865734661e-03,
					-4.2253163338121600e-03,
					3.8417223566559994e-05,
					2.4913851040193153e-03,
					2.3271192130121469e-03,
					-2.4844224798785381e-04,
					-4.1465552109397810e-03,
					-7.8443429100596446e-03,
					-9.9708294562862020e-03,
					-9.8072001726968588e-03,
					-7.5208401297042135e-03,
					-4.0597396392069380e-03,
					-7.6279308836732583e-04,
					1.1561602642038756e-03,
					1.0534705820681221e-03,
					-9.3168387924516213e-04,
					-3.9652570935789682e-03,
					-6.8604886253879251e-03,
					-8.5356836076430683e-03,
					-8.4123588516069481e-03,
					-6.6084146410208154e-03,
					-3.8635274170506460e-03,
					-1.2362210827844425e-03,
					3.0473249946160017e-04,
					2.3788693116027988e-04,
					-1.3353600892311228e-03,
					-3.7550004343177915e-03,
					-6.0723665880914298e-03,
					-7.4165259229421032e-03,
					-7.3164248762943671e-03,
					-5.8603941401391716e-03,
					-3.6401534025372871e-03,
					-1.5090285192966731e-03,
					-2.5223929370514383e-04,
					-2.9599484306628491e-04,
					-1.5625414496258144e-03,
					-3.5194883154958771e-03,
					-5.3972072803381609e-03,
					-6.4863194218901122e-03,
					-6.4008237800855889e-03,
					-5.2097909555231664e-03,
					-3.3935290783997183e-03,
					-1.6475301337705575e-03,
					-6.1355241309235748e-04,
					-6.4136490201577821e-04,
					-1.6691643874906245e-03,
					-3.2628185712932005e-03,
					-4.7930527289633627e-03,
					-5.6788440317752332e-03,
					-5.6032676672302679e-03,
					-4.6219899287065127e-03,
					-3.1279156197627305e-03,
					-1.6908134983387882e-03,
					-8.3687322528904872e-04,
					-8.5315338472186726e-04,
					-1.6892661355065672e-03,
					-2.9893918921230908e-03,
					-4.2375689803695943e-03,
					-4.9573843372279977e-03,
					-4.8890672246237124e-03,
					-4.0784458396370933e-03,
					-2.8478287426786674e-03,
					-1.6643298430027674e-03,
					-9.5902862506832913e-04,
					-9.6672554881740416e-04,
					-1.6456047543273575e-03,
					-2.7038140209237008e-03,
					-3.7187912246025327e-03,
					-4.3009144849360829e-03,
					-4.2383209384534160e-03,
					-3.5692958764463336e-03,
					-2.5579388666770917e-03,
					-1.5860839569270702e-03,
					-1.0053738031440341e-03,
					-1.0065972753527028e-03,
					-1.5546360967761263e-03,
					-2.4107945111442020e-03,
					-3.2306007769072496e-03,
					-3.6973125284921046e-03,
					-3.6395636772003298e-03,
					-3.0896434805397937e-03,
					-2.2629691037629792e-03,
					-1.4697037836401362e-03,
					-9.9450274977261875e-04,
					-9.9084931593346518e-04,
					-1.4290329171544223e-03,
					-2.1150445844176089e-03,
					-2.7703067122125742e-03,
					-3.1397319857095142e-03,
					-3.0863445849885810e-03,
					-2.6375233932370672e-03,
					-1.9675936202030344e-03,
					-1.3260577655623941e-03,
					-9.4077162689894884e-04,
					-9.3350462293829940e-04,
					-1.2790312324263090e-03,
					-1.8211766253946012e-03,
					-2.3372518475216551e-03,
					-2.6245209995463237e-03,
					-2.5752520825855730e-03,
					-2.2127045829862962e-03,
					-1.6763388826177036e-03,
					-1.1641429939370888e-03,
					-8.5571492559512359e-04,
					-8.4586773282764138e-04,
					-1.1131764610959410e-03,
					-1.5336077824486000e-03,
					-1.9319560065597509e-03,
					-2.1499567281675781e-03,
					-2.1047061992379612e-03,
					-1.8159417519245733e-03,
					-1.3934901977829676e-03,



					};
				if(*trig==1||*trig==2)
					{


					//if(PGV_type==1)
					//	{
					//	datamid=0.0;
					//	now_fir=i_fir_list;
					//	for(int i=0;i<firLength;i++)
					//		{
					//		datamid=datamid+now_fir->dataV[4]*Fir[i];
					//		now_fir=now_fir->last;
					//		}
					//	i_fir_list->band_pass_dataV[4]=datamid;



					//	datamid=0.0;
					//	now_fir=i_fir_list;
					//	for(int i=0;i<firLength;i++)
					//		{
					//		datamid=datamid+now_fir->dataD[4]*Fir[i];
					//		now_fir=now_fir->last;
					//		}
					//	i_fir_list->band_pass_dataD[4]=datamid;

					//	}
					//else if(PGV_type==2)
					//	{
					//	for(int j=0;j<3;j++)
					//		{


					//		datamid=0.0;
					//		now_fir=i_fir_list;
					//		for(int i=0;i<firLength;i++)
					//			{
					//			datamid=datamid+now_fir->dataV[j]*Fir[i];
					//			now_fir=now_fir->last;
					//			}
					//		i_fir_list->band_pass_dataV[j]=datamid;

					//		}
					//	i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
					//	for(int j=0;j<3;j++)
					//		{


					//		datamid=0.0;
					//		now_fir=i_fir_list;
					//		for(int i=0;i<firLength;i++)
					//			{
					//			datamid=datamid+now_fir->dataD[j]*Fir[i];
					//			now_fir=now_fir->last;
					//			}
					//		i_fir_list->band_pass_dataD[j]=datamid;
					//		}
					//	i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
					//	}

					if(*trig==1)
						{
						for(jjj=0;jjj<3;jjj++)
							{
							band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
							band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
							band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);
							}
						band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
						band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
						band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];

						now_fir=i_fir_list->last;
						for(iii=1;iii<i_sample_rata*3;iii++)
							{
							for(jjj=0;jjj<3;jjj++)
								{
								if(abs(now_fir->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
									band_pass_data->final_PGA_component[jjj]=abs(now_fir->band_pass_data[jjj]);
								if(abs(now_fir->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
									band_pass_data->final_PGV_component[jjj]=abs(now_fir->band_pass_dataV[jjj]);
								if(abs(now_fir->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
									band_pass_data->final_PGD_component[jjj]=abs(now_fir->band_pass_dataD[jjj]);
								}

							if(now_fir->band_pass_data[4]>band_pass_data->final_PGA)
								{
								band_pass_data->final_PGA=now_fir->band_pass_data[4];
								band_pass_data->utc_second_final_PGA=now_fir->utc_second; //utcÊ±¼äÃë
								band_pass_data->utc_nanosecond_final_PGA=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë

								}
							//else
							//	{
							//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
							//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utcÊ±¼äÃë
							//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
							//	}
							if(now_fir->band_pass_dataV[4]>band_pass_data->final_PGV)
								{
								band_pass_data->final_PGV=now_fir->band_pass_dataV[4];
								band_pass_data->utc_second_final_PGV=now_fir->utc_second; //utcÊ±¼äÃë
								band_pass_data->utc_nanosecond_final_PGV=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
								}
							//else
							//	{
							//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
							//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utcÊ±¼äÃë
							//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
							//	}
							if(now_fir->band_pass_dataD[4]>band_pass_data->final_PGD)
								{
								band_pass_data->final_PGD=now_fir->band_pass_dataD[4];
								band_pass_data->utc_second_final_PGD=now_fir->utc_second; //utcÊ±¼äÃë
								band_pass_data->utc_nanosecond_final_PGD=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
								}

							now_fir=now_fir->last;



							}



						*trig=2;
						*count=2;
						}
					else
						{
						for(jjj=0;jjj<3;jjj++)
							{
							if(abs(i_fir_list->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
								band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
							if(abs(i_fir_list->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
								band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
							if(abs(i_fir_list->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
								band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);
							}

						if(i_fir_list->band_pass_data[4]>band_pass_data->final_PGA)
							{
							band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
							band_pass_data->utc_second_final_PGA=i_fir_list->utc_second; //utcÊ±¼äÃë
							band_pass_data->utc_nanosecond_final_PGA=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë

							}
						if(i_fir_list->band_pass_dataV[4]>band_pass_data->final_PGV)
							{
							band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
							band_pass_data->utc_second_final_PGV=i_fir_list->utc_second; //utcÊ±¼äÃë
							band_pass_data->utc_nanosecond_final_PGV=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
							}
						if(i_fir_list->band_pass_dataD[4]>band_pass_data->final_PGD)
							{
							band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
							band_pass_data->utc_second_final_PGD=i_fir_list->utc_second; //utcÊ±¼äÃë
							band_pass_data->utc_nanosecond_final_PGD=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
							}
						if(*count==timespan*100)

							{
							*count=1;
							return 2;
							}
						else
							{


							*count+=1;
							}



						}
					}
				else
					{
					if(*trig==0)
						{


						for(jjj=0;jjj<3;jjj++)
							{
							band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
							band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
							band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);
							}
						band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
						band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
						band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
						//now_fir=i_fir_list->last;
						//for(iii=1;iii<i_sample_rata*3;iii++)
						//	{
						//	for(jjj=0;jjj<3;jjj++)
						//		{
						//		if(abs(now_fir->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
						//			band_pass_data->final_PGA_component[jjj]=abs(now_fir->band_pass_data[jjj]);
						//		if(abs(now_fir->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
						//			band_pass_data->final_PGV_component[jjj]=abs(now_fir->band_pass_dataV[jjj]);
						//		if(abs(now_fir->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
						//			band_pass_data->final_PGD_component[jjj]=abs(now_fir->band_pass_dataD[jjj]);
						//		}

						//	if(now_fir->band_pass_data[4]>band_pass_data->final_PGA)
						//		{
						//		band_pass_data->final_PGA=now_fir->band_pass_data[4];
						//		band_pass_data->utc_second_final_PGA=now_fir->utc_second; //utcÊ±¼äÃë
						//		band_pass_data->utc_nanosecond_final_PGA=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë

						//		}
						//	//else
						//	//	{
						//	//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
						//	//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utcÊ±¼äÃë
						//	//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
						//	//	}
						//	if(now_fir->band_pass_dataV[4]>band_pass_data->final_PGV)
						//		{
						//		band_pass_data->final_PGV=now_fir->band_pass_dataV[4];
						//		band_pass_data->utc_second_final_PGV=now_fir->utc_second; //utcÊ±¼äÃë
						//		band_pass_data->utc_nanosecond_final_PGV=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
						//		}
						//	//else
						//	//	{
						//	//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
						//	//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utcÊ±¼äÃë
						//	//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
						//	//	}
						//	if(now_fir->band_pass_dataD[4]>band_pass_data->final_PGD)
						//		{
						//		band_pass_data->final_PGD=now_fir->band_pass_dataD[4];
						//		band_pass_data->utc_second_final_PGD=now_fir->utc_second; //utcÊ±¼äÃë
						//		band_pass_data->utc_nanosecond_final_PGD=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
						//		}

						//	now_fir=now_fir=now_fir->last;



						//	}


						*count=2;
						*trig=3;

						}
					else if(*trig==3)
						{
						for(jjj=0;jjj<3;jjj++)
							{
							if(abs(i_fir_list->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
								band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
							if(abs(i_fir_list->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
								band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
							if(abs(i_fir_list->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
								band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);

							}

						if(i_fir_list->band_pass_data[4]>band_pass_data->final_PGA)
							{
							band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
							band_pass_data->utc_second_final_PGA=i_fir_list->utc_second; //utcÊ±¼äÃë
							band_pass_data->utc_nanosecond_final_PGA=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë

							}
						//else
						//	{
						//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
						//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utcÊ±¼äÃë
						//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
						//	}
						if(i_fir_list->band_pass_dataV[4]>band_pass_data->final_PGV)
							{
							band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
							band_pass_data->utc_second_final_PGV=i_fir_list->utc_second; //utcÊ±¼äÃë
							band_pass_data->utc_nanosecond_final_PGV=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
							}
						//else
						//	{
						//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
						//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utcÊ±¼äÃë
						//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
						//	}
						if(i_fir_list->band_pass_dataD[4]>band_pass_data->final_PGD)
							{
							band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
							band_pass_data->utc_second_final_PGD=i_fir_list->utc_second; //utcÊ±¼äÃë
							band_pass_data->utc_nanosecond_final_PGD=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
							}
						//else
						//	{
						//	band_pass_data->final_PGD=i_fir_list->last->final_PGD;
						//	band_pass_data->utc_second_final_PGD=i_fir_list->last->utc_second; //utcÊ±¼äÃë
						//	band_pass_data->utc_nanosecond_final_PGD=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
						//	}
						if(*count==timespan*100)
							{
							*count=1;
							*trig=0;
							return 3;

							}
						else
							{

							*count+=1;
							}

						}

				}
				return 1;
		}
	else if(i_fir_list->sample_rata==200&&band_pass_flag==0)
		{
		firLength=301;
		//if(dataNum<301)
		//	{
		//	return -1;
		//	}
		double Fir[301]={-1.5738968347689628e-04,
			-1.7735491639294824e-04,
			-2.1736124094126334e-04,
			-2.7483905489700012e-04,
			-3.4266813193163193e-04,
			-4.1030106015100642e-04,
			-4.6590026089908369e-04,
			-4.9908565647348161e-04,
			-5.0368485858866155e-04,
			-4.7980096272096865e-04,
			-4.3459912811287315e-04,
			-3.8145932023061683e-04,
			-3.3750551620498548e-04,
			-3.1992389949451273e-04,
			-3.4182841427864982e-04,
			-4.0862956128619334e-04,
			-5.1584657092479044e-04,
			-6.4905509995696496e-04,
			-7.8621869932361810e-04,
			-9.0210075583715586e-04,
			-9.7391805542624665e-04,
			-9.8700968544837217e-04,
			-9.3916478239759282e-04,
			-8.4243680789333406e-04,
			-7.2175694572392348e-04,
			-6.1035700575723644e-04,
			-5.4277523357811595e-04,
			-5.4686940852928067e-04,
			-6.3663386121590247e-04,
			-8.0759555645765300e-04,
			-1.0361182005924534e-03,
			-1.2831404037890676e-03,
			-1.5018735401092786e-03,
			-1.6480075080620943e-03,
			-1.6902522160705587e-03,
			-1.6187724217614032e-03,
			-1.4493561975616916e-03,
			-1.2219729859712122e-03,
			-9.9357826868147307e-04,
			-8.2635727901226479e-04,
			-7.7376662014393995e-04,
			-8.6744203333462462e-04,
			-1.1080893063261379e-03,
			-1.4627990304460733e-03,
			-1.8699254737555102e-03,
			-2.2510004567963386e-03,
			-2.5274762640143944e-03,
			-2.6387982693635644e-03,
			-2.5577291433000224e-03,
			-2.2991713422791313e-03,
			-1.9199554375127431e-03,
			-1.5089616520395268e-03,
			-1.1691295962667500e-03,
			-9.9489997697284663e-04,
			-1.0499463509793807e-03,
			-1.3503416137936456e-03,
			-1.8574229089935940e-03,
			-2.4826907958067261e-03,
			-3.1044754803961948e-03,
			-3.5933784465069858e-03,
			-3.8412720032523487e-03,
			-3.7874595744862814e-03,
			-3.4358093523187173e-03,
			-2.8583194491591827e-03,
			-2.1833724736893233e-03,
			-1.5703255973366405e-03,
			-1.1753198885291142e-03,
			-1.1155270970319925e-03,
			-1.4398884580665875e-03,
			-2.1134488140001156e-03,
			-3.0197519628140561e-03,
			-3.9819340454248483e-03,
			-4.7989298359828224e-03,
			-5.2895315090100694e-03,
			-5.3347847421739408e-03,
			-4.9089772067057768e-03,
			-4.0914494807903403e-03,
			-3.0553263232042977e-03,
			-2.0342643861179957e-03,
			-1.2733736807093051e-03,
			-9.7444743993873348e-04,
			-1.2475579059199422e-03,
			-2.0803813561700931e-03,
			-3.3333020239832397e-03,
			-4.7630034661209093e-03,
			-6.0709747972200970e-03,
			-6.9675036714509026e-03,
			-7.2376487999995407e-03,
			-6.7944115044867989e-03,
			-5.7063144258142880e-03,
			-4.1915922126739454e-03,
			-2.5782559165073099e-03,
			-1.2369414329412996e-03,
			-5.0000439657026010e-04,
			-5.8423897384719532e-04,
			-1.5348385257546453e-03,
			-3.2045099423030948e-03,
			-5.2745989273480509e-03,
			-7.3160653117819293e-03,
			-8.8790713655859960e-03,
			-9.5928420397288355e-03,
			-9.2540312860429144e-03,
			-7.8830675166212654e-03,
			-5.7338544840285889e-03,
			-3.2517317719462481e-03,
			-9.8584385474959567e-04,
			5.2737308823975636e-04,
			8.8539160937573045e-04,
			-8.1278022656460546e-05,
			-2.2555652814956074e-03,
			-5.2408116952406677e-03,
			-8.4306412604161132e-03,
			-1.1130333116173553e-02,
			-1.2706151017152620e-02,
			-1.2731360484584070e-02,
			-1.1096337143008480e-02,
			-8.0559256539294525e-03,
			-4.1992280006084327e-03,
			-3.4304817834827792e-04,
			2.6329471431176831e-03,
			3.9772854451277720e-03,
			3.2439302636812226e-03,
			4.1585700052789186e-04,
			-4.0560792879092526e-03,
			-9.3139281317865166e-03,
			-1.4247613714347402e-02,
			-1.7717974336771903e-02,
			-1.8805230945223246e-02,
			-1.7031601742540699e-02,
			-1.2508339273051561e-02,
			-5.9695509104043653e-03,
			1.3240748146035209e-03,
			7.8028250387371500e-03,
			1.1892350786033203e-02,
			1.2350080720461974e-02,
			8.5682310423650879e-03,
			7.7979549076405419e-04,
			-9.8815104670206631e-03,
			-2.1491211233783846e-02,
			-3.1606466363625955e-02,
			-3.7661758554831441e-02,
			-3.7422874756706775e-02,
			-2.9419394015175061e-02,
			-1.3275490993334308e-02,
			1.0126511572124210e-02,
			3.8687978116648487e-02,
			6.9343825778920370e-02,
			9.8485912360757433e-02,
			1.2249350941875659e-01,
			1.3828375204993210e-01,
			1.4378957268385817e-01,
			1.3828375204993198e-01,
			1.2249350941875640e-01,
			9.8485912360757155e-02,
			6.9343825778920107e-02,
			3.8687978116648321e-02,
			1.0126511572124158e-02,
			-1.3275490993334225e-02,
			-2.9419394015174839e-02,
			-3.7422874756706463e-02,
			-3.7661758554831101e-02,
			-3.1606466363625629e-02,
			-2.1491211233783607e-02,
			-9.8815104670205468e-03,
			7.7979549076404465e-04,
			8.5682310423649734e-03,
			1.2350080720461792e-02,
			1.1892350786033016e-02,
			7.8028250387370190e-03,
			1.3240748146034983e-03,
			-5.9695509104042534e-03,
			-1.2508339273051316e-02,
			-1.7031601742540346e-02,
			-1.8805230945222844e-02,
			-1.7717974336771518e-02,
			-1.4247613714347076e-02,
			-9.3139281317862910e-03,
			-4.0560792879091503e-03,
			4.1585700052788145e-04,
			3.2439302636811385e-03,
			3.9772854451276627e-03,
			2.6329471431176059e-03,
			-3.4304817834826751e-04,
			-4.1992280006083061e-03,
			-8.0559256539291975e-03,
			-1.1096337143008119e-02,
			-1.2731360484583639e-02,
			-1.2706151017152188e-02,
			-1.1130333116173159e-02,
			-8.4306412604158061e-03,
			-5.2408116952404717e-03,
			-2.2555652814955185e-03,
			-8.1278022656457077e-05,
			8.8539160937569489e-04,
			5.2737308823973467e-04,
			-9.8584385474955491e-04,
			-3.2517317719461085e-03,
			-5.7338544840283339e-03,
			-7.8830675166209115e-03,
			-9.2540312860424894e-03,
			-9.5928420397283845e-03,
			-8.8790713655855676e-03,
			-7.3160653117815720e-03,
			-5.2745989273477829e-03,
			-3.2045099423029331e-03,
			-1.5348385257545655e-03,
			-5.8423897384716496e-04,
			-5.0000439657023278e-04,
			-1.2369414329412311e-03,
			-2.5782559165071638e-03,
			-4.1915922126737068e-03,
			-5.7063144258139575e-03,
			-6.7944115044863947e-03,
			-7.2376487999991001e-03,
			-6.9675036714504724e-03,
			-6.0709747972197223e-03,
			-4.7630034661206057e-03,
			-3.3333020239830237e-03,
			-2.0803813561699586e-03,
			-1.2475579059198585e-03,
			-9.7444743993866712e-04,
			-1.2733736807092175e-03,
			-2.0342643861178543e-03,
			-3.0553263232040791e-03,
			-4.0914494807900480e-03,
			-4.9089772067054177e-03,
			-5.3347847421735478e-03,
			-5.2895315090096687e-03,
			-4.7989298359824538e-03,
			-3.9819340454245395e-03,
			-3.0197519628138176e-03,
			-2.1134488139999473e-03,
			-1.4398884580664711e-03,
			-1.1155270970319006e-03,
			-1.1753198885290160e-03,
			-1.5703255973365086e-03,
			-2.1833724736891359e-03,
			-2.8583194491589325e-03,
			-3.4358093523184151e-03,
			-3.7874595744859440e-03,
			-3.8412720032520008e-03,
			-3.5933784465066554e-03,
			-3.1044754803959073e-03,
			-2.4826907958064920e-03,
			-1.8574229089934173e-03,
			-1.3503416137935148e-03,
			-1.0499463509792775e-03,
			-9.9489997697274797e-04,
			-1.1691295962666325e-03,
			-1.5089616520393724e-03,
			-1.9199554375125441e-03,
			-2.2991713422788910e-03,
			-2.5577291432997522e-03,
			-2.6387982693632807e-03,
			-2.5274762640141194e-03,
			-2.2510004567960896e-03,
			-1.8699254737553005e-03,
			-1.4627990304459074e-03,
			-1.1080893063260097e-03,
			-8.6744203333452400e-04,
			-7.7376662014384866e-04,
			-8.2635727901216656e-04,
			-9.9357826868135316e-04,
			-1.2219729859710637e-03,
			-1.4493561975615118e-03,
			-1.6187724217612007e-03,
			-1.6902522160703449e-03,
			-1.6480075080618820e-03,
			-1.5018735401090826e-03,
			-1.2831404037888989e-03,
			-1.0361182005923146e-03,
			-8.0759555645754327e-04,
			-6.3663386121581508e-04,
			-5.4686940852920413e-04,
			-5.4277523357803897e-04,
			-6.1035700575714949e-04,
			-7.2175694572381886e-04,
			-8.4243680789320959e-04,
			-9.3916478239745296e-04,
			-9.8700968544822277e-04,
			-9.7391805542609714e-04,
			-9.0210075583701556e-04,
			-7.8621869932349417e-04,
			-6.4905509995686088e-04,
			-5.1584657092470653e-04,
			-4.0862956128612563e-04,
			-3.4182841427859273e-04,
			-3.1992389949445831e-04,
			-3.3750551620492721e-04,
			-3.8145932023054988e-04,
			-4.3459912811279558e-04,
			-4.7980096272088148e-04,
			-5.0368485858856907e-04,
			-4.9908565647338837e-04,
			-4.6590026089899489e-04,
			-4.1030106015092717e-04,
			-3.4266813193156422e-04,
			-2.7483905489694477e-04,
			-2.1736124094121881e-04,
			-1.7735491639291114e-04,
			-1.5738968347686275e-04,


			};
		if(*trig==1||*trig==2)
			{

	/*		if(PGV_type==1)
				{
				datamid=0.0;
				now_fir=i_fir_list;
				for(int i=0;i<firLength;i++)
					{
					datamid=datamid+now_fir->dataV[4]*Fir[i];
					now_fir=now_fir->last;
					}
				i_fir_list->band_pass_dataV[4]=datamid;



				datamid=0.0;
				now_fir=i_fir_list;
				for(int i=0;i<firLength;i++)
					{
					datamid=datamid+now_fir->dataD[4]*Fir[i];
					now_fir=now_fir->last;
					}
				i_fir_list->band_pass_dataD[4]=datamid;

				}
			else if(PGV_type==2)
				{
				for(int j=0;j<3;j++)
					{


					datamid=0.0;
					now_fir=i_fir_list;
					for(int i=0;i<firLength;i++)
						{
						datamid=datamid+now_fir->dataV[j]*Fir[i];
						now_fir=now_fir->last;
						}
					i_fir_list->band_pass_dataV[j]=datamid;

					}
				i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
				for(int j=0;j<3;j++)
					{


					datamid=0.0;
					now_fir=i_fir_list;
					for(int i=0;i<firLength;i++)
						{
						datamid=datamid+now_fir->dataD[j]*Fir[i];
						now_fir=now_fir->last;
						}
					i_fir_list->band_pass_dataD[j]=datamid;
					}
				i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
				}*/

			if(*trig==1)
				{
				for(jjj=0;jjj<3;jjj++)
					{
					band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
					band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
					band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);
					}
				band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
				band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
				band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];

				now_fir=i_fir_list->last;
				for(iii=1;iii<i_sample_rata*3;iii++)
					{
					for(jjj=0;jjj<3;jjj++)
						{
						if(abs(now_fir->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
							band_pass_data->final_PGA_component[jjj]=abs(now_fir->band_pass_data[jjj]);
						if(abs(now_fir->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
							band_pass_data->final_PGV_component[jjj]=abs(now_fir->band_pass_dataV[jjj]);
						if(abs(now_fir->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
							band_pass_data->final_PGD_component[jjj]=abs(now_fir->band_pass_dataD[jjj]);
						}

					if(now_fir->band_pass_data[4]>band_pass_data->final_PGA)
						{
						band_pass_data->final_PGA=now_fir->band_pass_data[4];
						band_pass_data->utc_second_final_PGA=now_fir->utc_second; //utcÊ±¼äÃë
						band_pass_data->utc_nanosecond_final_PGA=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë

						}
					//else
					//	{
					//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
					//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utcÊ±¼äÃë
					//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
					//	}
					if(now_fir->band_pass_dataV[4]>band_pass_data->final_PGV)
						{
						band_pass_data->final_PGV=now_fir->band_pass_dataV[4];
						band_pass_data->utc_second_final_PGV=now_fir->utc_second; //utcÊ±¼äÃë
						band_pass_data->utc_nanosecond_final_PGV=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
						}
					//else
					//	{
					//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
					//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utcÊ±¼äÃë
					//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
					//	}
					if(now_fir->band_pass_dataD[4]>band_pass_data->final_PGD)
						{
						band_pass_data->final_PGD=now_fir->band_pass_dataD[4];
						band_pass_data->utc_second_final_PGD=now_fir->utc_second; //utcÊ±¼äÃë
						band_pass_data->utc_nanosecond_final_PGD=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
						}

					now_fir=now_fir->last;



					}




				*trig=2;
				*count=2;
				}
			else
				{


				for(jjj=0;jjj<3;jjj++)
					{
					if(abs(i_fir_list->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
						band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
					if(abs(i_fir_list->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
						band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
					if(abs(i_fir_list->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
						band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);
					}

				if(i_fir_list->band_pass_data[4]>band_pass_data->final_PGA)
					{
					band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
					band_pass_data->utc_second_final_PGA=i_fir_list->utc_second; //utcÊ±¼äÃë
					band_pass_data->utc_nanosecond_final_PGA=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë

					}
				if(i_fir_list->band_pass_dataV[4]>band_pass_data->final_PGV)
					{
					band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
					band_pass_data->utc_second_final_PGV=i_fir_list->utc_second; //utcÊ±¼äÃë
					band_pass_data->utc_nanosecond_final_PGV=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
					}
				if(i_fir_list->band_pass_dataD[4]>band_pass_data->final_PGD)
					{
					band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
					band_pass_data->utc_second_final_PGD=i_fir_list->utc_second; //utcÊ±¼äÃë
					band_pass_data->utc_nanosecond_final_PGD=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
					}
				if(*count==timespan*200)

					{
					*count=1;
					return 2;
					}
				else
					{


					*count+=1;
					}



				}
			}
		else
			{
			if(*trig==0)
				{


				for(jjj=0;jjj<3;jjj++)
					{
					band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
					band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
					band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);
					}
				band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
				band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
				band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
				//now_fir=i_fir_list->last;
				//for(iii=1;iii<i_sample_rata*3;iii++)
				//	{
				//	for(jjj=0;jjj<3;jjj++)
				//		{
				//		if(abs(now_fir->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
				//			band_pass_data->final_PGA_component[jjj]=abs(now_fir->band_pass_data[jjj]);
				//		if(abs(now_fir->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
				//			band_pass_data->final_PGV_component[jjj]=abs(now_fir->band_pass_dataV[jjj]);
				//		if(abs(now_fir->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
				//			band_pass_data->final_PGD_component[jjj]=abs(now_fir->band_pass_dataD[jjj]);
				//		}

				//	if(now_fir->band_pass_data[4]>band_pass_data->final_PGA)
				//		{
				//		band_pass_data->final_PGA=now_fir->band_pass_data[4];
				//		band_pass_data->utc_second_final_PGA=now_fir->utc_second; //utcÊ±¼äÃë
				//		band_pass_data->utc_nanosecond_final_PGA=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë

				//		}
				//	//else
				//	//	{
				//	//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
				//	//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utcÊ±¼äÃë
				//	//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
				//	//	}
				//	if(now_fir->band_pass_dataV[4]>band_pass_data->final_PGV)
				//		{
				//		band_pass_data->final_PGV=now_fir->band_pass_dataV[4];
				//		band_pass_data->utc_second_final_PGV=now_fir->utc_second; //utcÊ±¼äÃë
				//		band_pass_data->utc_nanosecond_final_PGV=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
				//		}
				//	//else
				//	//	{
				//	//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
				//	//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utcÊ±¼äÃë
				//	//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
				//	//	}
				//	if(now_fir->band_pass_dataD[4]>band_pass_data->final_PGD)
				//		{
				//		band_pass_data->final_PGD=now_fir->band_pass_dataD[4];
				//		band_pass_data->utc_second_final_PGD=now_fir->utc_second; //utcÊ±¼äÃë
				//		band_pass_data->utc_nanosecond_final_PGD=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
				//		}

				//	now_fir=now_fir=now_fir->last;



				//	}


				*count=2;
				*trig=3;

				}
			else if(*trig==3)
				{
				for(jjj=0;jjj<3;jjj++)
					{
					if(abs(i_fir_list->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
						band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
					if(abs(i_fir_list->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
						band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
					if(abs(i_fir_list->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
						band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);

					}

				if(i_fir_list->band_pass_data[4]>band_pass_data->final_PGA)
					{
					band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
					band_pass_data->utc_second_final_PGA=i_fir_list->utc_second; //utcÊ±¼äÃë
					band_pass_data->utc_nanosecond_final_PGA=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë

					}
				//else
				//	{
				//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
				//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utcÊ±¼äÃë
				//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
				//	}
				if(i_fir_list->band_pass_dataV[4]>band_pass_data->final_PGV)
					{
					band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
					band_pass_data->utc_second_final_PGV=i_fir_list->utc_second; //utcÊ±¼äÃë
					band_pass_data->utc_nanosecond_final_PGV=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
					}
				//else
				//	{
				//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
				//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utcÊ±¼äÃë
				//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
				//	}
				if(i_fir_list->band_pass_dataD[4]>band_pass_data->final_PGD)
					{
					band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
					band_pass_data->utc_second_final_PGD=i_fir_list->utc_second; //utcÊ±¼äÃë
					band_pass_data->utc_nanosecond_final_PGD=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
					}
				//else
				//	{
				//	band_pass_data->final_PGD=i_fir_list->last->final_PGD;
				//	band_pass_data->utc_second_final_PGD=i_fir_list->last->utc_second; //utcÊ±¼äÃë
				//	band_pass_data->utc_nanosecond_final_PGD=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
				//	}
				if(*count==timespan*200)
					{
					*count=1;
					*trig=0;
					return 3;

					}
				else
					{

					*count+=1;
					}

				}

	}
		return 1;
		}
	else if(i_fir_list->sample_rata==200&&band_pass_flag==1)
		{
		firLength=541;
		//if(dataNum<301)
		//	{
		//	return -1;
		//	}
		double Fir[541]={-9.2099036038378532e-04,
			-7.8804826816350514e-04,
			-6.6560344061362866e-04,
			-5.6687547227462695e-04,
			-5.0305195443362731e-04,
			-4.8212458142003447e-04,
			-5.0801522925230963e-04,
			-5.8008622249482611e-04,
			-6.9309294300030314e-04,
			-8.3759419607064940e-04,
			-1.0007904473973064e-03,
			-1.1677166438897948e-03,
			-1.3226792145237351e-03,
			-1.4507998700714149e-03,
			-1.5395149164156340e-03,
			-1.5798796606311268e-03,
			-1.5675433814101799e-03,
			-1.5032900196379525e-03,
			-1.3930805785312536e-03,
			-1.2475813887482972e-03,
			-1.0812132551662164e-03,
			-9.1080504603679199e-04,
			-7.5397661608138985e-04,
			-6.2740578524895022e-04,
			-5.4514918710074384e-04,
			-5.1718531515799690e-04,
			-5.4832980445290475e-04,
			-6.3763933271860978e-04,
			-7.7837451944441324e-04,
			-9.5853814908441635e-04,
			-1.1619481531160475e-03,
			-1.3697506595220668e-03,
			-1.5622325114940184e-03,
			-1.7207597251464868e-03,
			-1.8296519661545247e-03,
			-1.8778052751213447e-03,
			-1.8598961554604190e-03,
			-1.7770380880220437e-03,
			-1.6368131495740684e-03,
			-1.4526618487227868e-03,
			-1.2426777301980229e-03,
			-1.0279134888687795e-03,
			-8.3035621871027751e-04,
			-6.7076573516148576e-04,
			-5.6658772472861297e-04,
			-5.3015062268610609e-04,
			-5.6733143777716296e-04,
			-6.7683314040934404e-04,
			-8.5015853938458274e-04,
			-1.0722982056842946e-03,
			-1.3230794514709333e-03,
			-1.5790565837738907e-03,
			-1.8157663436507616e-03,
			-2.0101324311648091e-03,
			-2.1427836247891099e-03,
			-2.2000535925879644e-03,
			-2.1754571889266504e-03,
			-2.0704856679088202e-03,
			-1.8946275302998378e-03,
			-1.6645966177239893e-03,
			-1.4028273596775336e-03,
			-1.1353710613629898e-03,
			-8.8938935754289306e-04,
			-6.9048502597345474e-04,
			-5.6013150133180209e-04,
			-5.1345808254886992e-04,
			-5.5761788704660181e-04,
			-6.9091251719947467e-04,
			-9.0277595818363658e-04,
			-1.1746371336738743e-03,
			-1.4815938115070816e-03,
			-1.7947487057919354e-03,
			-2.0839898846883352e-03,
			-2.3209490512706072e-03,
			-2.4818481466164577e-03,
			-2.5499498422015465e-03,
			-2.5173609120326093e-03,
			-2.3859964670479806e-03,
			-2.1675922672027342e-03,
			-1.8827443572853935e-03,
			-1.5590512379570593e-03,
			-1.2285242513423947e-03,
			-9.2450775236682355e-04,
			-6.7840413588373869e-04,
			-5.1652413990349946e-04,
			-4.5737696479821453e-04,
			-5.0967758766085958e-04,
			-6.7128325883947910e-04,
			-9.2918345122575824e-04,
			-1.2605657298138107e-03,
			-1.6348739179959412e-03,
			-2.0166749784740114e-03,
			-2.3690672229614647e-03,
			-2.6573034400949446e-03,
			-2.8522746288034552e-03,
			-2.9335066344339071e-03,
			-2.8913631482099544e-03,
			-2.7282208685875907e-03,
			-2.4584796038279720e-03,
			-2.1073826169179673e-03,
			-1.7087397545895546e-03,
			-1.3017563556190544e-03,
			-9.2726353456713112e-04,
			-6.2371066482157266e-04,
			-4.2331173523314162e-04,
			-3.4872998370800008e-04,
			-4.1063976990715308e-04,
			-6.0642476251474388e-04,
			-9.2016438994335105e-04,
			-1.3239361803047587e-03,
			-1.7803320420881636e-03,
			-2.2459644154696938e-03,
			-2.6756357782218845e-03,
			-3.0267727437604114e-03,
			-3.2636916931282249e-03,
			-3.3612706949638629e-03,
			-3.3076524683700241e-03,
			-3.1056912475649718e-03,
			-2.7729746824372565e-03,
			-2.3403892837598060e-03,
			-1.8493412139778430e-03,
			-1.3478794014496636e-03,
			-8.8608150223198922e-04,
			-5.1114349515264787e-04,
			-2.6265206842258714e-04,
			-1.6851079481957512e-04,
			-2.4193625100973236e-04,
			-4.7984317191924781e-04,
			-8.6280715728713074e-04,
			-1.3566415625985743e-03,
			-1.9154665600813400e-03,
			-2.4859984617802782e-03,
			-3.0126612251738065e-03,
			-3.4430325498542480e-03,
			-3.7330937104403427e-03,
			-3.8517604832979464e-03,
			-3.7842324736531100e-03,
			-3.5338050023559580e-03,
			-3.1219319124799489e-03,
			-2.5864957712039751e-03,
			-1.9784179024470525e-03,
			-1.3569073131266510e-03,
			-7.8378825350351668e-04,
			-3.1744647022797834e-04,
			-6.9834312824419518e-06,
			1.1284000836526972e-04,
			2.5354317567758977e-05,
			-2.6597224788052265e-04,
			-7.3743067972836655e-04,
			-1.3469646033695993e-03,
			-2.0379172193921657e-03,
			-2.7443031575346403e-03,
			-3.3971190584163721e-03,
			-3.9310935787960494e-03,
			-4.2912209155740550e-03,
			-4.4384286657659696e-03,
			-4.3538016122489434e-03,
			-4.0409122987702514e-03,
			-3.5259856147050032e-03,
			-2.8558317578400881e-03,
			-2.0937002074628681e-03,
			-1.3134155200516908e-03,
			-5.9233317583970750e-04,
			-3.7822358250078755e-06,
			3.9027251319353107e-04,
			5.4562083721612718e-04,
			4.4059792201310989e-04,
			7.8766065900046770e-05,
			-5.1082710083981203e-04,
			-1.2758972595056852e-03,
			-2.1455177714411132e-03,
			-3.0366641508699954e-03,
			-3.8621118097987728e-03,
			-4.5389428080685424e-03,
			-4.9968394044701686e-03,
			-5.1853430528545691e-03,
			-5.0793389195515149e-03,
			-4.6821819764329082e-03,
			-4.0260977778495107e-03,
			-3.1697493995113059e-03,
			-2.1931374329631778e-03,
			-1.1902658708177875e-03,
			-2.6023694791261148e-04,
			5.0239086906258580e-04,
			1.0170537242174349e-03,
			1.2255086096815426e-03,
			1.0981873138275063e-03,
			6.3790127253392042e-04,
			-1.1953798113192900e-04,
			-1.1079276778061561e-03,
			-2.2363446488090528e-03,
			-3.3974065727959773e-03,
			-4.4773856919170718e-03,
			-5.3672354801872664e-03,
			-5.9734753110310982e-03,
			-6.2278624174949846e-03,
			-6.0948685932705384e-03,
			-5.5761654078248781e-03,
			-4.7115908003906980e-03,
			-3.5763979419758700e-03,
			-2.2749440304833169e-03,
			-9.3132842805940036e-04,
			3.2219796078291040e-04,
			1.3579883121752859e-03,
			2.0657109495232774e-03,
			2.3637734346849855e-03,
			2.2083038115951678e-03,
			1.5987342434481875e-03,
			5.7933196288304162e-04,
			-7.6360523631937476e-04,
			-2.3087604573219398e-03,
			-3.9104757284739783e-03,
			-5.4121833258849901e-03,
			-6.6613801997739783e-03,
			-7.5247452268142716e-03,
			-7.9019373222448622e-03,
			-7.7366891333259091e-03,
			-7.0240232005336425e-03,
			-5.8127492393513962e-03,
			-4.2028248373273342e-03,
			-2.3376400760274124e-03,
			-3.9177573876898449e-04,
			1.4447611912945188e-03,
			2.9844462893490794e-03,
			4.0606549183290512e-03,
			4.5448405291744071e-03,
			4.3607762636084981e-03,
			3.4943738979672815e-03,
			1.9979539455294236e-03,
			-1.1679981628951848e-05,
			-2.3614511802506899e-03,
			-4.8360047833993728e-03,
			-7.1964238219141821e-03,
			-9.2021151553450583e-03,
			-1.0633951165805386e-02,
			-1.1316552798255641e-02,
			-1.1137586000254470e-02,
			-1.0062124842053854e-02,
			-8.1405010867291669e-03,
			-5.5085851061377634e-03,
			-2.3800849646007840e-03,
			9.6884449252551230e-04,
			4.2216836898676243e-03,
			7.0486768194433849e-03,
			9.1368371170709086e-03,
			1.0220305897430315e-02,
			1.0108397670110335e-02,
			8.7087474354680741e-03,
			6.0432886744458819e-03,
			2.2553117568610858e-03,
			-2.3934561482566973e-03,
			-7.5360015862024794e-03,
			-1.2722801055507309e-02,
			-1.7452784005121087e-02,
			-2.1210303569516521e-02,
			-2.3505355684549270e-02,
			-2.3913919959109343e-02,
			-2.2115177846259819e-02,
			-1.7922511198655740e-02,
			-1.1305590976966528e-02,
			-2.4015034641907277e-03,
			8.4863183807199517e-03,
			2.0901652188791666e-02,
			3.4260844192471288e-02,
			4.7888335453839595e-02,
			6.1059894106108653e-02,
			7.3050446110118419e-02,
			8.3182990982319571e-02,
			9.0874957753215704e-02,
			9.5678513253330877e-02,
			9.7311769218428879e-02,
			9.5678513253330918e-02,
			9.0874957753215677e-02,
			8.3182990982319585e-02,
			7.3050446110118419e-02,
			6.1059894106108667e-02,
			4.7888335453839609e-02,
			3.4260844192471288e-02,
			2.0901652188791666e-02,
			8.4863183807199569e-03,
			-2.4015034641907285e-03,
			-1.1305590976966534e-02,
			-1.7922511198655757e-02,
			-2.2115177846259833e-02,
			-2.3913919959109346e-02,
			-2.3505355684549270e-02,
			-2.1210303569516531e-02,
			-1.7452784005121090e-02,
			-1.2722801055507311e-02,
			-7.5360015862024829e-03,
			-2.3934561482566981e-03,
			2.2553117568610867e-03,
			6.0432886744458819e-03,
			8.7087474354680741e-03,
			1.0108397670110337e-02,
			1.0220305897430322e-02,
			9.1368371170709086e-03,
			7.0486768194433849e-03,
			4.2216836898676261e-03,
			9.6884449252551273e-04,
			-2.3800849646007844e-03,
			-5.5085851061377642e-03,
			-8.1405010867291686e-03,
			-1.0062124842053856e-02,
			-1.1137586000254470e-02,
			-1.1316552798255644e-02,
			-1.0633951165805386e-02,
			-9.2021151553450635e-03,
			-7.1964238219141838e-03,
			-4.8360047833993763e-03,
			-2.3614511802506908e-03,
			-1.1679981628951848e-05,
			1.9979539455294258e-03,
			3.4943738979672854e-03,
			4.3607762636085007e-03,
			4.5448405291744088e-03,
			4.0606549183290546e-03,
			2.9844462893490803e-03,
			1.4447611912945196e-03,
			-3.9177573876898449e-04,
			-2.3376400760274133e-03,
			-4.2028248373273359e-03,
			-5.8127492393514005e-03,
			-7.0240232005336460e-03,
			-7.7366891333259160e-03,
			-7.9019373222448709e-03,
			-7.5247452268142768e-03,
			-6.6613801997739835e-03,
			-5.4121833258849944e-03,
			-3.9104757284739800e-03,
			-2.3087604573219420e-03,
			-7.6360523631937541e-04,
			5.7933196288304206e-04,
			1.5987342434481888e-03,
			2.2083038115951695e-03,
			2.3637734346849881e-03,
			2.0657109495232787e-03,
			1.3579883121752868e-03,
			3.2219796078291127e-04,
			-9.3132842805940057e-04,
			-2.2749440304833191e-03,
			-3.5763979419758734e-03,
			-4.7115908003907024e-03,
			-5.5761654078248851e-03,
			-6.0948685932705410e-03,
			-6.2278624174949872e-03,
			-5.9734753110311043e-03,
			-5.3672354801872690e-03,
			-4.4773856919170770e-03,
			-3.3974065727959803e-03,
			-2.2363446488090563e-03,
			-1.1079276778061574e-03,
			-1.1953798113192943e-04,
			6.3790127253392085e-04,
			1.0981873138275076e-03,
			1.2255086096815435e-03,
			1.0170537242174358e-03,
			5.0239086906258667e-04,
			-2.6023694791261213e-04,
			-1.1902658708177892e-03,
			-2.1931374329631804e-03,
			-3.1697493995113107e-03,
			-4.0260977778495150e-03,
			-4.6821819764329151e-03,
			-5.0793389195515218e-03,
			-5.1853430528545760e-03,
			-4.9968394044701747e-03,
			-4.5389428080685442e-03,
			-3.8621118097987776e-03,
			-3.0366641508699980e-03,
			-2.1455177714411145e-03,
			-1.2758972595056867e-03,
			-5.1082710083981311e-04,
			7.8766065900046770e-05,
			4.4059792201311075e-04,
			5.4562083721612805e-04,
			3.9027251319353150e-04,
			-3.7822358250078755e-06,
			-5.9233317583970880e-04,
			-1.3134155200516921e-03,
			-2.0937002074628711e-03,
			-2.8558317578400915e-03,
			-3.5259856147050088e-03,
			-4.0409122987702592e-03,
			-4.3538016122489503e-03,
			-4.4384286657659757e-03,
			-4.2912209155740620e-03,
			-3.9310935787960546e-03,
			-3.3971190584163777e-03,
			-2.7443031575346438e-03,
			-2.0379172193921687e-03,
			-1.3469646033696017e-03,
			-7.3743067972836828e-04,
			-2.6597224788052351e-04,
			2.5354317567759410e-05,
			1.1284000836526972e-04,
			-6.9834312824415181e-06,
			-3.1744647022797877e-04,
			-7.8378825350351841e-04,
			-1.3569073131266529e-03,
			-1.9784179024470564e-03,
			-2.5864957712039799e-03,
			-3.1219319124799550e-03,
			-3.5338050023559641e-03,
			-3.7842324736531187e-03,
			-3.8517604832979556e-03,
			-3.7330937104403505e-03,
			-3.4430325498542550e-03,
			-3.0126612251738143e-03,
			-2.4859984617802843e-03,
			-1.9154665600813439e-03,
			-1.3566415625985765e-03,
			-8.6280715728713248e-04,
			-4.7984317191924932e-04,
			-2.4193625100973301e-04,
			-1.6851079481957555e-04,
			-2.6265206842258801e-04,
			-5.1114349515264874e-04,
			-8.8608150223199096e-04,
			-1.3478794014496660e-03,
			-1.8493412139778472e-03,
			-2.3403892837598117e-03,
			-2.7729746824372626e-03,
			-3.1056912475649788e-03,
			-3.3076524683700315e-03,
			-3.3612706949638690e-03,
			-3.2636916931282319e-03,
			-3.0267727437604183e-03,
			-2.6756357782218901e-03,
			-2.2459644154696990e-03,
			-1.7803320420881675e-03,
			-1.3239361803047617e-03,
			-9.2016438994335268e-04,
			-6.0642476251474497e-04,
			-4.1063976990715395e-04,
			-3.4872998370800073e-04,
			-4.2331173523314271e-04,
			-6.2371066482157418e-04,
			-9.2726353456713318e-04,
			-1.3017563556190573e-03,
			-1.7087397545895596e-03,
			-2.1073826169179721e-03,
			-2.4584796038279785e-03,
			-2.7282208685875963e-03,
			-2.8913631482099622e-03,
			-2.9335066344339149e-03,
			-2.8522746288034630e-03,
			-2.6573034400949511e-03,
			-2.3690672229614721e-03,
			-2.0166749784740171e-03,
			-1.6348739179959453e-03,
			-1.2605657298138137e-03,
			-9.2918345122576030e-04,
			-6.7128325883948105e-04,
			-5.0967758766086110e-04,
			-4.5737696479821561e-04,
			-5.1652413990350054e-04,
			-6.7840413588374053e-04,
			-9.2450775236682593e-04,
			-1.2285242513423978e-03,
			-1.5590512379570643e-03,
			-1.8827443572853996e-03,
			-2.1675922672027411e-03,
			-2.3859964670479871e-03,
			-2.5173609120326171e-03,
			-2.5499498422015530e-03,
			-2.4818481466164642e-03,
			-2.3209490512706150e-03,
			-2.0839898846883422e-03,
			-1.7947487057919410e-03,
			-1.4815938115070857e-03,
			-1.1746371336738774e-03,
			-9.0277595818363940e-04,
			-6.9091251719947640e-04,
			-5.5761788704660311e-04,
			-5.1345808254887144e-04,
			-5.6013150133180361e-04,
			-6.9048502597345647e-04,
			-8.8938935754289588e-04,
			-1.1353710613629931e-03,
			-1.4028273596775388e-03,
			-1.6645966177239954e-03,
			-1.8946275302998434e-03,
			-2.0704856679088272e-03,
			-2.1754571889266573e-03,
			-2.2000535925879735e-03,
			-2.1427836247891172e-03,
			-2.0101324311648161e-03,
			-1.8157663436507688e-03,
			-1.5790565837738965e-03,
			-1.3230794514709379e-03,
			-1.0722982056842985e-03,
			-8.5015853938458566e-04,
			-6.7683314040934653e-04,
			-5.6733143777716502e-04,
			-5.3015062268610771e-04,
			-5.6658772472861503e-04,
			-6.7076573516148782e-04,
			-8.3035621871028087e-04,
			-1.0279134888687830e-03,
			-1.2426777301980277e-03,
			-1.4526618487227918e-03,
			-1.6368131495740745e-03,
			-1.7770380880220505e-03,
			-1.8598961554604264e-03,
			-1.8778052751213517e-03,
			-1.8296519661545317e-03,
			-1.7207597251464937e-03,
			-1.5622325114940253e-03,
			-1.3697506595220725e-03,
			-1.1619481531160521e-03,
			-9.5853814908442015e-04,
			-7.7837451944441616e-04,
			-6.3763933271861217e-04,
			-5.4832980445290724e-04,
			-5.1718531515799874e-04,
			-5.4514918710074623e-04,
			-6.2740578524895249e-04,
			-7.5397661608139343e-04,
			-9.1080504603679589e-04,
			-1.0812132551662208e-03,
			-1.2475813887483022e-03,
			-1.3930805785312590e-03,
			-1.5032900196379592e-03,
			-1.5675433814101875e-03,
			-1.5798796606311340e-03,
			-1.5395149164156405e-03,
			-1.4507998700714214e-03,
			-1.3226792145237412e-03,
			-1.1677166438897998e-03,
			-1.0007904473973103e-03,
			-8.3759419607065287e-04,
			-6.9309294300030650e-04,
			-5.8008622249482893e-04,
			-5.0801522925231191e-04,
			-4.8212458142003674e-04,
			-5.0305195443362970e-04,
			-5.6687547227462652e-04,
			-6.6560344061365078e-04,
			-7.8804826816350926e-04,
			-9.2099036038381839e-04,


			};
		if(*trig==1||*trig==2)
			{

			//if(PGV_type==1)
			//	{
			//	datamid=0.0;
			//	now_fir=i_fir_list;
			//	for(int i=0;i<firLength;i++)
			//		{
			//		datamid=datamid+now_fir->dataV[4]*Fir[i];
			//		now_fir=now_fir->last;
			//		}
			//	i_fir_list->band_pass_dataV[4]=datamid;



			//	datamid=0.0;
			//	now_fir=i_fir_list;
			//	for(int i=0;i<firLength;i++)
			//		{
			//		datamid=datamid+now_fir->dataD[4]*Fir[i];
			//		now_fir=now_fir->last;
			//		}
			//	i_fir_list->band_pass_dataD[4]=datamid;

			//	}
			//else if(PGV_type==2)
			//	{
			//	for(int j=0;j<3;j++)
			//		{


			//		datamid=0.0;
			//		now_fir=i_fir_list;
			//		for(int i=0;i<firLength;i++)
			//			{
			//			datamid=datamid+now_fir->dataV[j]*Fir[i];
			//			now_fir=now_fir->last;
			//			}
			//		i_fir_list->band_pass_dataV[j]=datamid;

			//		}
			//	i_fir_list->band_pass_dataV[4]=pow((double)(i_fir_list->band_pass_dataV[0]*i_fir_list->band_pass_dataV[0]+i_fir_list->band_pass_dataV[1]*i_fir_list->band_pass_dataV[1]),0.5);
			//	for(int j=0;j<3;j++)
			//		{


			//		datamid=0.0;
			//		now_fir=i_fir_list;
			//		for(int i=0;i<firLength;i++)
			//			{
			//			datamid=datamid+now_fir->dataD[j]*Fir[i];
			//			now_fir=now_fir->last;
			//			}
			//		i_fir_list->band_pass_dataD[j]=datamid;
			//		}
			//	i_fir_list->band_pass_dataD[4]=pow((double)(i_fir_list->band_pass_dataD[0]*i_fir_list->band_pass_dataD[0]+i_fir_list->band_pass_dataD[1]*i_fir_list->band_pass_dataD[1]),0.5);
			//	}

			if(*trig==1)
				{
				for(jjj=0;jjj<3;jjj++)
					{
					band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
					band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
					band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);
					}
				band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
				band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
				band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];

				now_fir=i_fir_list->last;
				for(iii=1;iii<i_sample_rata*3;iii++)
					{
					for(jjj=0;jjj<3;jjj++)
						{
						if(abs(now_fir->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
							band_pass_data->final_PGA_component[jjj]=abs(now_fir->band_pass_data[jjj]);
						if(abs(now_fir->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
							band_pass_data->final_PGV_component[jjj]=abs(now_fir->band_pass_dataV[jjj]);
						if(abs(now_fir->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
							band_pass_data->final_PGD_component[jjj]=abs(now_fir->band_pass_dataD[jjj]);

						}
					if(now_fir->band_pass_data[4]>band_pass_data->final_PGA)
						{
						band_pass_data->final_PGA=now_fir->band_pass_data[4];
						band_pass_data->utc_second_final_PGA=now_fir->utc_second; //utcÊ±¼äÃë
						band_pass_data->utc_nanosecond_final_PGA=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë

						}
					//else
					//	{
					//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
					//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utcÊ±¼äÃë
					//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
					//	}
					if(now_fir->band_pass_dataV[4]>band_pass_data->final_PGV)
						{
						band_pass_data->final_PGV=now_fir->band_pass_dataV[4];
						band_pass_data->utc_second_final_PGV=now_fir->utc_second; //utcÊ±¼äÃë
						band_pass_data->utc_nanosecond_final_PGV=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
						}
					//else
					//	{
					//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
					//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utcÊ±¼äÃë
					//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
					//	}
					if(now_fir->band_pass_dataD[4]>band_pass_data->final_PGD)
						{
						band_pass_data->final_PGD=now_fir->band_pass_dataD[4];
						band_pass_data->utc_second_final_PGD=now_fir->utc_second; //utcÊ±¼äÃë
						band_pass_data->utc_nanosecond_final_PGD=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
						}

					now_fir=now_fir->last;



					}




				*trig=2;
				*count=2;
				}
			else
				{


				for(jjj=0;jjj<3;jjj++)
					{
					if(abs(i_fir_list->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
						band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
					if(abs(i_fir_list->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
						band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
					if(abs(i_fir_list->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
						band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);
					}

				if(i_fir_list->band_pass_data[4]>band_pass_data->final_PGA)
					{
					band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
					band_pass_data->utc_second_final_PGA=i_fir_list->utc_second; //utcÊ±¼äÃë
					band_pass_data->utc_nanosecond_final_PGA=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë

					}
				if(i_fir_list->band_pass_dataV[4]>band_pass_data->final_PGV)
					{
					band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
					band_pass_data->utc_second_final_PGV=i_fir_list->utc_second; //utcÊ±¼äÃë
					band_pass_data->utc_nanosecond_final_PGV=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
					}
				if(i_fir_list->band_pass_dataD[4]>band_pass_data->final_PGD)
					{
					band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
					band_pass_data->utc_second_final_PGD=i_fir_list->utc_second; //utcÊ±¼äÃë
					band_pass_data->utc_nanosecond_final_PGD=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
					}
				if(*count==timespan*200)

					{
					*count=1;
					return 2;
					}
				else
					{


					*count+=1;
					}



				}
			}
		else
							{
							if(*trig==0)
								{


								for(jjj=0;jjj<3;jjj++)
									{
									band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
									band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
									band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);
									}
								band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
								band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
								band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
								//now_fir=i_fir_list->last;
								//for(iii=1;iii<i_sample_rata*3;iii++)
								//	{
								//	for(jjj=0;jjj<3;jjj++)
								//		{
								//		if(abs(now_fir->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
								//			band_pass_data->final_PGA_component[jjj]=abs(now_fir->band_pass_data[jjj]);
								//		if(abs(now_fir->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
								//			band_pass_data->final_PGV_component[jjj]=abs(now_fir->band_pass_dataV[jjj]);
								//		if(abs(now_fir->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
								//			band_pass_data->final_PGD_component[jjj]=abs(now_fir->band_pass_dataD[jjj]);
								//		}

								//	if(now_fir->band_pass_data[4]>band_pass_data->final_PGA)
								//		{
								//		band_pass_data->final_PGA=now_fir->band_pass_data[4];
								//		band_pass_data->utc_second_final_PGA=now_fir->utc_second; //utcÊ±¼äÃë
								//		band_pass_data->utc_nanosecond_final_PGA=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë

								//		}
								//	//else
								//	//	{
								//	//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
								//	//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utcÊ±¼äÃë
								//	//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
								//	//	}
								//	if(now_fir->band_pass_dataV[4]>band_pass_data->final_PGV)
								//		{
								//		band_pass_data->final_PGV=now_fir->band_pass_dataV[4];
								//		band_pass_data->utc_second_final_PGV=now_fir->utc_second; //utcÊ±¼äÃë
								//		band_pass_data->utc_nanosecond_final_PGV=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
								//		}
								//	//else
								//	//	{
								//	//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
								//	//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utcÊ±¼äÃë
								//	//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
								//	//	}
								//	if(now_fir->band_pass_dataD[4]>band_pass_data->final_PGD)
								//		{
								//		band_pass_data->final_PGD=now_fir->band_pass_dataD[4];
								//		band_pass_data->utc_second_final_PGD=now_fir->utc_second; //utcÊ±¼äÃë
								//		band_pass_data->utc_nanosecond_final_PGD=now_fir->utc_nanosecond; //utcÊ±¼äÄÉÃë
								//		}

								//	now_fir=now_fir=now_fir->last;



								//	}


								*count=2;
								*trig=3;

								}
							else if(*trig==3)
								{
								for(jjj=0;jjj<3;jjj++)
									{
									if(abs(i_fir_list->band_pass_data[jjj])>band_pass_data->final_PGA_component[jjj])
										band_pass_data->final_PGA_component[jjj]=abs(i_fir_list->band_pass_data[jjj]);
									if(abs(i_fir_list->band_pass_dataV[jjj])>band_pass_data->final_PGV_component[jjj])
										band_pass_data->final_PGV_component[jjj]=abs(i_fir_list->band_pass_dataV[jjj]);
									if(abs(i_fir_list->band_pass_dataD[jjj])>band_pass_data->final_PGD_component[jjj])
										band_pass_data->final_PGD_component[jjj]=abs(i_fir_list->band_pass_dataD[jjj]);

									}

								if(i_fir_list->band_pass_data[4]>band_pass_data->final_PGA)
									{
									band_pass_data->final_PGA=i_fir_list->band_pass_data[4];
									band_pass_data->utc_second_final_PGA=i_fir_list->utc_second; //utcÊ±¼äÃë
									band_pass_data->utc_nanosecond_final_PGA=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë

									}
								//else
								//	{
								//	band_pass_data->final_PGA=i_fir_list->last->final_PGA;
								//	band_pass_data->utc_second_final_PGA=i_fir_list->last->utc_second; //utcÊ±¼äÃë
								//	band_pass_data->utc_nanosecond_final_PGA=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
								//	}
								if(i_fir_list->band_pass_dataV[4]>band_pass_data->final_PGV)
									{
									band_pass_data->final_PGV=i_fir_list->band_pass_dataV[4];
									band_pass_data->utc_second_final_PGV=i_fir_list->utc_second; //utcÊ±¼äÃë
									band_pass_data->utc_nanosecond_final_PGV=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
									}
								//else
								//	{
								//	band_pass_data->final_PGV=i_fir_list->last->final_PGV;
								//	band_pass_data->utc_second_final_PGV=i_fir_list->last->utc_second; //utcÊ±¼äÃë
								//	band_pass_data->utc_nanosecond_final_PGV=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
								//	}
								if(i_fir_list->band_pass_dataD[4]>band_pass_data->final_PGD)
									{
									band_pass_data->final_PGD=i_fir_list->band_pass_dataD[4];
									band_pass_data->utc_second_final_PGD=i_fir_list->utc_second; //utcÊ±¼äÃë
									band_pass_data->utc_nanosecond_final_PGD=i_fir_list->utc_nanosecond; //utcÊ±¼äÄÉÃë
									}
								//else
								//	{
								//	band_pass_data->final_PGD=i_fir_list->last->final_PGD;
								//	band_pass_data->utc_second_final_PGD=i_fir_list->last->utc_second; //utcÊ±¼äÃë
								//	band_pass_data->utc_nanosecond_final_PGD=i_fir_list->last->utc_nanosecond; //utcÊ±¼äÄÉÃë
								//	}
								if(*count==timespan*200)
									{
									*count=1;
									*trig=0;
									return 3;

									}
								else
									{

									*count+=1;
									}

								}

				}
		return 1;
		}



	}